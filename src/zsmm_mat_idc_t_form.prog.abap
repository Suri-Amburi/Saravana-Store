*&---------------------------------------------------------------------*
*& Include          ZMM_MAT_IDC_T_FORM
*&---------------------------------------------------------------------*

*&---------------------------------------------------------------------*
*&      Form  GET_FILENAME
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      <--P_P_FILE  text
*----------------------------------------------------------------------*
FORM GET_FILENAME  CHANGING FP_P_FILE TYPE STRING.
  DATA: LI_FILETABLE    TYPE FILETABLE,
        LX_FILETABLE    TYPE FILE_TABLE,
        LV_RETURN_CODE  TYPE I,
        LV_WINDOW_TITLE TYPE STRING.

  CALL METHOD CL_GUI_FRONTEND_SERVICES=>FILE_OPEN_DIALOG
    EXPORTING
      WINDOW_TITLE            = LV_WINDOW_TITLE
    CHANGING
      FILE_TABLE              = LI_FILETABLE
      RC                      = LV_RETURN_CODE
    EXCEPTIONS
      FILE_OPEN_DIALOG_FAILED = 1
      CNTL_ERROR              = 2
      ERROR_NO_GUI            = 3
      NOT_SUPPORTED_BY_GUI    = 4
      OTHERS                  = 5.
  READ TABLE  LI_FILETABLE INTO LX_FILETABLE INDEX 1.
  FP_P_FILE = LX_FILETABLE-FILENAME.

  SPLIT FP_P_FILE AT '.' INTO FNAME ENAME.
  SET LOCALE LANGUAGE SY-LANGU.
  TRANSLATE ENAME TO UPPER CASE.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_DATA
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      <--P_TA_FLATFILE  text
*----------------------------------------------------------------------*
FORM GET_DATA  CHANGING P_TA_FLATFILE.
  DATA : I_TYPE TYPE TRUXS_T_TEXT_DATA.
  DATA:LV_FILE  TYPE RLGRAP-FILENAME.


*  PROCEED ONLY IF ITS A VALID FILETYPE
  IF ENAME EQ 'XLSX' OR ENAME EQ 'XLS'.

    REFRESH TA_FLATFILE[].

    LV_FILE = P_FILE.

*   FM TO UPLOAD DATA INTO INTERNAL TABLE FROM EXCEL
    CALL FUNCTION 'TEXT_CONVERT_XLS_TO_SAP'
      EXPORTING
        I_TAB_RAW_DATA       = I_TYPE
        I_FILENAME           = LV_FILE
      TABLES
        I_TAB_CONVERTED_DATA = TA_FLATFILE[]
      EXCEPTIONS
        CONVERSION_FAILED    = 1
        OTHERS               = 2.

    DELETE TA_FLATFILE FROM 1 TO 3.

  ELSE.
    MESSAGE E398(00) WITH 'Invalid File Type'  .
  ENDIF.

  IF TA_FLATFILE IS INITIAL.
    MESSAGE 'No records to upload' TYPE 'E'.
  ENDIF.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  UPLOAD_SERVICE
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM UPLOAD_SERVICE .

  PERFORM CONTROL_RECORD.

*** Start Of Changes By Suri : 10.09.2019
*** Get Data from Application Layer for Background Job
  DATA: LV_A_FILE TYPE STRING,
        LS_FILE   TYPE TA_FLATFILE.
  IF SY-BATCH = 'X'.
    CASE SY-SYSID.
      WHEN 'SDS'.
        LV_A_FILE = '/usr/sap/SDS/D00/work/materialcreation.txt'.
      WHEN 'SQS'.
        LV_A_FILE = '/usr/sap/SQS/materialcreation/materialcreation.txt'.
      WHEN 'SPS'.
        LV_A_FILE = '/usr/sap/SPS/materialcreation/materialcreation.txt'.
    ENDCASE.

    TRY.
        OPEN DATASET LV_A_FILE FOR INPUT IN TEXT MODE ENCODING DEFAULT.
        DO.
          CLEAR LS_FILE .
          READ DATASET LV_A_FILE INTO LS_FILE.
          IF SY-SUBRC = 0.
            APPEND LS_FILE TO TA_FLATFILE.
            CLEAR LS_FILE.
          ELSE.
            EXIT.
          ENDIF.
        ENDDO.
      CATCH CX_ROOT.
    ENDTRY.
    CLOSE DATASET LV_A_FILE.
  ENDIF.

  READ TABLE TA_FLATFILE ASSIGNING <FS_FLATFILE> INDEX 1.
  CHECK SY-SUBRC = 0.
*** End Of Changes By Suri : 10.09.2019
  SORT TA_FLATFILE[] BY MATERIAL.
  TA_FLATFILE3[] = TA_FLATFILE2[] = TA_FLATFILE1[] = TA_FLATFILE[].
  DELETE ADJACENT DUPLICATES FROM TA_FLATFILE COMPARING MATERIAL.
*  IF P_RAD1 = 'X'. " Sngle materiial    " Suri : 10.09.2019
  IF <FS_FLATFILE>-FLAG = 'S'. " Sngle materiial    " Suri : 10.09.2019
    P_RAD1 = 'X'.
    LOOP AT TA_FLATFILE ASSIGNING <FS_FLATFILE>.
      IF <FS_FLATFILE> IS ASSIGNED.
        PERFORM SINGLE_MATERIAL.
        PERFORM UPDATE.
      ENDIF.
    ENDLOOP.
*  ELSEIF P_RAD2 = 'X'. "<FS_FLATFILE>-MATL_CAT = '01' ""Generic matrial " Suri : 10.09.2019
  ELSEIF <FS_FLATFILE>-FLAG = 'G'. "<FS_FLATFILE>-MATL_CAT = '01' ""Generic matrial " Suri : 10.09.2019
    P_RAD2 = 'X'.
    LOOP AT TA_FLATFILE ASSIGNING <FS_FLATFILE>.
      IF <FS_FLATFILE> IS ASSIGNED.
        PERFORM GENERIC_UPDATE.
        PERFORM UPDATE.
      ENDIF.
    ENDLOOP.
*  ELSEIF P_RAD3 = 'X'.
**    LOOP AT TA_FLATFILE ASSIGNING <FS_FLATFILE>.""palnt specific extension
**      IF <FS_FLATFILE> IS ASSIGNED.
*        PERFORM PLANT_SPECIFIC.
**        PERFORM UPDATE.
**      ENDIF.
**    ENDLOOP.
  ENDIF.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  DISPLAY_DATA
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM DISPLAY_DATA .
  DATA:LT_FIELDCAT TYPE SLIS_T_FIELDCAT_ALV,
       LS_FIELDCAT TYPE SLIS_FIELDCAT_ALV,
       LWA_LAYOUT  TYPE SLIS_LAYOUT_ALV.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'SLNO'.
  LS_FIELDCAT-SELTEXT_L = 'Serial no.'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'MATERIAL'.
  LS_FIELDCAT-SELTEXT_L = 'Material'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'TYPE'.
  LS_FIELDCAT-SELTEXT_L = 'Message Type'.
  LS_FIELDCAT-SELTEXT_M = 'Message Type'.
  LS_FIELDCAT-SELTEXT_S = 'Message Type'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'MESSAGE_V1'.
  LS_FIELDCAT-SELTEXT_L = 'Material'.
  LS_FIELDCAT-SELTEXT_M = 'Material'.
  LS_FIELDCAT-SELTEXT_S = 'Material'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.

  CLEAR LS_FIELDCAT.
  LS_FIELDCAT-FIELDNAME = 'MESSAGE'.
  LS_FIELDCAT-SELTEXT_L = 'Message'.
  LS_FIELDCAT-SELTEXT_M = 'Message'.
  LS_FIELDCAT-SELTEXT_S = 'Message'.
  APPEND LS_FIELDCAT TO LT_FIELDCAT.


  LWA_LAYOUT-ZEBRA = 'X'.
  LWA_LAYOUT-COLWIDTH_OPTIMIZE = 'X'.

  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      I_CALLBACK_PROGRAM = SY-REPID
      IS_LAYOUT          = LWA_LAYOUT
      IT_FIELDCAT        = LT_FIELDCAT
      I_SAVE             = 'X'
    TABLES
      T_OUTTAB           = IT_DISPLAY
    EXCEPTIONS
      PROGRAM_ERROR      = 1
      OTHERS             = 2.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form CONTROL_RECORD
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM CONTROL_RECORD .
  """"Controll Data"""""""""""""""""""""
  WA_IDOC_CONTRL-DOCREL   = '752'.
  WA_IDOC_CONTRL-MANDT    = SY-MANDT."'200'.
  WA_IDOC_CONTRL-STATUS   = '62'.
  WA_IDOC_CONTRL-DIRECT   = '2'.
  WA_IDOC_CONTRL-RCVPOR   = 'A000000019'.
  WA_IDOC_CONTRL-RCVPRT   = 'LS'.
  WA_IDOC_CONTRL-RCVPRN   = 'ESPCLNT800'."'ESDCLNT200'.
  WA_IDOC_CONTRL-OUTMOD   = '2'.

  WA_IDOC_CONTRL-SNDPOR   = 'A000000015'.
  WA_IDOC_CONTRL-SNDPRT   = 'LS'.
  WA_IDOC_CONTRL-SNDPRN   = 'ESDCLNT400'.
  WA_IDOC_CONTRL-MESTYP   = 'ARTMAS'.
  WA_IDOC_CONTRL-IDOCTP   = 'ARTMAS09'.
*  WA_IDOC_CONTRL-MAXSEGNUM   = '000009'.
  WA_IDOC_CONTRL-UPDDAT   = SY-DATUM.
  WA_IDOC_CONTRL-UPDTIM   = SY-UZEIT.
  CONCATENATE SY-DATUM SY-UZEIT INTO WA_IDOC_CONTRL-SERIAL.
  APPEND WA_IDOC_CONTRL TO IT_IDOC_CONTRL.
  CLEAR WA_IDOC_CONTRL.
ENDFORM.

*&---------------------------------------------------------------------*
*& Form DATA_RECORD
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM DATA_RECORD .

ENDFORM.
*&---------------------------------------------------------------------*
*& Form GENERIC_UPDATE
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM GENERIC_UPDATE .
  BREAK BREDDY.
***********Data Records*************************
***********Hedare data**************************
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = '000001'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MATHEAD'.
  WA_IDOC_DATA-SDATA+21(4)    = MATL_TYPE.
  WA_IDOC_DATA-SDATA+25(9)    = <FS_FLATFILE>-MATL_GROUP."'MC10009'."
  WA_IDOC_DATA-SDATA+34(2)    = <FS_FLATFILE>-MATL_CAT."'00'."
  WA_IDOC_DATA-SDATA+36(18)   = <FS_FLATFILE>-CHAR_PROF."'
  WA_IDOC_DATA-SDATA+72(1)    = 'X'.
  WA_IDOC_DATA-SDATA+73(1)    = 'X'.
  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
  WA_IDOC_DATA-SDATA+75(1)    = 'X'.
  WA_IDOC_DATA-SDATA+76(1)    = 'X'.
  WA_IDOC_DATA-SDATA+77(1)    = 'X'.
  WA_IDOC_DATA-SDATA+246(40)  =  <FS_FLATFILE>-MATERIAL."'SST123T10'."""Material
  WA_IDOC_DATA-SDATA+326(18)  =  <FS_FLATFILE>-CHAR_PROF."CONFIG_CLASS_NAME
  WA_IDOC_DATA-SDATA+344(3)   =  <FS_FLATFILE>-CONFIG_CLASS_TYPE."'300'."CONFIG_CLASS_TYPE
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  DATA:T  TYPE SY-TABIX.
  DATA:T2 TYPE SY-TABIX.
  CLEAR T.
  T = '000002'.
  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
    IF <FS_FLATFILE1> IS ASSIGNED.
      WA_IDOC_DATA-MANDT          = SY-MANDT.
      WA_IDOC_DATA-SEGNUM         = T.
      WA_IDOC_DATA-SEGNAM         = 'E1BPE1VARKEY'.
      WA_IDOC_DATA-SDATA+0(3)     = '005'.
      WA_IDOC_DATA-SDATA+203(40)  = <FS_FLATFILE1>-MATERIAL.
      WA_IDOC_DATA-SDATA+243(40)  = <FS_FLATFILE1>-VARIANT_LONG. "'L123001'.
      T = T + 1.
      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
      CLEAR WA_IDOC_DATA.
    ENDIF.
  ENDLOOP.

  SORT IT_IDOC_DATA DESCENDING.
  READ TABLE IT_IDOC_DATA INTO WA_IDOC_DATA INDEX 1.
  T2 = WA_IDOC_DATA-SEGNUM + 1.
*  CLEAR WA_IDOC_DATA.
*  DELETE ADJACENT DUPLICATES FROM TA_FLATFILE2 COMPARING CHAR_VAL_CHAR1.
*  SORT TA_FLATFILE3 BY CHAR_VALUE_LONG1 ASCENDING.
*  DELETE ADJACENT DUPLICATES FROM TA_FLATFILE3   COMPARING CHAR_VALUE_LONG1.
  SORT IT_IDOC_DATA ASCENDING.
  SORT TA_FLATFILE1 BY MATERIAL.
  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
    IF <FS_FLATFILE1> IS ASSIGNED.
      """"""""""""Color****************************************
*      READ TABLE TA_FLATFILE3 ASSIGNING <FS_FLATFILE3> INDEX SY-TABIX.
      IF <FS_FLATFILE1>-CHAR_NAME IS NOT INITIAL.
        WA_IDOC_DATA-MANDT           = SY-MANDT.
        WA_IDOC_DATA-SEGNUM          = T2 .                 "'000003'.
        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
        WA_IDOC_DATA-SDATA+0(3)      = '005'.
        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME."'COLOR'."CHAR_NAME
        WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VAL_CHAR."'COLOR'."CHAR_NAME
        WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-MATERIAL."'L124'."
        WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."'BLACK'." CHAR_VALUE_LONG
        WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VAL_CHAR.
        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
        CLEAR WA_IDOC_DATA.
        T2 = T2 + 1.
      ENDIF.
      "******************SIZE****************************
      WA_IDOC_DATA-MANDT           = SY-MANDT.
      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
      WA_IDOC_DATA-SDATA+0(3)      = '005'.
      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
      WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'COLOR'."CHAR_NAME
      WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-MATERIAL."'L124'."
      WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'L'." CHAR_VALUE_LONG
      WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'L'."CHAR_VAL_char
      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
      CLEAR WA_IDOC_DATA.
      T2 = T2 + 1.
    ENDIF.
  ENDLOOP.

  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
    IF <FS_FLATFILE1> IS ASSIGNED.
      """""""""""" E1BPE1AUSPRT Color****************************************
      IF <FS_FLATFILE1>-CHAR_NAME IS NOT INITIAL.
        WA_IDOC_DATA-MANDT           = SY-MANDT.  ""'
        WA_IDOC_DATA-SEGNUM          = T2 .                 "'000003'.
        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
        WA_IDOC_DATA-SDATA+0(3)      = '005'.
        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME."'COLOR'."CHAR_NAME
        WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VAL_CHAR."'COLOR'."CHAR_NAME
        WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-VARIANT_LONG."'L123001'."
        WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VALUE_LONG.
        WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VALUE_LONG."'BLACK'."CHAR_VAL_char
****      WA_IDOC_DATA-SDATA+403(1)    = '1'."CHAR_VAL_DEPENDENCY
        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
        CLEAR WA_IDOC_DATA.
        T2 = T2 + 1.
      ENDIF.
****************** E1BPE1AUSPRT SIZE****************************
      WA_IDOC_DATA-MANDT           = SY-MANDT. "
      WA_IDOC_DATA-SEGNUM          =  T2.                   "'000003'.
      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
      WA_IDOC_DATA-SDATA+0(3)      = '005'.
      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
      WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG1.
      WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-VARIANT_LONG."'L123001'."
      WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1.
      WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1.
*****      WA_IDOC_DATA-SDATA+403(1)    = '1'."CHAR_VAL_DEPENDENCY
      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
      CLEAR WA_IDOC_DATA.
      T2 = T2 + 1.
    ENDIF.
  ENDLOOP.
  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
    IF <FS_FLATFILE1> IS ASSIGNED.
      IF <FS_FLATFILE1>-CHAR_NAME IS NOT INITIAL.
        WA_IDOC_DATA-MANDT           = SY-MANDT. "           """"use for material 2 times and net further for same
        WA_IDOC_DATA-SEGNUM          = T2.                  "'000003'.
        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
        WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      ON CHANGE OF <FS_FLATFILE1>-CHAR_NAME.
        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME.
*      ELSE.
*      WA_IDOC_DATA-SDATA+21(30)    = ' '.
*      endon.
        WA_IDOC_DATA-SDATA+51(1)    = 'X'.
        WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-MATERIAL. "'L123001'.
        WA_IDOC_DATA-SDATA+174(1)    = 'X'.
        WA_IDOC_DATA-SDATA+175(1)    = 'X'.
        WA_IDOC_DATA-SDATA+176(1)    = 'X'.
        WA_IDOC_DATA-SDATA+177(1)    = 'X'.
        WA_IDOC_DATA-SDATA+178(1)    = 'X'.
        WA_IDOC_DATA-SDATA+179(1)    = 'X'.
        WA_IDOC_DATA-SDATA+180(1)    = 'X'.
        WA_IDOC_DATA-SDATA+181(1)    = 'X'.
        WA_IDOC_DATA-SDATA+182(1)    = 'X'.
        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
        T2 = T2 + 1.
      ENDIF.

*************E1BPE1AUSPRTX SIZE************************

      WA_IDOC_DATA-MANDT           = SY-MANDT. "
      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
      WA_IDOC_DATA-SDATA+0(3)      = '005'.
      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
      WA_IDOC_DATA-SDATA+51(1)    = 'X'.
      WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-MATERIAL. "'L123001'.
      WA_IDOC_DATA-SDATA+174(1)    = 'X'.
      WA_IDOC_DATA-SDATA+175(1)    = 'X'.
      WA_IDOC_DATA-SDATA+176(1)    = 'X'.
      WA_IDOC_DATA-SDATA+177(1)    = 'X'.
      WA_IDOC_DATA-SDATA+178(1)    = 'X'.
      WA_IDOC_DATA-SDATA+179(1)    = 'X'.
      WA_IDOC_DATA-SDATA+180(1)    = 'X'.
      WA_IDOC_DATA-SDATA+181(1)    = 'X'.
      WA_IDOC_DATA-SDATA+182(1)    = 'X'.
      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.

      """"""""""""""""Inseam
      T2 = T2 + 1.
    ENDIF.
  ENDLOOP.

  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
    IF <FS_FLATFILE1> IS ASSIGNED.
*************E1BPE1AUSPRTX color************************
      IF <FS_FLATFILE1>-CHAR_NAME IS NOT INITIAL.
        WA_IDOC_DATA-MANDT           = SY-MANDT. "           """"use for material 2 times and net further for same
        WA_IDOC_DATA-SEGNUM          = T2.                  "'000003'.
        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
        WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      ON CHANGE OF <FS_FLATFILE1>-CHAR_NAME.
        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME.
**      ELSE.
**      WA_IDOC_DATA-SDATA+21(30)    = ' '.
**      endon.
        WA_IDOC_DATA-SDATA+51(1)    = 'X'.
        WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-VARIANT_LONG. "'L123001'.
        WA_IDOC_DATA-SDATA+174(1)    = 'X'.
        WA_IDOC_DATA-SDATA+175(1)    = 'X'.
        WA_IDOC_DATA-SDATA+176(1)    = 'X'.
        WA_IDOC_DATA-SDATA+177(1)    = 'X'.
        WA_IDOC_DATA-SDATA+178(1)    = 'X'.
        WA_IDOC_DATA-SDATA+179(1)    = 'X'.
        WA_IDOC_DATA-SDATA+180(1)    = 'X'.
        WA_IDOC_DATA-SDATA+181(1)    = 'X'.
        WA_IDOC_DATA-SDATA+182(1)    = 'X'.
        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
        T2 = T2 + 1.
      ENDIF.

*************E1BPE1AUSPRTX SIZE************************
      WA_IDOC_DATA-MANDT           = SY-MANDT. "
      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
      WA_IDOC_DATA-SDATA+0(3)      = '005'.
      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
      WA_IDOC_DATA-SDATA+51(1)    = 'X'.
      WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-VARIANT_LONG. "'L123001'.
      WA_IDOC_DATA-SDATA+174(1)    = 'X'.
      WA_IDOC_DATA-SDATA+175(1)    = 'X'.
      WA_IDOC_DATA-SDATA+176(1)    = 'X'.
      WA_IDOC_DATA-SDATA+177(1)    = 'X'.
      WA_IDOC_DATA-SDATA+178(1)    = 'X'.
      WA_IDOC_DATA-SDATA+179(1)    = 'X'.
      WA_IDOC_DATA-SDATA+180(1)    = 'X'.
      WA_IDOC_DATA-SDATA+181(1)    = 'X'.
      WA_IDOC_DATA-SDATA+182(1)    = 'X'.
      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
      T2 = T2 + 1.
    ENDIF.
  ENDLOOP.

  READ TABLE TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WITH KEY MATERIAL = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-MANDT           = SY-MANDT.
  WA_IDOC_DATA-SEGNUM          = T2.                        "'000002'.
  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARART'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+80(3)     = <FS_FLATFILE>-BASE_UOM."'EA'.'EA'."
  WA_IDOC_DATA-SDATA+83(3)     = <FS_FLATFILE>-BASE_UOM.".
  WA_IDOC_DATA-SDATA+249(4)    = TRANS_GRP.                 ".'0001'.
  WA_IDOC_DATA-SDATA+271(2)    = DIVISION.
  WA_IDOC_DATA-SDATA+380(1)    = <FS_FLATFILE>-BATCH_MGMT. "BATCH_MGMT
  WA_IDOC_DATA-SDATA+429(8)    = SY-DATUM.
  WA_IDOC_DATA-SDATA+437(8)    = '99991231'.
*  WA_IDOC_DATA-SDATA+452(18)   = <FS_FLATFILE>-EXTMATLGRP.
****  WA_IDOC_DATA-SDATA+510(8)    = <FS_FLATFILE>-PVALIDFROM.
****  WA_IDOC_DATA-SDATA+518(8)    = <FS_FLATFILE>-SVALIDFROM.
  WA_IDOC_DATA-SDATA+526(1)    = TAX_CLASS.".'0'.   ""TAX_CLASS
  WA_IDOC_DATA-SDATA+569(1)    = PRPROFVAR.".'0'.   ""TAX_CLASS
  WA_IDOC_DATA-SDATA+602(4)    = ITEM_CAT.". 'NORM'.
  WA_IDOC_DATA-SDATA+308(18)    = <FS_FLATFILE>-PROD_HIER.".
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000003'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARART1'.
  WA_IDOC_DATA-SDATA+36(4)    = <FS_FLATFILE>-BRAND_ID."'AKIL'."brand
  WA_IDOC_DATA-SDATA+473(1)   = 'X'.
  WA_IDOC_DATA-SDATA+478(40)  = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-FASHION_GRADE.
  WA_IDOC_DATA-SDATA+446(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE1.
  WA_IDOC_DATA-SDATA+456(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE2.
  WA_IDOC_DATA-SDATA+466(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE3.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT           = SY-MANDT.
  WA_IDOC_DATA-SEGNUM          = T2.                        "'000002'.
  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARART'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+80(3)     = <FS_FLATFILE1>-BASE_UOM."'EA'.'EA'."
  WA_IDOC_DATA-SDATA+83(3)     = <FS_FLATFILE1>-BASE_UOM.".
  WA_IDOC_DATA-SDATA+249(4)    = TRANS_GRP.                 ".'0001'.
  WA_IDOC_DATA-SDATA+271(2)    = DIVISION.".'10'.
  WA_IDOC_DATA-SDATA+380(1)    = <FS_FLATFILE1>-BATCH_MGMT. "BATCH_MGMT
  WA_IDOC_DATA-SDATA+429(8)    = SY-DATUM.
  WA_IDOC_DATA-SDATA+437(8)    = '99991231'.
*  WA_IDOC_DATA-SDATA+452(18)   = <FS_FLATFILE>-EXTMATLGRP.
***      WA_IDOC_DATA-SDATA+510(8)    = <FS_FLATFILE>-PVALIDFROM.
***      WA_IDOC_DATA-SDATA+518(8)    = <FS_FLATFILE>-SVALIDFROM.
  WA_IDOC_DATA-SDATA+526(1)    = TAX_CLASS.".'0'.   ""TAX_CLASS
  WA_IDOC_DATA-SDATA+569(1)    = PRPROFVAR.
  WA_IDOC_DATA-SDATA+602(4)    = ITEM_CAT.". 'NORM'.
  WA_IDOC_DATA-SDATA+308(18)    = <FS_FLATFILE>-PROD_HIER.".
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000003'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARART1'.
  WA_IDOC_DATA-SDATA+36(4)    = <FS_FLATFILE>-BRAND_ID."'AKIL'."brand
  WA_IDOC_DATA-SDATA+473(1)   = 'X'.
  WA_IDOC_DATA-SDATA+478(40)  = <FS_FLATFILE1>-VARIANT_LONG.
  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-FASHION_GRADE.
  WA_IDOC_DATA-SDATA+446(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE1.
  WA_IDOC_DATA-SDATA+456(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE2.
  WA_IDOC_DATA-SDATA+466(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE3.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARARTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+49(1)    = 'X'.""trans_grp
  WA_IDOC_DATA-SDATA+51(1)    = 'X'.
  WA_IDOC_DATA-SDATA+59(1)    = 'X'.
  WA_IDOC_DATA-SDATA+70(1)    = 'X'.
  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
  WA_IDOC_DATA-SDATA+81(1)    = 'X'.
  WA_IDOC_DATA-SDATA+82(1)    = 'X'.
  WA_IDOC_DATA-SDATA+86(1)    = 'X'.
  WA_IDOC_DATA-SDATA+93(1)    = 'X'.
  WA_IDOC_DATA-SDATA+99(1)    = 'X'.
  WA_IDOC_DATA-SDATA+112(1)    = 'X'.
  WA_IDOC_DATA-SDATA+207(1)   = 'X'.
  WA_IDOC_DATA-SDATA+209(1)   = 'X'.
  WA_IDOC_DATA-SDATA+210(1)   = 'X'.
  WA_IDOC_DATA-SDATA+211(1)   = 'X'.
  WA_IDOC_DATA-SDATA+212(1)   = 'X'.
  WA_IDOC_DATA-SDATA+213(1)   = 'X'.
  WA_IDOC_DATA-SDATA+214(1)   = 'X'.
  WA_IDOC_DATA-SDATA+215(1)   = 'X'.
  WA_IDOC_DATA-SDATA+216(1)   = 'X'.
  WA_IDOC_DATA-SDATA+217(1)   = 'X'.
  WA_IDOC_DATA-SDATA+218(1)   = 'X'.
  WA_IDOC_DATA-SDATA+219(1)   = 'X'.
  WA_IDOC_DATA-SDATA+220(1)   = 'X'.
  WA_IDOC_DATA-SDATA+221(1)   = 'X'.
  WA_IDOC_DATA-SDATA+255(1)   = 'X'.
  WA_IDOC_DATA-SDATA+257(1)   = 'X'.
  WA_IDOC_DATA-SDATA+258(1)   = 'X'.
  WA_IDOC_DATA-SDATA+259(1)   = 'X'.
  WA_IDOC_DATA-SDATA+260(1)   = 'X'.
  WA_IDOC_DATA-SDATA+261(1)   = 'X'.
  WA_IDOC_DATA-SDATA+262(1)   = 'X'.
  WA_IDOC_DATA-SDATA+264(1)   = 'X'.
  WA_IDOC_DATA-SDATA+267(1)   = 'X'.
  WA_IDOC_DATA-SDATA+268(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARARTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+49(1)    = 'X'.""trans_grp
  WA_IDOC_DATA-SDATA+51(1)    = 'X'.
  WA_IDOC_DATA-SDATA+59(1)    = 'X'.
  WA_IDOC_DATA-SDATA+70(1)    = 'X'.
  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
  WA_IDOC_DATA-SDATA+81(1)    = 'X'.
  WA_IDOC_DATA-SDATA+82(1)    = 'X'.
  WA_IDOC_DATA-SDATA+86(1)    = 'X'.
  WA_IDOC_DATA-SDATA+93(1)    = 'X'.
  WA_IDOC_DATA-SDATA+99(1)    = 'X'.
  WA_IDOC_DATA-SDATA+112(1)   = 'X'.
  WA_IDOC_DATA-SDATA+207(1)   = 'X'.
  WA_IDOC_DATA-SDATA+209(1)   = 'X'.
  WA_IDOC_DATA-SDATA+210(1)   = 'X'.
  WA_IDOC_DATA-SDATA+211(1)   = 'X'.
  WA_IDOC_DATA-SDATA+212(1)   = 'X'.
  WA_IDOC_DATA-SDATA+213(1)   = 'X'.
  WA_IDOC_DATA-SDATA+214(1)   = 'X'.
  WA_IDOC_DATA-SDATA+215(1)   = 'X'.
  WA_IDOC_DATA-SDATA+216(1)   = 'X'.
  WA_IDOC_DATA-SDATA+217(1)   = 'X'.
  WA_IDOC_DATA-SDATA+218(1)   = 'X'.
  WA_IDOC_DATA-SDATA+219(1)   = 'X'.
  WA_IDOC_DATA-SDATA+220(1)   = 'X'.
  WA_IDOC_DATA-SDATA+221(1)   = 'X'.
  WA_IDOC_DATA-SDATA+255(1)   = 'X'.
  WA_IDOC_DATA-SDATA+257(1)   = 'X'.
  WA_IDOC_DATA-SDATA+258(1)   = 'X'.
  WA_IDOC_DATA-SDATA+259(1)   = 'X'.
  WA_IDOC_DATA-SDATA+260(1)   = 'X'.
  WA_IDOC_DATA-SDATA+261(1)   = 'X'.
  WA_IDOC_DATA-SDATA+262(1)   = 'X'.
  WA_IDOC_DATA-SDATA+264(1)   = 'X'.
  WA_IDOC_DATA-SDATA+267(1)   = 'X'.
  WA_IDOC_DATA-SDATA+268(40)  = <FS_FLATFILE1>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000005'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+40(3)    = <FS_FLATFILE>-COUNTRYORI."'0001'. "
  WA_IDOC_DATA-SDATA+48(4)    = LOADINGGRP."'0001'. "
**  WA_IDOC_DATA-SDATA+52(2)    = <FS_FLATFILE>-ASSORT_LEV."'0001'. "
  WA_IDOC_DATA-SDATA+55(2)    = LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'0001'. "
  WA_IDOC_DATA-SDATA+57(2)    = LI_PROC_ST."<FS_FLATFILE>-LI_PROC_DC."'0001'. "
***  SELECT SINGLE LDVFL FROM MAW1 INTO @DATA(V_MAW1) WHERE MATNR = @<FS_FLATFILE>-MATERIAL.
***  IF SY-SUBRC IS NOT INITIAL.
  WA_IDOC_DATA-SDATA+59(8)    = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
  WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
  WA_IDOC_DATA-SDATA+75(8)    = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
  WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
  WA_IDOC_DATA-SDATA+91(8)    = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
  WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
  WA_IDOC_DATA-SDATA+107(8)    = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
  WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
****  ELSE.
****    WA_IDOC_DATA-SDATA+59(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
****    WA_IDOC_DATA-SDATA+75(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
****    WA_IDOC_DATA-SDATA+91(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
****    WA_IDOC_DATA-SDATA+107(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
****  ENDIF.
  WA_IDOC_DATA-SDATA+123(4)   = VAL_CLASS."'3100'. "
  WA_IDOC_DATA-SDATA+240(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000005'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+40(3)    = <FS_FLATFILE>-COUNTRYORI.
  WA_IDOC_DATA-SDATA+48(4)    = LOADINGGRP."'0001'. "
**  WA_IDOC_DATA-SDATA+52(2)    = <FS_FLATFILE>-ASSORT_LEV."'0001'. "
  WA_IDOC_DATA-SDATA+55(2)    = LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'0001'. "
  WA_IDOC_DATA-SDATA+57(2)    = LI_PROC_ST."<FS_FLATFILE>-LI_PROC_DC."'0001'. "
**  IF V_MAW1 IS INITIAL.
  WA_IDOC_DATA-SDATA+59(8)     = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
  WA_IDOC_DATA-SDATA+67(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+75(8)     = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
  WA_IDOC_DATA-SDATA+83(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+91(8)     = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
  WA_IDOC_DATA-SDATA+99(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+107(8)     = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
  WA_IDOC_DATA-SDATA+115(8)     = '99991231'.
**  ELSE.
**    WA_IDOC_DATA-SDATA+59(8)    = V_MAW1.
**    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
**    WA_IDOC_DATA-SDATA+75(8)    = V_MAW1.
**    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
**    WA_IDOC_DATA-SDATA+91(8)    = V_MAW1.
**    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
**    WA_IDOC_DATA-SDATA+107(8)    = V_MAW1.
**    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
**  ENDIF.
  WA_IDOC_DATA-SDATA+123(4)   = VAL_CLASS."'3100'. "
  WA_IDOC_DATA-SDATA+240(40)  = <FS_FLATFILE1>-VARIANT_LONG.

  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000006'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(1)    = 'X'.
  WA_IDOC_DATA-SDATA+22(1)    = 'X'.
  WA_IDOC_DATA-SDATA+23(1)    = 'X'.
  WA_IDOC_DATA-SDATA+24(1)    = 'X'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.

  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+45(1)    = 'X'.
  WA_IDOC_DATA-SDATA+46(1)    = 'X'.
  WA_IDOC_DATA-SDATA+47(1)    = 'X'.
  WA_IDOC_DATA-SDATA+48(1)    = 'X'.
  WA_IDOC_DATA-SDATA+49(1)    = 'X'.
  WA_IDOC_DATA-SDATA+50(1)    = 'X'.
  WA_IDOC_DATA-SDATA+132(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000006'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(1)    = 'X'.
  WA_IDOC_DATA-SDATA+22(1)    = 'X'.
  WA_IDOC_DATA-SDATA+23(1)    = 'X'.
  WA_IDOC_DATA-SDATA+24(1)    = 'X'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+45(1)    = 'X'.
  WA_IDOC_DATA-SDATA+46(1)    = 'X'.
  WA_IDOC_DATA-SDATA+47(1)    = 'X'.
  WA_IDOC_DATA-SDATA+48(1)    = 'X'.
  WA_IDOC_DATA-SDATA+49(1)    = 'X'.
  WA_IDOC_DATA-SDATA+50(1)    = 'X'.
  WA_IDOC_DATA-SDATA+132(40)  = <FS_FLATFILE1>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000007'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAKTRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(1)    = 'E'.
  WA_IDOC_DATA-SDATA+22(2)    = 'EN'.
  WA_IDOC_DATA-SDATA+24(40)   = <FS_FLATFILE1>-MATL_DESC."
  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE1>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  """""""""""""""""""""""""""""""Plant data""""""""""""""""""""""""""""""""""""""""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT           = SY-MANDT.
  WA_IDOC_DATA-SEGNUM          = T2.                        "'000008'.
  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARCRT'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = 'RFDC'.
*  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
  WA_IDOC_DATA-SDATA+41(2)     = 'ND'."<FS_FLATFILE>-MRP_TYPE."'RP'.
*  WA_IDOC_DATA-SDATA+62(2)     = 'EX'.
  WA_IDOC_DATA-SDATA+264(4)    = LOADINGGRP."'0001'.
  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
  WA_IDOC_DATA-SDATA+276(2)    = AVAILCHECK."'01'.
*  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000009'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
  WA_IDOC_DATA-SDATA+54(1)    = 'X'.
  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
*  WA_IDOC_DATA-SDATA+11(4)   = <FS_FLATFILE>-GI_PR_TIME."
  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-MATERIAL."
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000008'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = 'RFDC'.
*  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
  WA_IDOC_DATA-SDATA+41(2)     = 'RP'."<FS_FLATFILE>-MRP_TYPE."'RP'.
  WA_IDOC_DATA-SDATA+62(2)     = 'EX'.
  WA_IDOC_DATA-SDATA+264(4)    = LOADINGGRP."'0001'.
  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
  WA_IDOC_DATA-SDATA+276(2)    = AVAILCHECK."'01'.
*  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000009'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
  WA_IDOC_DATA-SDATA+54(1)    = 'X'.
  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
**  IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
**    WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
**  ENDIF.
  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-VARIANT_LONG."
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT           = SY-MANDT.
  WA_IDOC_DATA-SEGNUM          = T2.                        "'000010'.
  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARCRT'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = 'RFST'.
*  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
  WA_IDOC_DATA-SDATA+41(2)     = 'ND'."<FS_FLATFILE>-MRP_TYPE."'RP'.
**  WA_IDOC_DATA-SDATA+43(3)     = <FS_FLATFILE>-MRP_CTRLER."'001'.
**  WA_IDOC_DATA-SDATA+46(4)     = <FS_FLATFILE>-PLND_DELRY."'1'.
**  WA_IDOC_DATA-SDATA+50(4)     = <FS_FLATFILE>-GR_PR_TIME."'0'.
**  WA_IDOC_DATA-SDATA+54(1)     = <FS_FLATFILE>-PERIOD_IND."'W'.
  WA_IDOC_DATA-SDATA+62(2)     = 'EX'."<FS_FLATFILE>-LOT_SIZE."'EX'.
**  WA_IDOC_DATA-SDATA+64(1)     = <FS_FLATFILE>-PROC_TYPE."'F'.
***  WA_IDOC_DATA-SDATA+65(2)     = <FS_FLATFILE>-SPPROCTYPE."'F'.
***  WA_IDOC_DATA-SDATA+67(15)    = <FS_FLATFILE>-REORDER_PT."'5.000'.
***  WA_IDOC_DATA-SDATA+157(15)   = <FS_FLATFILE>-MAX_STOCK."'5.000'.
***  WA_IDOC_DATA-SDATA+197(1)   = <FS_FLATFILE>-DEP_REQ_ID.
***  WA_IDOC_DATA-SDATA+229(3)   = <FS_FLATFILE>-SM_KEY.
*  WA_IDOC_DATA-SDATA+232(1)    = <FS_FLATFILE>-BACKFLUSH.
*  WA_IDOC_DATA-SDATA+233(4)    = <FS_FLATFILE>-INHSEPRODT.
  WA_IDOC_DATA-SDATA+264(4)    = LOADINGGRP."'0001'.
  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
  WA_IDOC_DATA-SDATA+276(2)    = AVAILCHECK."'01'.
*  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
****  WA_IDOC_DATA-SDATA+366(4)    = <FS_FLATFILE>-ISS_ST_LOC."'0000010120'.
*  WA_IDOC_DATA-SDATA+370(4)    = <FS_FLATFILE>-MRP_GROUP."'0000010120'.
*  WA_IDOC_DATA-SDATA+403(4)    = <FS_FLATFILE>-SERNO_PROF."'Z001'.
**  WA_IDOC_DATA-SDATA+486(4)    = <FS_FLATFILE>-PLAN_STRGP."'Z001'.
***  WA_IDOC_DATA-SDATA+488(4)    = <FS_FLATFILE>-STGE_LOC."'FG01'.
*  WA_IDOC_DATA-SDATA+511(1)    = <FS_FLATFILE>-BATCHENTRY.
  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
**  WA_IDOC_DATA-SDATA+606(3)    = <FS_FLATFILE>-PRODUCTION_SCHEDULER."'HSN123'.
****  WA_IDOC_DATA-SDATA+609(6)    = <FS_FLATFILE>-PROD_PROF."'HSN123'.
****  WA_IDOC_DATA-SDATA+641(5)    = <FS_FLATFILE>-UNDER_TOL."'HSN123'.
****  WA_IDOC_DATA-SDATA+646(5)    =  <FS_FLATFILE>-OVER_TOL."'HSN123'.
***  WA_IDOC_DATA-SDATA+694(6)    =  <FS_FLATFILE>-VARIANCE_KEY."'HSN123'.
  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
*  WA_IDOC_DATA-SDATA+731(15)   = <FS_FLATFILE>-MIN_SAFETY_STK."'1.000'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000011'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
  WA_IDOC_DATA-SDATA+54(1)    = 'X'.
  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-MATERIAL."
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000010'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = 'RFST'.
*  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
  WA_IDOC_DATA-SDATA+41(2)     = 'ND'."<FS_FLATFILE>-MRP_TYPE."'RP'.
***  WA_IDOC_DATA-SDATA+43(3)     = <FS_FLATFILE>-MRP_CTRLER."'001'.
***  WA_IDOC_DATA-SDATA+46(4)     = <FS_FLATFILE>-PLND_DELRY."'1'.
***  WA_IDOC_DATA-SDATA+50(4)     = <FS_FLATFILE>-GR_PR_TIME."'0'.
***  WA_IDOC_DATA-SDATA+54(1)     = <FS_FLATFILE>-PERIOD_IND."'W'.
  WA_IDOC_DATA-SDATA+62(2)     = 'EX'."<FS_FLATFILE>-LOT_SIZE."'EX'.
***  WA_IDOC_DATA-SDATA+64(1)     = <FS_FLATFILE>-PROC_TYPE."'F'.
***  WA_IDOC_DATA-SDATA+65(2)     = <FS_FLATFILE>-SPPROCTYPE."'F'.
***  WA_IDOC_DATA-SDATA+67(15)    = <FS_FLATFILE>-REORDER_PT."'5.000'.
***  WA_IDOC_DATA-SDATA+157(15)   = <FS_FLATFILE>-MAX_STOCK."'5.000'.
***  WA_IDOC_DATA-SDATA+197(1)    = <FS_FLATFILE>-DEP_REQ_ID.
***  WA_IDOC_DATA-SDATA+229(3)   = <FS_FLATFILE>-SM_KEY.
***  WA_IDOC_DATA-SDATA+232(1)    = <FS_FLATFILE>-BACKFLUSH.
***  WA_IDOC_DATA-SDATA+233(4)    = <FS_FLATFILE>-INHSEPRODT.
  WA_IDOC_DATA-SDATA+264(4)    = LOADINGGRP."'0001'.
  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
  WA_IDOC_DATA-SDATA+276(2)    = AVAILCHECK."'01'.
*  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
***  WA_IDOC_DATA-SDATA+366(4)    = <FS_FLATFILE>-ISS_ST_LOC."'0000010120'.
***  WA_IDOC_DATA-SDATA+370(4)    = <FS_FLATFILE>-MRP_GROUP."'0000010120'.
***  WA_IDOC_DATA-SDATA+403(4)    = <FS_FLATFILE>-SERNO_PROF."'Z001'.
***  WA_IDOC_DATA-SDATA+486(4)    = <FS_FLATFILE>-PLAN_STRGP."'Z001'.
******  WA_IDOC_DATA-SDATA+488(4)    = <FS_FLATFILE>-STGE_LOC."'FG01'.
***  WA_IDOC_DATA-SDATA+511(1)    = <FS_FLATFILE>-BATCHENTRY.
  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
****  WA_IDOC_DATA-SDATA+606(3)    = <FS_FLATFILE>-PRODUCTION_SCHEDULER."'HSN123'.
****  WA_IDOC_DATA-SDATA+609(6)    = <FS_FLATFILE>-PROD_PROF."'HSN123'.
****  WA_IDOC_DATA-SDATA+641(5)    = <FS_FLATFILE>-UNDER_TOL."'HSN123'.
****  WA_IDOC_DATA-SDATA+646(5)    =  <FS_FLATFILE>-OVER_TOL."'HSN123'.
****  WA_IDOC_DATA-SDATA+694(6)    =  <FS_FLATFILE>-VARIANCE_KEY."'HSN123'.
  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
***  WA_IDOC_DATA-SDATA+731(15)   = <FS_FLATFILE>-MIN_SAFETY_STK."'1.000'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000011'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
  WA_IDOC_DATA-SDATA+54(1)   = 'X'.
  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-VARIANT_LONG."
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  """"""""""""E1BPE1MARCRTX"""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000012'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARCRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+83(1) = 'X'.
  WA_IDOC_DATA-SDATA+84(1) = 'X'.
  WA_IDOC_DATA-SDATA+85(1) = 'X'.
  WA_IDOC_DATA-SDATA+86(1) = 'X'.
  WA_IDOC_DATA-SDATA+87(1) = 'X'.
  WA_IDOC_DATA-SDATA+88(1) = 'X'.
  WA_IDOC_DATA-SDATA+89(1) = 'X'.
  WA_IDOC_DATA-SDATA+90(1) = 'X'.
  WA_IDOC_DATA-SDATA+91(1) = 'X'.
  WA_IDOC_DATA-SDATA+92(1) = 'X'.
  WA_IDOC_DATA-SDATA+93(1) = 'X'.
  WA_IDOC_DATA-SDATA+94(1) = 'X'.
  WA_IDOC_DATA-SDATA+95(1) = 'X'.
  WA_IDOC_DATA-SDATA+96(1) = 'X'.
  WA_IDOC_DATA-SDATA+97(1) = 'X'.
  WA_IDOC_DATA-SDATA+98(1) = 'X'.
  WA_IDOC_DATA-SDATA+99(1) = 'X'.
  WA_IDOC_DATA-SDATA+100(1) = 'X'.
  WA_IDOC_DATA-SDATA+101(1) = 'X'.
  WA_IDOC_DATA-SDATA+102(1) = 'X'.
  WA_IDOC_DATA-SDATA+103(1) = 'X'.
  WA_IDOC_DATA-SDATA+104(1) = 'X'.
  WA_IDOC_DATA-SDATA+105(1) = 'X'.
  WA_IDOC_DATA-SDATA+106(1) = 'X'.
  WA_IDOC_DATA-SDATA+107(1) = 'X'.
  WA_IDOC_DATA-SDATA+108(1) = 'X'.
  WA_IDOC_DATA-SDATA+109(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(1) = 'X'.
  WA_IDOC_DATA-SDATA+114(1) = 'X'.
  WA_IDOC_DATA-SDATA+115(1) = 'X'.
  WA_IDOC_DATA-SDATA+116(1) = 'X'.
  WA_IDOC_DATA-SDATA+117(1) = 'X'.
  WA_IDOC_DATA-SDATA+118(1) = 'X'.
  WA_IDOC_DATA-SDATA+119(1) = 'X'.
  WA_IDOC_DATA-SDATA+120(1) = 'X'.
  WA_IDOC_DATA-SDATA+121(1) = 'X'.
  WA_IDOC_DATA-SDATA+122(1) = 'X'.
  WA_IDOC_DATA-SDATA+123(1) = 'X'.
  WA_IDOC_DATA-SDATA+124(1) = 'X'.
  WA_IDOC_DATA-SDATA+125(1) = 'X'.
  WA_IDOC_DATA-SDATA+126(1) = 'X'.
  WA_IDOC_DATA-SDATA+127(1) = 'X'.
  WA_IDOC_DATA-SDATA+128(1) = 'X'.
  WA_IDOC_DATA-SDATA+129(1) = 'X'.
  WA_IDOC_DATA-SDATA+130(1) = 'X'.
  WA_IDOC_DATA-SDATA+131(1) = 'X'.
  WA_IDOC_DATA-SDATA+132(1) = 'X'.
  WA_IDOC_DATA-SDATA+133(1) = 'X'.
  WA_IDOC_DATA-SDATA+134(1) = 'X'.
  WA_IDOC_DATA-SDATA+135(1) = 'X'.
  WA_IDOC_DATA-SDATA+136(1) = 'X'.
  WA_IDOC_DATA-SDATA+137(1) = 'X'.
  WA_IDOC_DATA-SDATA+138(1) = 'X'.
  WA_IDOC_DATA-SDATA+139(1) = 'X'.
  WA_IDOC_DATA-SDATA+140(1) = 'X'.
  WA_IDOC_DATA-SDATA+141(1) = 'X'.
  WA_IDOC_DATA-SDATA+142(1) = 'X'.
  WA_IDOC_DATA-SDATA+143(1) = 'X'.
  WA_IDOC_DATA-SDATA+144(1) = 'X'.
  WA_IDOC_DATA-SDATA+145(1) = 'X'.
  WA_IDOC_DATA-SDATA+146(1) = 'X'.
  WA_IDOC_DATA-SDATA+147(1) = 'X'.
  WA_IDOC_DATA-SDATA+148(1) = 'X'.
  WA_IDOC_DATA-SDATA+149(1) = 'X'.
  WA_IDOC_DATA-SDATA+150(1) = 'X'.
  WA_IDOC_DATA-SDATA+151(1) = 'X'.
  WA_IDOC_DATA-SDATA+152(1) = 'X'.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  WA_IDOC_DATA-SDATA+154(1) = 'X'.
  WA_IDOC_DATA-SDATA+155(1) = 'X'.
  WA_IDOC_DATA-SDATA+156(1) = 'X'.
  WA_IDOC_DATA-SDATA+157(1) = 'X'.
  WA_IDOC_DATA-SDATA+158(1) = 'X'.
  WA_IDOC_DATA-SDATA+159(1) = 'X'.
  WA_IDOC_DATA-SDATA+160(1) = 'X'.
  WA_IDOC_DATA-SDATA+161(1) = 'X'.
  WA_IDOC_DATA-SDATA+162(1) = 'X'.
  WA_IDOC_DATA-SDATA+163(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(1) = 'X'.
  WA_IDOC_DATA-SDATA+169(1) = 'X'.
  WA_IDOC_DATA-SDATA+252(1) = 'X'.
  WA_IDOC_DATA-SDATA+253(1) = 'X'.
  WA_IDOC_DATA-SDATA+254(1) = 'X'.
  WA_IDOC_DATA-SDATA+255(1) = 'X'.
  WA_IDOC_DATA-SDATA+256(1) = 'X'.
  WA_IDOC_DATA-SDATA+257(1) = 'X'.
*  WA_IDOC_DATA-SDATA+258(1) = 'X'.
  WA_IDOC_DATA-SDATA+259(1) = 'X'.
  WA_IDOC_DATA-SDATA+260(1) = 'X'.
  WA_IDOC_DATA-SDATA+261(1) = 'X'.
  WA_IDOC_DATA-SDATA+262(1) = 'X'.
  WA_IDOC_DATA-SDATA+263(1) = 'X'.
  WA_IDOC_DATA-SDATA+264(1) = 'X'.
  WA_IDOC_DATA-SDATA+265(1) = 'X'.
  WA_IDOC_DATA-SDATA+266(1) = 'X'.
  WA_IDOC_DATA-SDATA+267(1) = 'X'.
  WA_IDOC_DATA-SDATA+268(1) = 'X'.
  WA_IDOC_DATA-SDATA+269(1) = 'X'.
  WA_IDOC_DATA-SDATA+270(1) = 'X'.
  WA_IDOC_DATA-SDATA+271(1) = 'X'.
  WA_IDOC_DATA-SDATA+272(1) = 'X'.
  WA_IDOC_DATA-SDATA+273(1) = 'X'.
  WA_IDOC_DATA-SDATA+274(1) = 'X'.
  WA_IDOC_DATA-SDATA+275(1) = 'X'.
  WA_IDOC_DATA-SDATA+276(1) = 'X'.
  WA_IDOC_DATA-SDATA+277(1) = 'X'.
  WA_IDOC_DATA-SDATA+278(1) = 'X'.
  WA_IDOC_DATA-SDATA+279(1) = 'X'.
  WA_IDOC_DATA-SDATA+280(1) = 'X'.
  WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-MATERIAL."
  WA_IDOC_DATA-SDATA+321(1) = 'X'.
  WA_IDOC_DATA-SDATA+322(1) = 'X'.
  WA_IDOC_DATA-SDATA+323(1) = 'X'.
  WA_IDOC_DATA-SDATA+324(1) = 'X'.
  WA_IDOC_DATA-SDATA+325(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*  """"""""""""E1BPE1MARCRTX"""""""""""
  T2 = T2 + 1.
  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
    IF <FS_FLATFILE1> IS ASSIGNED.
      WA_IDOC_DATA-MANDT       = SY-MANDT.
      WA_IDOC_DATA-SEGNUM      = T2.                        "'000012'.
      WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARCRTX'.
      WA_IDOC_DATA-SDATA+0(3)  = '005'.

      WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.

      WA_IDOC_DATA-SDATA+25(1) = 'X'.
      WA_IDOC_DATA-SDATA+26(1) = 'X'.
      WA_IDOC_DATA-SDATA+27(1) = 'X'.
      WA_IDOC_DATA-SDATA+28(1) = 'X'.
      WA_IDOC_DATA-SDATA+29(1) = 'X'.
      WA_IDOC_DATA-SDATA+30(1) = 'X'.
      WA_IDOC_DATA-SDATA+31(1) = 'X'.
      WA_IDOC_DATA-SDATA+32(1) = 'X'.
      WA_IDOC_DATA-SDATA+33(1) = 'X'.
      WA_IDOC_DATA-SDATA+34(1) = 'X'.
      WA_IDOC_DATA-SDATA+35(1) = 'X'.
      WA_IDOC_DATA-SDATA+36(1) = 'X'.
      WA_IDOC_DATA-SDATA+37(1) = 'X'.
      WA_IDOC_DATA-SDATA+38(1) = 'X'.
      WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
      WA_IDOC_DATA-SDATA+40(1) = 'X'.
      WA_IDOC_DATA-SDATA+41(1) = 'X'.
      WA_IDOC_DATA-SDATA+42(1) = 'X'.
      WA_IDOC_DATA-SDATA+43(1) = 'X'.
      WA_IDOC_DATA-SDATA+44(1) = 'X'.
      WA_IDOC_DATA-SDATA+45(1) = 'X'.
      WA_IDOC_DATA-SDATA+46(1) = 'X'.
      WA_IDOC_DATA-SDATA+47(1) = 'X'.
      WA_IDOC_DATA-SDATA+48(1) = 'X'.
      WA_IDOC_DATA-SDATA+49(1) = 'X'.
      WA_IDOC_DATA-SDATA+50(1) = 'X'.
      WA_IDOC_DATA-SDATA+51(1) = 'X'.
      WA_IDOC_DATA-SDATA+52(1) = 'X'.
      WA_IDOC_DATA-SDATA+53(1) = 'X'.
      WA_IDOC_DATA-SDATA+54(1) = 'X'.
      WA_IDOC_DATA-SDATA+55(1) = 'X'.
      WA_IDOC_DATA-SDATA+56(1) = 'X'.
      WA_IDOC_DATA-SDATA+57(1) = 'X'.
      WA_IDOC_DATA-SDATA+58(1) = 'X'.
      WA_IDOC_DATA-SDATA+59(1) = 'X'.
      WA_IDOC_DATA-SDATA+60(1) = 'X'.
      WA_IDOC_DATA-SDATA+61(1) = 'X'.
      WA_IDOC_DATA-SDATA+62(1) = 'X'.
      WA_IDOC_DATA-SDATA+63(1) = 'X'.
      WA_IDOC_DATA-SDATA+64(1) = 'X'.
      WA_IDOC_DATA-SDATA+65(1) = 'X'.
      WA_IDOC_DATA-SDATA+66(1) = 'X'.
      WA_IDOC_DATA-SDATA+67(1) = 'X'.
      WA_IDOC_DATA-SDATA+68(1) = 'X'.
      WA_IDOC_DATA-SDATA+69(1) = 'X'.
      WA_IDOC_DATA-SDATA+70(1) = 'X'.
      WA_IDOC_DATA-SDATA+71(1) = 'X'.
      WA_IDOC_DATA-SDATA+72(1) = 'X'.
      WA_IDOC_DATA-SDATA+73(1) = 'X'.
      WA_IDOC_DATA-SDATA+74(1) = 'X'.
      WA_IDOC_DATA-SDATA+75(1) = 'X'.
      WA_IDOC_DATA-SDATA+76(1) = 'X'.
      WA_IDOC_DATA-SDATA+77(1) = 'X'.
      WA_IDOC_DATA-SDATA+78(1) = 'X'.
      WA_IDOC_DATA-SDATA+79(1) = 'X'.
      WA_IDOC_DATA-SDATA+80(1) = 'X'.
      WA_IDOC_DATA-SDATA+81(1) = 'X'.
      WA_IDOC_DATA-SDATA+82(1) = 'X'.
      WA_IDOC_DATA-SDATA+83(1) = 'X'.
      WA_IDOC_DATA-SDATA+84(1) = 'X'.
      WA_IDOC_DATA-SDATA+85(1) = 'X'.
      WA_IDOC_DATA-SDATA+86(1) = 'X'.
      WA_IDOC_DATA-SDATA+87(1) = 'X'.
      WA_IDOC_DATA-SDATA+88(1) = 'X'.
      WA_IDOC_DATA-SDATA+89(1) = 'X'.
      WA_IDOC_DATA-SDATA+90(1) = 'X'.
      WA_IDOC_DATA-SDATA+91(1) = 'X'.
      WA_IDOC_DATA-SDATA+92(1) = 'X'.
      WA_IDOC_DATA-SDATA+93(1) = 'X'.
      WA_IDOC_DATA-SDATA+94(1) = 'X'.
      WA_IDOC_DATA-SDATA+95(1) = 'X'.
      WA_IDOC_DATA-SDATA+96(1) = 'X'.
      WA_IDOC_DATA-SDATA+97(1) = 'X'.
      WA_IDOC_DATA-SDATA+98(1) = 'X'.
      WA_IDOC_DATA-SDATA+99(1) = 'X'.
      WA_IDOC_DATA-SDATA+100(1) = 'X'.
      WA_IDOC_DATA-SDATA+101(1) = 'X'.
      WA_IDOC_DATA-SDATA+102(1) = 'X'.
      WA_IDOC_DATA-SDATA+103(1) = 'X'.
      WA_IDOC_DATA-SDATA+104(1) = 'X'.
      WA_IDOC_DATA-SDATA+105(1) = 'X'.
      WA_IDOC_DATA-SDATA+106(1) = 'X'.
      WA_IDOC_DATA-SDATA+107(1) = 'X'.
      WA_IDOC_DATA-SDATA+108(1) = 'X'.
      WA_IDOC_DATA-SDATA+109(1) = 'X'.
      WA_IDOC_DATA-SDATA+110(1) = 'X'.
      WA_IDOC_DATA-SDATA+111(1) = 'X'.
      WA_IDOC_DATA-SDATA+112(1) = 'X'.
      WA_IDOC_DATA-SDATA+113(1) = 'X'.
      WA_IDOC_DATA-SDATA+114(1) = 'X'.
      WA_IDOC_DATA-SDATA+115(1) = 'X'.
      WA_IDOC_DATA-SDATA+116(1) = 'X'.
      WA_IDOC_DATA-SDATA+117(1) = 'X'.
      WA_IDOC_DATA-SDATA+118(1) = 'X'.
      WA_IDOC_DATA-SDATA+119(1) = 'X'.
      WA_IDOC_DATA-SDATA+120(1) = 'X'.
      WA_IDOC_DATA-SDATA+121(1) = 'X'.
      WA_IDOC_DATA-SDATA+122(1) = 'X'.
      WA_IDOC_DATA-SDATA+123(1) = 'X'.
      WA_IDOC_DATA-SDATA+124(1) = 'X'.
      WA_IDOC_DATA-SDATA+125(1) = 'X'.
      WA_IDOC_DATA-SDATA+126(1) = 'X'.
      WA_IDOC_DATA-SDATA+127(1) = 'X'.
      WA_IDOC_DATA-SDATA+128(1) = 'X'.
      WA_IDOC_DATA-SDATA+129(1) = 'X'.
      WA_IDOC_DATA-SDATA+130(1) = 'X'.
      WA_IDOC_DATA-SDATA+131(1) = 'X'.
      WA_IDOC_DATA-SDATA+132(1) = 'X'.
      WA_IDOC_DATA-SDATA+133(1) = 'X'.
      WA_IDOC_DATA-SDATA+134(1) = 'X'.
      WA_IDOC_DATA-SDATA+135(1) = 'X'.
      WA_IDOC_DATA-SDATA+136(1) = 'X'.
      WA_IDOC_DATA-SDATA+137(1) = 'X'.
      WA_IDOC_DATA-SDATA+138(1) = 'X'.
      WA_IDOC_DATA-SDATA+139(1) = 'X'.
      WA_IDOC_DATA-SDATA+140(1) = 'X'.
      WA_IDOC_DATA-SDATA+141(1) = 'X'.
      WA_IDOC_DATA-SDATA+142(1) = 'X'.
      WA_IDOC_DATA-SDATA+143(1) = 'X'.
      WA_IDOC_DATA-SDATA+144(1) = 'X'.
      WA_IDOC_DATA-SDATA+145(1) = 'X'.
      WA_IDOC_DATA-SDATA+146(1) = 'X'.
      WA_IDOC_DATA-SDATA+147(1) = 'X'.
      WA_IDOC_DATA-SDATA+148(1) = 'X'.
      WA_IDOC_DATA-SDATA+149(1) = 'X'.
      WA_IDOC_DATA-SDATA+150(1) = 'X'.
      WA_IDOC_DATA-SDATA+151(1) = 'X'.
      WA_IDOC_DATA-SDATA+152(1) = 'X'.
      WA_IDOC_DATA-SDATA+153(1) = 'X'.
      WA_IDOC_DATA-SDATA+154(1) = 'X'.
      WA_IDOC_DATA-SDATA+155(1) = 'X'.
      WA_IDOC_DATA-SDATA+156(1) = 'X'.
      WA_IDOC_DATA-SDATA+157(1) = 'X'.
      WA_IDOC_DATA-SDATA+158(1) = 'X'.
      WA_IDOC_DATA-SDATA+159(1) = 'X'.
      WA_IDOC_DATA-SDATA+160(1) = 'X'.
      WA_IDOC_DATA-SDATA+161(1) = 'X'.
      WA_IDOC_DATA-SDATA+162(1) = 'X'.
      WA_IDOC_DATA-SDATA+163(1) = 'X'.
      WA_IDOC_DATA-SDATA+164(1) = 'X'.
      WA_IDOC_DATA-SDATA+165(1) = 'X'.
      WA_IDOC_DATA-SDATA+166(1) = 'X'.
      WA_IDOC_DATA-SDATA+167(1) = 'X'.
      WA_IDOC_DATA-SDATA+168(1) = 'X'.
      WA_IDOC_DATA-SDATA+169(1) = 'X'.
      WA_IDOC_DATA-SDATA+252(1) = 'X'.
      WA_IDOC_DATA-SDATA+253(1) = 'X'.
      WA_IDOC_DATA-SDATA+254(1) = 'X'.
      WA_IDOC_DATA-SDATA+255(1) = 'X'.
      WA_IDOC_DATA-SDATA+256(1) = 'X'.
      WA_IDOC_DATA-SDATA+257(1) = 'X'.
*  WA_IDOC_DATA-SDATA+258(1) = 'X'.
      WA_IDOC_DATA-SDATA+259(1) = 'X'.
      WA_IDOC_DATA-SDATA+260(1) = 'X'.
      WA_IDOC_DATA-SDATA+261(1) = 'X'.
      WA_IDOC_DATA-SDATA+262(1) = 'X'.
      WA_IDOC_DATA-SDATA+263(1) = 'X'.
      WA_IDOC_DATA-SDATA+264(1) = 'X'.
      WA_IDOC_DATA-SDATA+265(1) = 'X'.
      WA_IDOC_DATA-SDATA+266(1) = 'X'.
      WA_IDOC_DATA-SDATA+267(1) = 'X'.
      WA_IDOC_DATA-SDATA+268(1) = 'X'.
      WA_IDOC_DATA-SDATA+269(1) = 'X'.
      WA_IDOC_DATA-SDATA+270(1) = 'X'.
      WA_IDOC_DATA-SDATA+271(1) = 'X'.
      WA_IDOC_DATA-SDATA+272(1) = 'X'.
      WA_IDOC_DATA-SDATA+273(1) = 'X'.
      WA_IDOC_DATA-SDATA+274(1) = 'X'.
      WA_IDOC_DATA-SDATA+275(1) = 'X'.
      WA_IDOC_DATA-SDATA+276(1) = 'X'.
      WA_IDOC_DATA-SDATA+277(1) = 'X'.
      WA_IDOC_DATA-SDATA+278(1) = 'X'.
      WA_IDOC_DATA-SDATA+279(1) = 'X'.
      WA_IDOC_DATA-SDATA+280(1) = 'X'.
      WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-VARIANT_LONG."
      WA_IDOC_DATA-SDATA+321(1) = 'X'.
      WA_IDOC_DATA-SDATA+322(1) = 'X'.
      WA_IDOC_DATA-SDATA+323(1) = 'X'.
      WA_IDOC_DATA-SDATA+324(1) = 'X'.
      WA_IDOC_DATA-SDATA+325(1) = 'X'.
      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
      CLEAR WA_IDOC_DATA.
      T2 = T2 + 1.
    ENDIF.
  ENDLOOP.

  """"""""""""E1BPE1MARCRTX"""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000013'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRTX'.
  WA_IDOC_DATA-SDATA+0(3)    = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
*  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+83(1) = 'X'.
  WA_IDOC_DATA-SDATA+84(1) = 'X'.
  WA_IDOC_DATA-SDATA+85(1) = 'X'.
  WA_IDOC_DATA-SDATA+86(1) = 'X'.
  WA_IDOC_DATA-SDATA+87(1) = 'X'.
  WA_IDOC_DATA-SDATA+88(1) = 'X'.
  WA_IDOC_DATA-SDATA+89(1) = 'X'.
  WA_IDOC_DATA-SDATA+90(1) = 'X'.
  WA_IDOC_DATA-SDATA+91(1) = 'X'.
  WA_IDOC_DATA-SDATA+92(1) = 'X'.
  WA_IDOC_DATA-SDATA+93(1) = 'X'.
  WA_IDOC_DATA-SDATA+94(1) = 'X'.
  WA_IDOC_DATA-SDATA+95(1) = 'X'.
  WA_IDOC_DATA-SDATA+96(1) = 'X'.
  WA_IDOC_DATA-SDATA+97(1) = 'X'.
  WA_IDOC_DATA-SDATA+98(1) = 'X'.
  WA_IDOC_DATA-SDATA+99(1) = 'X'.
  WA_IDOC_DATA-SDATA+100(1) = 'X'.
  WA_IDOC_DATA-SDATA+101(1) = 'X'.
  WA_IDOC_DATA-SDATA+102(1) = 'X'.
  WA_IDOC_DATA-SDATA+103(1) = 'X'.
  WA_IDOC_DATA-SDATA+104(1) = 'X'.
  WA_IDOC_DATA-SDATA+105(1) = 'X'.
  WA_IDOC_DATA-SDATA+106(1) = 'X'.
  WA_IDOC_DATA-SDATA+107(1) = 'X'.
  WA_IDOC_DATA-SDATA+108(1) = 'X'.
  WA_IDOC_DATA-SDATA+109(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(1) = 'X'.
  WA_IDOC_DATA-SDATA+114(1) = 'X'.
  WA_IDOC_DATA-SDATA+115(1) = 'X'.
  WA_IDOC_DATA-SDATA+116(1) = 'X'.
  WA_IDOC_DATA-SDATA+117(1) = 'X'.
  WA_IDOC_DATA-SDATA+118(1) = 'X'.
  WA_IDOC_DATA-SDATA+119(1) = 'X'.
**  WA_IDOC_DATA-SDATA+120(1) = 'X'.
  WA_IDOC_DATA-SDATA+121(1) = 'X'.
  WA_IDOC_DATA-SDATA+122(1) = 'X'.
  WA_IDOC_DATA-SDATA+123(1) = 'X'.
  WA_IDOC_DATA-SDATA+124(1) = 'X'.
  WA_IDOC_DATA-SDATA+125(1) = 'X'.
  WA_IDOC_DATA-SDATA+126(1) = 'X'.
  WA_IDOC_DATA-SDATA+127(1) = 'X'.
  WA_IDOC_DATA-SDATA+128(1) = 'X'.
  WA_IDOC_DATA-SDATA+129(1) = 'X'.
  WA_IDOC_DATA-SDATA+130(1) = 'X'.
  WA_IDOC_DATA-SDATA+131(1) = 'X'.
  WA_IDOC_DATA-SDATA+132(1) = 'X'.
  WA_IDOC_DATA-SDATA+133(1) = 'X'.
  WA_IDOC_DATA-SDATA+134(1) = 'X'.
  WA_IDOC_DATA-SDATA+135(1) = 'X'.
  WA_IDOC_DATA-SDATA+136(1) = 'X'.
  WA_IDOC_DATA-SDATA+137(1) = 'X'.
  WA_IDOC_DATA-SDATA+138(1) = 'X'.
  WA_IDOC_DATA-SDATA+139(1) = 'X'.
  WA_IDOC_DATA-SDATA+140(1) = 'X'.
  WA_IDOC_DATA-SDATA+141(1) = 'X'.
  WA_IDOC_DATA-SDATA+142(1) = 'X'.
  WA_IDOC_DATA-SDATA+143(1) = 'X'.
  WA_IDOC_DATA-SDATA+144(1) = 'X'.
  WA_IDOC_DATA-SDATA+145(1) = 'X'.
  WA_IDOC_DATA-SDATA+146(1) = 'X'.
  WA_IDOC_DATA-SDATA+147(1) = 'X'.
  WA_IDOC_DATA-SDATA+148(1) = 'X'.
  WA_IDOC_DATA-SDATA+149(1) = 'X'.
  WA_IDOC_DATA-SDATA+150(1) = 'X'.
  WA_IDOC_DATA-SDATA+151(1) = 'X'.
  WA_IDOC_DATA-SDATA+152(1) = 'X'.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  WA_IDOC_DATA-SDATA+154(1) = 'X'.
  WA_IDOC_DATA-SDATA+155(1) = 'X'.
  WA_IDOC_DATA-SDATA+156(1) = 'X'.
  WA_IDOC_DATA-SDATA+157(1) = 'X'.
  WA_IDOC_DATA-SDATA+158(1) = 'X'.
  WA_IDOC_DATA-SDATA+159(1) = 'X'.
  WA_IDOC_DATA-SDATA+160(1) = 'X'.
  WA_IDOC_DATA-SDATA+161(1) = 'X'.
  WA_IDOC_DATA-SDATA+162(1) = 'X'.
  WA_IDOC_DATA-SDATA+163(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(1) = 'X'.
  WA_IDOC_DATA-SDATA+169(1) = 'X'.
  WA_IDOC_DATA-SDATA+252(1) = 'X'.
  WA_IDOC_DATA-SDATA+253(1) = 'X'.
  WA_IDOC_DATA-SDATA+254(1) = 'X'.
  WA_IDOC_DATA-SDATA+255(1) = 'X'.
  WA_IDOC_DATA-SDATA+256(1) = 'X'.
  WA_IDOC_DATA-SDATA+257(1) = 'X'.
  WA_IDOC_DATA-SDATA+258(1) = 'X'.
  WA_IDOC_DATA-SDATA+259(1) = 'X'.
  WA_IDOC_DATA-SDATA+260(1) = 'X'.
  WA_IDOC_DATA-SDATA+261(1) = 'X'.
  WA_IDOC_DATA-SDATA+262(1) = 'X'.
  WA_IDOC_DATA-SDATA+263(1) = 'X'.
  WA_IDOC_DATA-SDATA+264(1) = 'X'.
  WA_IDOC_DATA-SDATA+265(1) = 'X'.
  WA_IDOC_DATA-SDATA+266(1) = 'X'.
  WA_IDOC_DATA-SDATA+267(1) = 'X'.
  WA_IDOC_DATA-SDATA+268(1) = 'X'.
  WA_IDOC_DATA-SDATA+269(1) = 'X'.
  WA_IDOC_DATA-SDATA+270(1) = 'X'.
  WA_IDOC_DATA-SDATA+271(1) = 'X'.
  WA_IDOC_DATA-SDATA+272(1) = 'X'.
  WA_IDOC_DATA-SDATA+273(1) = 'X'.
  WA_IDOC_DATA-SDATA+274(1) = 'X'.
  WA_IDOC_DATA-SDATA+275(1) = 'X'.
  WA_IDOC_DATA-SDATA+276(1) = 'X'.
  WA_IDOC_DATA-SDATA+277(1) = 'X'.
  WA_IDOC_DATA-SDATA+278(1) = 'X'.
  WA_IDOC_DATA-SDATA+279(1) = 'X'.
  WA_IDOC_DATA-SDATA+280(1) = 'X'.
  WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-MATERIAL."
  WA_IDOC_DATA-SDATA+321(1) = 'X'.
  WA_IDOC_DATA-SDATA+322(1) = 'X'.
  WA_IDOC_DATA-SDATA+323(1) = 'X'.
  WA_IDOC_DATA-SDATA+324(1) = 'X'.
  WA_IDOC_DATA-SDATA+325(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  """"""""""""E1BPE1MARCRTX"""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000013'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRTX'.
  WA_IDOC_DATA-SDATA+0(3)    = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
*  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'."""PROC_TYPE
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+83(1) = 'X'.
  WA_IDOC_DATA-SDATA+84(1) = 'X'.
  WA_IDOC_DATA-SDATA+85(1) = 'X'.
  WA_IDOC_DATA-SDATA+86(1) = 'X'.
  WA_IDOC_DATA-SDATA+87(1) = 'X'.
  WA_IDOC_DATA-SDATA+88(1) = 'X'.
  WA_IDOC_DATA-SDATA+89(1) = 'X'.
  WA_IDOC_DATA-SDATA+90(1) = 'X'.
  WA_IDOC_DATA-SDATA+91(1) = 'X'.
  WA_IDOC_DATA-SDATA+92(1) = 'X'.
  WA_IDOC_DATA-SDATA+93(1) = 'X'.
  WA_IDOC_DATA-SDATA+94(1) = 'X'.
  WA_IDOC_DATA-SDATA+95(1) = 'X'.
  WA_IDOC_DATA-SDATA+96(1) = 'X'.
  WA_IDOC_DATA-SDATA+97(1) = 'X'.
  WA_IDOC_DATA-SDATA+98(1) = 'X'.
  WA_IDOC_DATA-SDATA+99(1) = 'X'.
  WA_IDOC_DATA-SDATA+100(1) = 'X'.
  WA_IDOC_DATA-SDATA+101(1) = 'X'.
  WA_IDOC_DATA-SDATA+102(1) = 'X'.
  WA_IDOC_DATA-SDATA+103(1) = 'X'.
  WA_IDOC_DATA-SDATA+104(1) = 'X'.
  WA_IDOC_DATA-SDATA+105(1) = 'X'.
  WA_IDOC_DATA-SDATA+106(1) = 'X'.
  WA_IDOC_DATA-SDATA+107(1) = 'X'.
  WA_IDOC_DATA-SDATA+108(1) = 'X'.
  WA_IDOC_DATA-SDATA+109(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(1) = 'X'.
  WA_IDOC_DATA-SDATA+114(1) = 'X'.
  WA_IDOC_DATA-SDATA+115(1) = 'X'.
  WA_IDOC_DATA-SDATA+116(1) = 'X'.
  WA_IDOC_DATA-SDATA+117(1) = 'X'.
  WA_IDOC_DATA-SDATA+118(1) = 'X'.
  WA_IDOC_DATA-SDATA+119(1) = 'X'.
***  WA_IDOC_DATA-SDATA+120(1) = 'X'.
  WA_IDOC_DATA-SDATA+121(1) = 'X'.
  WA_IDOC_DATA-SDATA+122(1) = 'X'.
  WA_IDOC_DATA-SDATA+123(1) = 'X'.
  WA_IDOC_DATA-SDATA+124(1) = 'X'.
  WA_IDOC_DATA-SDATA+125(1) = 'X'.
  WA_IDOC_DATA-SDATA+126(1) = 'X'.
  WA_IDOC_DATA-SDATA+127(1) = 'X'.
  WA_IDOC_DATA-SDATA+128(1) = 'X'.
  WA_IDOC_DATA-SDATA+129(1) = 'X'.
  WA_IDOC_DATA-SDATA+130(1) = 'X'.
  WA_IDOC_DATA-SDATA+131(1) = 'X'.
  WA_IDOC_DATA-SDATA+132(1) = 'X'.
  WA_IDOC_DATA-SDATA+133(1) = 'X'.
  WA_IDOC_DATA-SDATA+134(1) = 'X'.
  WA_IDOC_DATA-SDATA+135(1) = 'X'.
  WA_IDOC_DATA-SDATA+136(1) = 'X'.
  WA_IDOC_DATA-SDATA+137(1) = 'X'.
  WA_IDOC_DATA-SDATA+138(1) = 'X'.
  WA_IDOC_DATA-SDATA+139(1) = 'X'.
  WA_IDOC_DATA-SDATA+140(1) = 'X'.
  WA_IDOC_DATA-SDATA+141(1) = 'X'.
  WA_IDOC_DATA-SDATA+142(1) = 'X'.
  WA_IDOC_DATA-SDATA+143(1) = 'X'.
  WA_IDOC_DATA-SDATA+144(1) = 'X'.
  WA_IDOC_DATA-SDATA+145(1) = 'X'.
  WA_IDOC_DATA-SDATA+146(1) = 'X'.
  WA_IDOC_DATA-SDATA+147(1) = 'X'.
  WA_IDOC_DATA-SDATA+148(1) = 'X'.
  WA_IDOC_DATA-SDATA+149(1) = 'X'.
  WA_IDOC_DATA-SDATA+150(1) = 'X'.
  WA_IDOC_DATA-SDATA+151(1) = 'X'.
  WA_IDOC_DATA-SDATA+152(1) = 'X'.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  WA_IDOC_DATA-SDATA+154(1) = 'X'.
  WA_IDOC_DATA-SDATA+155(1) = 'X'.
  WA_IDOC_DATA-SDATA+156(1) = 'X'.
  WA_IDOC_DATA-SDATA+157(1) = 'X'.
  WA_IDOC_DATA-SDATA+158(1) = 'X'.
  WA_IDOC_DATA-SDATA+159(1) = 'X'.
  WA_IDOC_DATA-SDATA+160(1) = 'X'.
  WA_IDOC_DATA-SDATA+161(1) = 'X'.
  WA_IDOC_DATA-SDATA+162(1) = 'X'.
  WA_IDOC_DATA-SDATA+163(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(1) = 'X'.
  WA_IDOC_DATA-SDATA+169(1) = 'X'.
  WA_IDOC_DATA-SDATA+252(1) = 'X'.
  WA_IDOC_DATA-SDATA+253(1) = 'X'.
  WA_IDOC_DATA-SDATA+254(1) = 'X'.
  WA_IDOC_DATA-SDATA+255(1) = 'X'.
  WA_IDOC_DATA-SDATA+256(1) = 'X'.
  WA_IDOC_DATA-SDATA+257(1) = 'X'.
  WA_IDOC_DATA-SDATA+258(1) = 'X'.
  WA_IDOC_DATA-SDATA+259(1) = 'X'.
  WA_IDOC_DATA-SDATA+260(1) = 'X'.
  WA_IDOC_DATA-SDATA+261(1) = 'X'.
  WA_IDOC_DATA-SDATA+262(1) = 'X'.
  WA_IDOC_DATA-SDATA+263(1) = 'X'.
  WA_IDOC_DATA-SDATA+264(1) = 'X'.
  WA_IDOC_DATA-SDATA+265(1) = 'X'.
  WA_IDOC_DATA-SDATA+266(1) = 'X'.
  WA_IDOC_DATA-SDATA+267(1) = 'X'.
  WA_IDOC_DATA-SDATA+268(1) = 'X'.
  WA_IDOC_DATA-SDATA+269(1) = 'X'.
  WA_IDOC_DATA-SDATA+270(1) = 'X'.
  WA_IDOC_DATA-SDATA+271(1) = 'X'.
  WA_IDOC_DATA-SDATA+272(1) = 'X'.
  WA_IDOC_DATA-SDATA+273(1) = 'X'.
  WA_IDOC_DATA-SDATA+274(1) = 'X'.
  WA_IDOC_DATA-SDATA+275(1) = 'X'.
  WA_IDOC_DATA-SDATA+276(1) = 'X'.
  WA_IDOC_DATA-SDATA+277(1) = 'X'.
  WA_IDOC_DATA-SDATA+278(1) = 'X'.
  WA_IDOC_DATA-SDATA+279(1) = 'X'.
  WA_IDOC_DATA-SDATA+280(1) = 'X'.
  WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-VARIANT_LONG."
  WA_IDOC_DATA-SDATA+321(1) = 'X'.
  WA_IDOC_DATA-SDATA+322(1) = 'X'.
  WA_IDOC_DATA-SDATA+323(1) = 'X'.
  WA_IDOC_DATA-SDATA+324(1) = 'X'.
  WA_IDOC_DATA-SDATA+325(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000014'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+30(1)    = <FS_FLATFILE>-MODEL_SP."'2'.
*  WA_IDOC_DATA-SDATA+33(1)    = <FS_FLATFILE>-INITIALIZE."'X'.
*  WA_IDOC_DATA-SDATA+55(7)    = <FS_FLATFILE>-TRACKLIMIT."'4.000'.
*  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-HIST_VALS."'60'.
*  WA_IDOC_DATA-SDATA+86(4)    = <FS_FLATFILE>-FORE_PDS."'12'.
  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000014'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-VARIANT_LONG."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000015'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000015'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-VARIANT_LONG."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000016'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000016'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.

  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.

  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000017'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000017'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000018'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000018'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.

  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.

  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000019'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000019'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  """"""""""""""""""" E1BPE1MPGDRTX """""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000020'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MPGDRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(40) = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000020'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MPGDRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(40) = <FS_FLATFILE>-VARIANT_LONG.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000021'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MPGDRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(40) = <FS_FLATFILE>-VARIANT_LONG.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000022'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(4)    = 'FG01'."<FS_FLATFILE>-STGE_LOC."'FG01'.
  WA_IDOC_DATA-SDATA+158(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  """""""""""""""""""" E1BPE1MARDRTX  """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000024'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARDRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(4) = 'FG01'."<FS_FLATFILE>-STGE_LOC."'FG01'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+118(40) = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000026'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
    EXPORTING
      INPUT  = <FS_FLATFILE>-AUOM
*     LANGUAGE = SY-LANGU
    IMPORTING
      OUTPUT = <FS_FLATFILE>-AUOM.

  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."EA
  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."EA
***  WA_IDOC_DATA-SDATA+27(6)     = <FS_FLATFILE>-DENOMINATR.
***  WA_IDOC_DATA-SDATA+33(6)     = <FS_FLATFILE>-NUMERATOR.
  WA_IDOC_DATA-SDATA+39(18)    = <FS_FLATFILE>-EAN_UPC.
  WA_IDOC_DATA-SDATA+57(2)     = <FS_FLATFILE>-CATEGORY.
****  WA_IDOC_DATA-SDATA+59(15)     = <FS_FLATFILE>-LENGTH.
****  WA_IDOC_DATA-SDATA+74(15)     = <FS_FLATFILE>-WIDTH.
****  WA_IDOC_DATA-SDATA+89(15)     = <FS_FLATFILE>-HEIGHT.
****  WA_IDOC_DATA-SDATA+104(3)     = <FS_FLATFILE>-UNITDIM.
****  WA_IDOC_DATA-SDATA+110(15)     = <FS_FLATFILE>-VOLUME.
***  IF <FS_FLATFILE>-VOLUMEUNIT IS NOT INITIAL.
***    CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
***      EXPORTING
***        INPUT  = <FS_FLATFILE>-VOLUMEUNIT
****       LANGUAGE = SY-LANGU
***      IMPORTING
***        OUTPUT = <FS_FLATFILE>-VOLUMEUNIT.
***    WA_IDOC_DATA-SDATA+125(3)     = <FS_FLATFILE>-VOLUMEUNIT.
***  ENDIF.
  WA_IDOC_DATA-SDATA+131(15)     = <FS_FLATFILE>-GROSSWT.
  WA_IDOC_DATA-SDATA+146(3)    = <FS_FLATFILE>-WT.
*  WA_IDOC_DATA-SDATA+149(3)    = 'KGM'.
  WA_IDOC_DATA-SDATA+152(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+155(3)    = <FS_FLATFILE>-AUOM."WT."'EA'.
*  WA_IDOC_DATA-SDATA+158(3)    = <FS_FLATFILE>-LUN."EA
*  WA_IDOC_DATA-SDATA+161(3)    = <FS_FLATFILE>-LUN."EA
  WA_IDOC_DATA-SDATA+271(40)   = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000026'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
    EXPORTING
      INPUT  = <FS_FLATFILE>-AUOM
*     LANGUAGE = SY-LANGU
    IMPORTING
      OUTPUT = <FS_FLATFILE>-AUOM.

  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."EA
  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."EA
**  WA_IDOC_DATA-SDATA+27(6)     = <FS_FLATFILE>-DENOMINATR.
**  WA_IDOC_DATA-SDATA+33(6)     = <FS_FLATFILE>-NUMERATOR.
  WA_IDOC_DATA-SDATA+39(18)    = <FS_FLATFILE>-EAN_UPC.
  WA_IDOC_DATA-SDATA+57(2)     = <FS_FLATFILE>-CATEGORY.
**  WA_IDOC_DATA-SDATA+59(15)     = <FS_FLATFILE>-LENGTH.
**  WA_IDOC_DATA-SDATA+74(15)     = <FS_FLATFILE>-WIDTH.
**  WA_IDOC_DATA-SDATA+89(15)     = <FS_FLATFILE>-HEIGHT.
**  WA_IDOC_DATA-SDATA+104(3)     = <FS_FLATFILE>-UNITDIM.
**  WA_IDOC_DATA-SDATA+110(15)     = <FS_FLATFILE>-VOLUME.
**  IF <FS_FLATFILE>-VOLUMEUNIT IS NOT INITIAL.
**    CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
**      EXPORTING
**        INPUT  = <FS_FLATFILE>-VOLUMEUNIT
***       LANGUAGE = SY-LANGU
**      IMPORTING
**        OUTPUT = <FS_FLATFILE>-VOLUMEUNIT.
**    WA_IDOC_DATA-SDATA+125(3)     = <FS_FLATFILE>-VOLUMEUNIT.
**  ENDIF.
  WA_IDOC_DATA-SDATA+131(15)     = <FS_FLATFILE>-GROSSWT.
  WA_IDOC_DATA-SDATA+146(3)    = <FS_FLATFILE>-WT.
*  WA_IDOC_DATA-SDATA+149(3)    = 'KGM'.
  WA_IDOC_DATA-SDATA+152(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+155(3)    = <FS_FLATFILE>-AUOM."WT."'EA'.
**  WA_IDOC_DATA-SDATA+158(3)    = <FS_FLATFILE>-LUN."EA
**  WA_IDOC_DATA-SDATA+161(3)    = <FS_FLATFILE>-LUN."EA
  WA_IDOC_DATA-SDATA+271(40)   = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000027'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+126(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(1)    = 'X'.
  WA_IDOC_DATA-SDATA+128(1)    = 'X'.
  WA_IDOC_DATA-SDATA+129(1)    = 'X'.
  WA_IDOC_DATA-SDATA+130(40)   = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000027'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*****  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+126(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(1)    = 'X'.
  WA_IDOC_DATA-SDATA+128(1)    = 'X'.
  WA_IDOC_DATA-SDATA+129(1)    = 'X'.
  WA_IDOC_DATA-SDATA+130(40)   = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000028'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MLANRT'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(3) = 'IN'.
  WA_IDOC_DATA-SDATA+24(2) = 'IN'.
  WA_IDOC_DATA-SDATA+26(4) = 'JOCG'.
  WA_IDOC_DATA-SDATA+30(1) = '0'.
  WA_IDOC_DATA-SDATA+31(4) = 'JOSG'.
  WA_IDOC_DATA-SDATA+35(1) = '0'.
  WA_IDOC_DATA-SDATA+36(4) = 'JOIG'.
  WA_IDOC_DATA-SDATA+40(1) = '0'.
  WA_IDOC_DATA-SDATA+154(40) = <FS_FLATFILE>-MATERIAL..
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000028'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MLANRT'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(3) = 'IN'.
  WA_IDOC_DATA-SDATA+24(2) = 'IN'.
  WA_IDOC_DATA-SDATA+26(4) = 'JOCG'.
  WA_IDOC_DATA-SDATA+30(1) = '0'.
  WA_IDOC_DATA-SDATA+31(4) = 'JOSG'.
  WA_IDOC_DATA-SDATA+35(1) = '0'.
  WA_IDOC_DATA-SDATA+36(4) = 'JOIG'.
  WA_IDOC_DATA-SDATA+40(1) = '0'.
  WA_IDOC_DATA-SDATA+154(40) = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000029'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+36(1)    = 'V'.
  WA_IDOC_DATA-SDATA+37(25)   = <FS_FLATFILE>-MOVING_PR.
  WA_IDOC_DATA-SDATA+93(4)    = VAL_CLASS."'3100'.
  WA_IDOC_DATA-SDATA+219(1)   = <FS_FLATFILE>-VAL_CAT.
  WA_IDOC_DATA-SDATA+660(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000029'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+36(1)    = 'V'."<FS_FLATFILE>-PRICE_CTRL."'V'.
  WA_IDOC_DATA-SDATA+37(25)   = <FS_FLATFILE>-MOVING_PR."'100.0000'.
  WA_IDOC_DATA-SDATA+93(4)    = VAL_CLASS."'3100'.
*  WA_IDOC_DATA-SDATA+219(1)   = <FS_FLATFILE>-VAL_CAT. " Suri : 20.09.2019 :  00:20:00
  WA_IDOC_DATA-SDATA+660(40)  = <FS_FLATFILE>-VARIANT_LONG."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*** """"""""""""""""""""" E1BPE1MBEWRTX  """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000031'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFDC'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000031'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFDC'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
*  WA_IDOC_DATA-SDATA+219(1) = 'X'.  " Suri : 20.09.2019 :  00:20:00
  WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*** Start of Changes By Suri : 30.08.2019
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000029'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+37(25)   = <FS_FLATFILE>-MOVING_PR.
  WA_IDOC_DATA-SDATA+93(4)    = VAL_CLASS."'3100'.
  WA_IDOC_DATA-SDATA+219(1)   = <FS_FLATFILE>-VAL_CAT.
  WA_IDOC_DATA-SDATA+660(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000031'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-SDATA+219(1)   = <FS_FLATFILE>-VAL_CAT.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000029'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+36(1)     = 'V'.
  WA_IDOC_DATA-SDATA+37(25)    = <FS_FLATFILE>-MOVING_PR."'100.0000'.
  WA_IDOC_DATA-SDATA+93(4)     = VAL_CLASS.
  WA_IDOC_DATA-SDATA+219(1)    = <FS_FLATFILE>-VAL_CAT.
  WA_IDOC_DATA-SDATA+660(40)   = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000031'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE>-VARIANT_LONG.
  WA_IDOC_DATA-SDATA+219(1)   = <FS_FLATFILE>-VAL_CAT.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
*** End of Changes By Suri : 30.08.2019

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000033'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MVKERT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = SALES_ORG."'1000'.
  WA_IDOC_DATA-SDATA+25(2)     = DISTR_CHAN."'10'.
  WA_IDOC_DATA-SDATA+33(1)     = <FS_FLATFILE>-CASH_DISC."'X'.
*  WA_IDOC_DATA-SDATA+110(1)     = <FS_FLATFILE>-SALES_UNIT."'X'.
  WA_IDOC_DATA-SDATA+116(4)     = ITEM_CAT1."'NORM'.
  WA_IDOC_DATA-SDATA+162(2)     = <FS_FLATFILE>-ACCT_ASSGT."'01'.
*  WA_IDOC_DATA-SDATA+179(2)     = <FS_FLATFILE>-ASSORT_LEV."'01'.
  WA_IDOC_DATA-SDATA+182(2)     =  LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'02'.
  WA_IDOC_DATA-SDATA+184(2)     =  LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'02'.
  WA_IDOC_DATA-SDATA+186(1)     = 'X'."<FS_FLATFILE>-ASSORT_LEV."ASSORTLIST."'X'.
*  if v_maw1 IS INITIAL.
  WA_IDOC_DATA-SDATA+197(8)     = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
  WA_IDOC_DATA-SDATA+205(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+213(8)     = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
  WA_IDOC_DATA-SDATA+221(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+229(8)     = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
  WA_IDOC_DATA-SDATA+237(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+245(8)     = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
  WA_IDOC_DATA-SDATA+253(8)     = '99991231'.
**    ELSE.
**  WA_IDOC_DATA-SDATA+59(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+75(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+91(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+107(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
**  ENDIF.
  WA_IDOC_DATA-SDATA+453(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000033'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MVKERT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = SALES_ORG."'1000'.
  WA_IDOC_DATA-SDATA+25(2)     = DISTR_CHAN."'10'.
  WA_IDOC_DATA-SDATA+33(1)     = <FS_FLATFILE>-CASH_DISC."'X'.
*  WA_IDOC_DATA-SDATA+110(1)     = <FS_FLATFILE>-SALES_UNIT."'X'.
  WA_IDOC_DATA-SDATA+116(4)     = ITEM_CAT1."'NORM'.
  WA_IDOC_DATA-SDATA+162(2)     = <FS_FLATFILE>-ACCT_ASSGT."'01'.
*  WA_IDOC_DATA-SDATA+179(2)     = <FS_FLATFILE>-ASSORT_LEV."'01'.
  WA_IDOC_DATA-SDATA+182(2)     =  LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'02'.
  WA_IDOC_DATA-SDATA+184(2)     =  LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'02'.
  WA_IDOC_DATA-SDATA+186(1)     = 'X'."<FS_FLATFILE>-ASSORT_LEV."ASSORTLIST."'X'.
**  if v_maw1 IS INITIAL.
  WA_IDOC_DATA-SDATA+197(8)     = SY-DATUM."<FS_FLATFILE>-LIST_ST_FR.
  WA_IDOC_DATA-SDATA+205(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+213(8)     = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
  WA_IDOC_DATA-SDATA+221(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+229(8)     = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
  WA_IDOC_DATA-SDATA+237(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+245(8)     = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
  WA_IDOC_DATA-SDATA+253(8)     = '99991231'.
**      ELSE.
**  WA_IDOC_DATA-SDATA+59(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+75(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+91(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+107(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
**  ENDIF.
  WA_IDOC_DATA-SDATA+453(40)    = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*  """"""""""""""""""""" E1BPE1MVKERTX  """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000034'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MVKERTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = SALES_ORG.
  WA_IDOC_DATA-SDATA+25(2) = DISTR_CHAN.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(40) = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-SDATA+208(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000034'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MVKERTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = SALES_ORG.
  WA_IDOC_DATA-SDATA+25(2) = DISTR_CHAN.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(40) = <FS_FLATFILE>-VARIANT_LONG.
  WA_IDOC_DATA-SDATA+208(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*
*  """"""""""""""""""""" E1BPE1WLK2RT """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000035'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RT'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)  = SALES_ORG."1000
  WA_IDOC_DATA-SDATA+25(2)  = DISTR_CHAN.""10
  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000035'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RT'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)  = SALES_ORG."1000
  WA_IDOC_DATA-SDATA+25(2)  = DISTR_CHAN.""10
  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
*  """"""""""""""""""""" E1BPE1WLK2RTX """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000036'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)  = SALES_ORG."1000
  WA_IDOC_DATA-SDATA+25(2)  = DISTR_CHAN."10
  WA_IDOC_DATA-SDATA+31(1)  = 'X'.
  WA_IDOC_DATA-SDATA+32(1)  = 'X'.
  WA_IDOC_DATA-SDATA+35(1)  = 'X'.
  WA_IDOC_DATA-SDATA+36(1)  = 'X'.
  WA_IDOC_DATA-SDATA+37(1)  = 'X'.
  WA_IDOC_DATA-SDATA+38(1)  = 'X'.
  WA_IDOC_DATA-SDATA+121(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000036'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)  = SALES_ORG."1000
  WA_IDOC_DATA-SDATA+25(2)  = DISTR_CHAN."10
  WA_IDOC_DATA-SDATA+31(1)  = 'X'.
  WA_IDOC_DATA-SDATA+32(1)  = 'X'.
  WA_IDOC_DATA-SDATA+35(1)  = 'X'.
  WA_IDOC_DATA-SDATA+36(1)  = 'X'.
  WA_IDOC_DATA-SDATA+37(1)  = 'X'.
  WA_IDOC_DATA-SDATA+38(1)  = 'X'.
  WA_IDOC_DATA-SDATA+121(40)  = <FS_FLATFILE>-VARIANT_LONG.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  CLEAR T2.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form PLANT_SPECIFIC
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM PLANT_SPECIFIC .
************Data Records*************************
************Hedare data**************************
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = '000001'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MATHEAD'.
*  WA_IDOC_DATA-SDATA+21(4)    = <FS_FLATFILE>-MATL_TYPE."'HAWA'.""MATL_TYPE"
*  WA_IDOC_DATA-SDATA+25(9)    = <FS_FLATFILE>-MATL_GROUP."'MC10009'."
*  WA_IDOC_DATA-SDATA+34(2)    = <FS_FLATFILE>-MATL_CAT."'00'."
*  WA_IDOC_DATA-SDATA+36(18)   = <FS_FLATFILE>-CHAR_PROF."'
*  WA_IDOC_DATA-SDATA+72(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+73(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+75(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+76(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+77(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+246(40)  =  <FS_FLATFILE>-MATERIAL."'SST123T10'."""Material
*  WA_IDOC_DATA-SDATA+326(18)  =  <FS_FLATFILE>-CHAR_PROF."CONFIG_CLASS_NAME
*  WA_IDOC_DATA-SDATA+344(3)   =  <FS_FLATFILE>-CONFIG_CLASS_TYPE."'300'."CONFIG_CLASS_TYPE
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  DATA:T  TYPE SY-TABIX.
*  DATA:T2 TYPE SY-TABIX.
*  CLEAR T.
*  T = '000002'.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT          = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM         = T.
*      WA_IDOC_DATA-SEGNAM         = 'E1BPE1VARKEY'.
*      WA_IDOC_DATA-SDATA+0(3)     = '005'.
*      WA_IDOC_DATA-SDATA+203(40)  = <FS_FLATFILE1>-MATERIAL.
*      WA_IDOC_DATA-SDATA+243(40)  = <FS_FLATFILE1>-VARIANT_LONG. "'L123001'.
*      T = T + 1.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*    ENDIF.
*  ENDLOOP.
*
*  SORT IT_IDOC_DATA DESCENDING.
*  READ TABLE IT_IDOC_DATA INTO WA_IDOC_DATA INDEX 1.
*  T2 = WA_IDOC_DATA-SEGNUM + 1.
**  CLEAR WA_IDOC_DATA.
**  DELETE ADJACENT DUPLICATES FROM TA_FLATFILE2 COMPARING CHAR_VAL_CHAR1.
**  SORT TA_FLATFILE3 BY CHAR_VALUE_LONG1 ASCENDING.
**  DELETE ADJACENT DUPLICATES FROM TA_FLATFILE3   COMPARING CHAR_VALUE_LONG1.
*  SORT IT_IDOC_DATA ASCENDING.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      """"""""""""Color****************************************
**      READ TABLE TA_FLATFILE3 ASSIGNING <FS_FLATFILE3> INDEX SY-TABIX.
*      WA_IDOC_DATA-MANDT           = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM          = T2 .                   "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME."'COLOR'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VAL_CHAR."'COLOR'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-MATERIAL."'L124'."
*      WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."'BLACK'." CHAR_VALUE_LONG
*      WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VAL_CHAR.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*
*      "******************SIZE****************************
*      WA_IDOC_DATA-MANDT           = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'COLOR'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-MATERIAL."'L124'."
*      WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'L'." CHAR_VALUE_LONG
*      WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'L'."CHAR_VAL_char
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*
*      IF <FS_FLATFILE1>-CHAR_NAME2 IS NOT INITIAL AND <FS_FLATFILE1>-CHAR_VALUE_LONG2 IS NOT INITIAL.
*        "******************nseam****************************
*        WA_IDOC_DATA-MANDT           = SY-MANDT.
*        WA_IDOC_DATA-SEGNUM          = T2.                  "'000003'.
*        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
*        WA_IDOC_DATA-SDATA+0(3)      = '005'.
*        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME2."'SIZE'."CHAR_NAME
*        WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG2."CHAR_VAL_CHAR2."'COLOR'."CHAR_NAME
*        WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-MATERIAL."'L124'."
*        WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG2."CHAR_VAL_CHAR2."'L'." CHAR_VALUE_LONG
*        WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG2."CHAR_VAL_CHAR2."'L'."CHAR_VAL_char
*        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*        CLEAR WA_IDOC_DATA.
*        T2 = T2 + 1.
*      ENDIF.
*    ENDIF.
*  ENDLOOP.
*
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      """""""""""" E1BPE1AUSPRT Color****************************************
*      WA_IDOC_DATA-MANDT           = SY-MANDT.  ""'
*      WA_IDOC_DATA-SEGNUM          = T2 .                   "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME."'COLOR'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VAL_CHAR."'COLOR'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-VARIANT_LONG."'L123001'."
*      WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VALUE_LONG.
*      WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG."CHAR_VALUE_LONG."'BLACK'."CHAR_VAL_char
*****      WA_IDOC_DATA-SDATA+403(1)    = '1'."CHAR_VAL_DEPENDENCY
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
******************* E1BPE1AUSPRT SIZE****************************
*      T2 = T2 + 1.
*      WA_IDOC_DATA-MANDT           = SY-MANDT. "
*      WA_IDOC_DATA-SEGNUM          =  T2.                   "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG1.
*      WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-VARIANT_LONG."'L123001'."
*      WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'L'." CHAR_VALUE_LONG
*      WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG1."CHAR_VAL_CHAR1."'L'."CHAR_VAL_char
******      WA_IDOC_DATA-SDATA+403(1)    = '1'."CHAR_VAL_DEPENDENCY
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
***********Inseam"""""""""""""""""""
*      IF <FS_FLATFILE1>-CHAR_NAME2 IS NOT INITIAL AND <FS_FLATFILE1>-CHAR_VALUE_LONG2 IS NOT INITIAL.
*        T2 = T2 + 1.
*        WA_IDOC_DATA-MANDT           = SY-MANDT. "
*        WA_IDOC_DATA-SEGNUM          =  T2.                 "'000003'.
*        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRT'.
*        WA_IDOC_DATA-SDATA+0(3)      = '005'.
*        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME2."'SIZE'."CHAR_NAME
*        WA_IDOC_DATA-SDATA+51(30)    = <FS_FLATFILE1>-CHAR_VALUE_LONG2.
*        WA_IDOC_DATA-SDATA+163(40)   = <FS_FLATFILE1>-VARIANT_LONG."'L123001'."
*        WA_IDOC_DATA-SDATA+203(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG2."CHAR_VAL_CHAR2."'L'." CHAR_VALUE_LONG
*        WA_IDOC_DATA-SDATA+273(70)   = <FS_FLATFILE1>-CHAR_VALUE_LONG2."CHAR_VAL_CHAR2."'L'."CHAR_VAL_char
*        WA_IDOC_DATA-SDATA+403(1)    = '1'."CHAR_VAL_DEPENDENCY
*        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*        CLEAR WA_IDOC_DATA.
*        T2 = T2 + 1.
*      ENDIF.
*    ENDIF.
*  ENDLOOP.
*
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT           = SY-MANDT. "           """"use for material 2 times and net further for same
*      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME."'COLOR'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-MATERIAL. "'L123001'.
*      WA_IDOC_DATA-SDATA+174(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+175(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+176(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+177(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+178(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+179(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+180(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+181(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+182(1)    = 'X'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*
**************E1BPE1AUSPRTX SIZE************************
*      T2 = T2 + 1.
*      WA_IDOC_DATA-MANDT           = SY-MANDT. "
*      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-MATERIAL. "'L123001'.
*      WA_IDOC_DATA-SDATA+174(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+175(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+176(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+177(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+178(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+179(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+180(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+181(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+182(1)    = 'X'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      """"""""""""""""Inseam
*      T2 = T2 + 1.
*      IF <FS_FLATFILE1>-CHAR_NAME2 IS NOT INITIAL AND <FS_FLATFILE1>-CHAR_VALUE_LONG2 IS NOT INITIAL.
*        WA_IDOC_DATA-MANDT           = SY-MANDT. "
*        WA_IDOC_DATA-SEGNUM          = T2.                  "'000003'.
*        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
*        WA_IDOC_DATA-SDATA+0(3)      = '005'.
*        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME2."'SIZE'."CHAR_NAME
*        WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-MATERIAL. "'L123001'.
*        WA_IDOC_DATA-SDATA+174(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+175(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+176(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+177(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+178(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+179(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+180(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+181(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+182(1)    = 'X'.
*        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*        CLEAR WA_IDOC_DATA.
*        T2 = T2 + 1.
*      ENDIF.
*    ENDIF.
*  ENDLOOP.
*
*
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
**************E1BPE1AUSPRTX color************************
*      WA_IDOC_DATA-MANDT           = SY-MANDT. "           """"use for material 2 times and net further for same
*      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME."'COLOR'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-VARIANT_LONG. "'L123001'.
*      WA_IDOC_DATA-SDATA+174(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+175(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+176(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+177(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+178(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+179(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+180(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+181(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+182(1)    = 'X'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*
**************E1BPE1AUSPRTX SIZE************************
*      T2 = T2 + 1.
*      WA_IDOC_DATA-MANDT           = SY-MANDT. "
*      WA_IDOC_DATA-SEGNUM          = T2.                    "'000003'.
*      WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME1."'SIZE'."CHAR_NAME
*      WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-VARIANT_LONG. "'L123001'.
*      WA_IDOC_DATA-SDATA+174(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+175(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+176(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+177(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+178(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+179(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+180(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+181(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+182(1)    = 'X'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*
*      T2 = T2 + 1.
*      IF <FS_FLATFILE1>-CHAR_NAME2 IS NOT INITIAL AND <FS_FLATFILE1>-CHAR_VALUE_LONG2 IS NOT INITIAL.
*        """""""""""""inseam
*        WA_IDOC_DATA-MANDT           = SY-MANDT. "
*        WA_IDOC_DATA-SEGNUM          = T2.                  "'000003'.
*        WA_IDOC_DATA-SEGNAM          = 'E1BPE1AUSPRTX'.
*        WA_IDOC_DATA-SDATA+0(3)      = '005'.
*        WA_IDOC_DATA-SDATA+21(30)    = <FS_FLATFILE1>-CHAR_NAME2."'SIZE'."CHAR_NAME
*        WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+134(40)    = <FS_FLATFILE1>-VARIANT_LONG. "'L123001'.
*        WA_IDOC_DATA-SDATA+174(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+175(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+176(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+177(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+178(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+179(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+180(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+181(1)    = 'X'.
*        WA_IDOC_DATA-SDATA+182(1)    = 'X'.
*        APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*        CLEAR WA_IDOC_DATA.
*        T2 = T2 + 1.
*      ENDIF.
*    ENDIF.
*  ENDLOOP.
****  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
****    IF <FS_FLATFILE1> IS ASSIGNED.
*  READ TABLE TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WITH KEY MATERIAL = <FS_FLATFILE>-MATERIAL.
*  WA_IDOC_DATA-MANDT           = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM          = T2.                        "'000002'.
*  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARART'.
*  WA_IDOC_DATA-SDATA+0(3)      = '005'.
*  WA_IDOC_DATA-SDATA+80(3)     = <FS_FLATFILE>-BASE_UOM."'EA'.'EA'."
*  WA_IDOC_DATA-SDATA+83(3)     = <FS_FLATFILE>-BASE_UOM.".
**  WA_IDOC_DATA-SDATA+249(4)    = <FS_FLATFILE>-TRANS_GRP.   ".'0001'.
*  WA_IDOC_DATA-SDATA+271(2)    = <FS_FLATFILE>-DIVISION.".'10'.
*  WA_IDOC_DATA-SDATA+380(1)    = <FS_FLATFILE>-BATCH_MGMT. "BATCH_MGMT
**  WA_IDOC_DATA-SDATA+395(4)    = <FS_FLATFILE>-MAT_GRP_SM.
*  WA_IDOC_DATA-SDATA+429(8)    = SY-DATUM.
*  WA_IDOC_DATA-SDATA+437(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+452(18)   = <FS_FLATFILE>-EXTMATLGRP.
*****  WA_IDOC_DATA-SDATA+510(8)    = <FS_FLATFILE>-PVALIDFROM.
*****  WA_IDOC_DATA-SDATA+518(8)    = <FS_FLATFILE>-SVALIDFROM.
*  WA_IDOC_DATA-SDATA+526(1)    = <FS_FLATFILE>-TAX_CLASS.".'0'.   ""TAX_CLASS
*  WA_IDOC_DATA-SDATA+569(1)    = <FS_FLATFILE>-PRPROFVAR.".'0'.   ""TAX_CLASS
*  WA_IDOC_DATA-SDATA+602(4)    = <FS_FLATFILE>-ITEM_CAT.". 'NORM'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
*
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000003'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARART1'.
**  WA_IDOC_DATA-SDATA+2(18)    = <FS_FLATFILE>-FREE_CHAR."'AKIL'."brand
*  WA_IDOC_DATA-SDATA+36(4)    = <FS_FLATFILE>-BRAND_ID."'AKIL'."brand
**  WA_IDOC_DATA-SDATA+40(3)    = <FS_FLATFILE>-FIBER_CODE_1.
**  WA_IDOC_DATA-SDATA+43(3)    = <FS_FLATFILE>-FIBER_PART_1.
**  WA_IDOC_DATA-SDATA+46(3)    = <FS_FLATFILE>-FIBER_CODE_2.
**  WA_IDOC_DATA-SDATA+49(3)    = <FS_FLATFILE>-FIBER_PART_2.
**  WA_IDOC_DATA-SDATA+52(3)    = <FS_FLATFILE>-FIBER_CODE_3.
**  WA_IDOC_DATA-SDATA+55(3)    = <FS_FLATFILE>-FIBER_PART_3.
**  WA_IDOC_DATA-SDATA+58(3)    = <FS_FLATFILE>-FIBER_CODE_4.
**  WA_IDOC_DATA-SDATA+61(3)    = <FS_FLATFILE>-FIBER_PART_4.
**  WA_IDOC_DATA-SDATA+64(3)    = <FS_FLATFILE>-FIBER_CODE_5.
**  WA_IDOC_DATA-SDATA+67(3)    = <FS_FLATFILE>-FIBER_PART_5.
**  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-FASHION_GRADE.
**  WA_IDOC_DATA-SDATA+431(1)   = <FS_FLATFILE>-ALLOW_PMAT_IGNO.
**  WA_IDOC_DATA-SDATA+433(4)   = <FS_FLATFILE>-SGT_CSGR.
**  WA_IDOC_DATA-SDATA+437(8)   = <FS_FLATFILE>-SGT_COVSA.
**  WA_IDOC_DATA-SDATA+446(10)  = <FS_FLATFILE>-FSH_MG_ATTRIBUTE1.
**  WA_IDOC_DATA-SDATA+456(10)  = <FS_FLATFILE>-FSH_MG_ATTRIBUTE2.
**  WA_IDOC_DATA-SDATA+466(10)  = <FS_FLATFILE>-FSH_MG_ATTRIBUTE3.
**  WA_IDOC_DATA-SDATA+473(1)   = 'X'.
**  WA_IDOC_DATA-SDATA+476(2)   = <FS_FLATFILE>-FSH_SC_MID.
*  WA_IDOC_DATA-SDATA+478(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
******  ENDIF.
******  ENDLOOP.
******
******  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
******    IF <FS_FLATFILE1> IS ASSIGNED.
*  WA_IDOC_DATA-MANDT           = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM          = T2.                        "'000002'.
*  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARART'.
*  WA_IDOC_DATA-SDATA+0(3)      = '005'.
*  WA_IDOC_DATA-SDATA+80(3)     = <FS_FLATFILE1>-BASE_UOM."'EA'.'EA'."
*  WA_IDOC_DATA-SDATA+83(3)     = <FS_FLATFILE1>-BASE_UOM.".
**  WA_IDOC_DATA-SDATA+249(4)    = <FS_FLATFILE1>-TRANS_GRP.  ".'0001'.
*  WA_IDOC_DATA-SDATA+271(2)    = <FS_FLATFILE1>-DIVISION.".'10'.
*  WA_IDOC_DATA-SDATA+380(1)    = <FS_FLATFILE1>-BATCH_MGMT. "BATCH_MGMT
**  WA_IDOC_DATA-SDATA+395(4)    = <FS_FLATFILE>-MAT_GRP_SM.
*  WA_IDOC_DATA-SDATA+429(8)    = SY-DATUM.
*  WA_IDOC_DATA-SDATA+437(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+452(18)   = <FS_FLATFILE>-EXTMATLGRP.
****      WA_IDOC_DATA-SDATA+510(8)    = <FS_FLATFILE>-PVALIDFROM.
****      WA_IDOC_DATA-SDATA+518(8)    = <FS_FLATFILE>-SVALIDFROM.
*  WA_IDOC_DATA-SDATA+526(1)    = <FS_FLATFILE1>-TAX_CLASS.".'0'.   ""TAX_CLASS
*  WA_IDOC_DATA-SDATA+569(1)    = <FS_FLATFILE>-PRPROFVAR.
*  WA_IDOC_DATA-SDATA+602(4)    = <FS_FLATFILE1>-ITEM_CAT.". 'NORM'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000003'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARART1'.
**  WA_IDOC_DATA-SDATA+2(18)    = <FS_FLATFILE>-FREE_CHAR.."'AKIL'."brand
*  WA_IDOC_DATA-SDATA+36(4)    = <FS_FLATFILE>-BRAND_ID."'AKIL'."brand
**  WA_IDOC_DATA-SDATA+40(3)    = <FS_FLATFILE>-FIBER_CODE_1.
**  WA_IDOC_DATA-SDATA+43(3)    = <FS_FLATFILE>-FIBER_PART_1.
**  WA_IDOC_DATA-SDATA+46(3)    = <FS_FLATFILE>-FIBER_CODE_2.
**  WA_IDOC_DATA-SDATA+49(3)    = <FS_FLATFILE>-FIBER_PART_2.
**  WA_IDOC_DATA-SDATA+52(3)    = <FS_FLATFILE>-FIBER_CODE_3.
**  WA_IDOC_DATA-SDATA+55(3)    = <FS_FLATFILE>-FIBER_PART_3.
**  WA_IDOC_DATA-SDATA+58(3)    = <FS_FLATFILE>-FIBER_CODE_4.
**  WA_IDOC_DATA-SDATA+61(3)    = <FS_FLATFILE>-FIBER_PART_4.
**  WA_IDOC_DATA-SDATA+64(3)    = <FS_FLATFILE>-FIBER_CODE_5.
**  WA_IDOC_DATA-SDATA+67(3)    = <FS_FLATFILE>-FIBER_PART_5.
**  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-FASHION_GRADE.
**  WA_IDOC_DATA-SDATA+431(1)    = <FS_FLATFILE>-ALLOW_PMAT_IGNO.
**  WA_IDOC_DATA-SDATA+433(4)    = <FS_FLATFILE>-SGT_CSGR.
**  WA_IDOC_DATA-SDATA+437(8)    = <FS_FLATFILE>-SGT_COVSA.
**  WA_IDOC_DATA-SDATA+446(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE1.
**  WA_IDOC_DATA-SDATA+456(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE2.
**  WA_IDOC_DATA-SDATA+466(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE3.
**  WA_IDOC_DATA-SDATA+473(1)   = 'X'.
**  WA_IDOC_DATA-SDATA+476(2)    = <FS_FLATFILE>-FSH_SC_MID.
**  WA_IDOC_DATA-SDATA+437(8)    = <FS_FLATFILE>-SGT_COVSA.
*  WA_IDOC_DATA-SDATA+478(40)  = <FS_FLATFILE1>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
****    endif.
****    endloop.
*
*
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARARTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+49(1)    = 'X'.""trans_grp
*  WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+70(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+81(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+82(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+86(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+93(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+99(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+112(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+207(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+209(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+210(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+211(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+212(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+213(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+214(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+215(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+216(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+217(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+218(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+219(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+220(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+221(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+255(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+257(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+258(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+259(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+260(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+261(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+262(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+264(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+267(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+268(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
*
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARARTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+49(1)    = 'X'.""trans_grp
*  WA_IDOC_DATA-SDATA+51(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+70(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+81(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+82(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+86(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+93(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+99(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+112(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+207(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+209(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+210(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+211(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+212(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+213(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+214(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+215(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+216(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+217(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+218(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+219(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+220(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+221(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+255(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+257(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+258(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+259(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+260(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+261(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+262(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+264(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+267(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+268(40)  = <FS_FLATFILE1>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
*
****  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
****    IF <FS_FLATFILE1> IS ASSIGNED.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000005'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
**  WA_IDOC_DATA-SDATA+40(3)    = <FS_FLATFILE>-COUNTRYORI."'0001'. "
*  WA_IDOC_DATA-SDATA+48(4)    = <FS_FLATFILE>-LOADINGGRP."'0001'. "
**  WA_IDOC_DATA-SDATA+52(2)    = <FS_FLATFILE>-ASSORT_LEV."'0001'. "
*  WA_IDOC_DATA-SDATA+55(2)    = '02'."<FS_FLATFILE>-LI_PROC_ST."'0001'. "
*  WA_IDOC_DATA-SDATA+57(2)    = '02'."<FS_FLATFILE>-LI_PROC_DC."'0001'. "
*  SELECT SINGLE LDVFL FROM MAW1 INTO @DATA(V_MAW1) WHERE MATNR = @<FS_FLATFILE>-MATERIAL.
*  IF SY-SUBRC IS NOT INITIAL.
*    WA_IDOC_DATA-SDATA+59(8)    = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
*    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+75(8)    = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
*    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+91(8)    = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
*    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+107(8)    = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
*    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
*  ELSE.
*    WA_IDOC_DATA-SDATA+59(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+75(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+91(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+107(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
*  ENDIF.
*  WA_IDOC_DATA-SDATA+123(4)   = <FS_FLATFILE>-VAL_CLASS.
*  WA_IDOC_DATA-SDATA+240(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
*****  ENDIF.
*****  ENDLOOP.
*****
*****  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*****    IF <FS_FLATFILE1> IS ASSIGNED.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000005'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
**  WA_IDOC_DATA-SDATA+40(3)    = <FS_FLATFILE>-COUNTRYORI.
*  WA_IDOC_DATA-SDATA+48(4)    = <FS_FLATFILE>-LOADINGGRP."'0001'. "
**  WA_IDOC_DATA-SDATA+52(2)    = <FS_FLATFILE>-ASSORT_LEV."'0001'. "
*  WA_IDOC_DATA-SDATA+55(2)    = '02'."<FS_FLATFILE>-LI_PROC_ST."'0001'. "
*  WA_IDOC_DATA-SDATA+57(2)    = '02'."<FS_FLATFILE>-LI_PROC_DC."'0001'. "
*  IF V_MAW1 IS INITIAL.
*    WA_IDOC_DATA-SDATA+59(8)     = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
*    WA_IDOC_DATA-SDATA+67(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+75(8)     = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
*    WA_IDOC_DATA-SDATA+83(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+91(8)     = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
*    WA_IDOC_DATA-SDATA+99(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+107(8)     = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
*    WA_IDOC_DATA-SDATA+115(8)     = '99991231'.
*  ELSE.
*    WA_IDOC_DATA-SDATA+59(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+75(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+91(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+107(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
*  ENDIF.
*  WA_IDOC_DATA-SDATA+123(4)   = <FS_FLATFILE>-VAL_CLASS."'3100'. "
*  WA_IDOC_DATA-SDATA+240(40)  = <FS_FLATFILE1>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
*****    ENDIF.
*****  ENDLOOP.
*****
*****  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*****    IF <FS_FLATFILE1> IS ASSIGNED.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000006'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+22(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+23(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+24(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*
*  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+45(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+46(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+47(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+48(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+49(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+50(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+132(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
*****  ENDIF.
*****  ENDLOOP.
*
*****  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*****    IF <FS_FLATFILE1> IS ASSIGNED.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000006'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+22(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+23(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+24(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+45(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+46(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+47(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+48(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+49(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+50(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+132(40)  = <FS_FLATFILE1>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
*******    ENDIF.
*******  ENDLOOP.
*
****  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
****    IF <FS_FLATFILE1> IS ASSIGNED.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000007'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAKTRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(1)    = 'E'.
*  WA_IDOC_DATA-SDATA+22(2)    = 'EN'.
*  WA_IDOC_DATA-SDATA+24(40)   = <FS_FLATFILE1>-MATL_DESC."
*  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE1>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  T2 = T2 + 1.
****  ENDIF.
****  ENDLOOP.
*
*
*  """""""""""""""""""""""""""""""Plant data""""""""""""""""""""""""""""""""""""""""""""""""""""
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT           = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM          = T2.                        "'000008'.
*  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARCRT'.
*  WA_IDOC_DATA-SDATA+0(3)      = '005'.
*  WA_IDOC_DATA-SDATA+21(4)     = 'RFDC'.
*
**  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
*  WA_IDOC_DATA-SDATA+41(2)     = 'RP'."<FS_FLATFILE>-MRP_TYPE."'RP'.
**  WA_IDOC_DATA-SDATA+43(3)     = <FS_FLATFILE>-MRP_CTRLER."'001'.
**  WA_IDOC_DATA-SDATA+46(4)     = <FS_FLATFILE>-PLND_DELRY."'1'.
**  WA_IDOC_DATA-SDATA+50(4)     = <FS_FLATFILE>-GR_PR_TIME."'0'.
**  WA_IDOC_DATA-SDATA+54(1)     = <FS_FLATFILE>-PERIOD_IND."'W'.
**  WA_IDOC_DATA-SDATA+62(2)     = <FS_FLATFILE>-LOT_SIZE."'EX'.
**  WA_IDOC_DATA-SDATA+64(1)     = <FS_FLATFILE>-PROC_TYPE."'F'.
**  WA_IDOC_DATA-SDATA+65(2)     = <FS_FLATFILE>-SPPROCTYPE."'F'.
**  WA_IDOC_DATA-SDATA+67(15)    = <FS_FLATFILE>-REORDER_PT."'5.000'.
**  WA_IDOC_DATA-SDATA+82(15)    = <FS_FLATFILE>-SAFETY_STK."'5.000'.
**  WA_IDOC_DATA-SDATA+157(15)   = <FS_FLATFILE>-MAX_STOCK."'5.000'.
**  WA_IDOC_DATA-SDATA+197(1)    = <FS_FLATFILE>-DEP_REQ_ID.
**  WA_IDOC_DATA-SDATA+229(3)    = <FS_FLATFILE>-SM_KEY.
**  WA_IDOC_DATA-SDATA+232(1)    = <FS_FLATFILE>-BACKFLUSH.
**  WA_IDOC_DATA-SDATA+233(4)   = <FS_FLATFILE>-INHSEPRODT.
*  WA_IDOC_DATA-SDATA+264(4)    = <FS_FLATFILE>-LOADINGGRP."'0001'.
*  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
*  WA_IDOC_DATA-SDATA+276(2)    = <FS_FLATFILE>-AVAILCHECK."'01'.
**  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
**  WA_IDOC_DATA-SDATA+366(4)    = <FS_FLATFILE>-ISS_ST_LOC."'0000010120'.
**  WA_IDOC_DATA-SDATA+370(4)    = <FS_FLATFILE>-MRP_GROUP."'0000010120'.
**  WA_IDOC_DATA-SDATA+403(4)    = <FS_FLATFILE>-SERNO_PROF."'Z001'.
**  WA_IDOC_DATA-SDATA+486(4)    = <FS_FLATFILE>-PLAN_STRGP."'Z001'.
**  WA_IDOC_DATA-SDATA+488(4)    = <FS_FLATFILE>-SLOC_EXPRC."'FG01'.
**  WA_IDOC_DATA-SDATA+511(1)    = <FS_FLATFILE>-BATCHENTRY.
*  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
**  WA_IDOC_DATA-SDATA+606(3)    = <FS_FLATFILE>-PRODUCTION_SCHEDULER."'HSN123'.
**  WA_IDOC_DATA-SDATA+609(6)    = <FS_FLATFILE>-PROD_PROF."'HSN123'.
**  WA_IDOC_DATA-SDATA+641(5)    = <FS_FLATFILE>-UNDER_TOL."'HSN123'.
**  WA_IDOC_DATA-SDATA+646(5)    =  <FS_FLATFILE>-OVER_TOL."'HSN123'.
**  WA_IDOC_DATA-SDATA+694(6)    =  <FS_FLATFILE>-VARIANCE_KEY."'HSN123'.
*  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
**  WA_IDOC_DATA-SDATA+731(15)   = <FS_FLATFILE>-MIN_SAFETY_STK."'1.000'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000009'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
*  WA_IDOC_DATA-SDATA+54(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
**  WA_IDOC_DATA-SDATA+11(4)   = <FS_FLATFILE>-GI_PR_TIME."
*  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-MATERIAL."
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT          = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM         = T2.                     "'000008'.
*      WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT'.
*      WA_IDOC_DATA-SDATA+0(3)      = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)     = 'RFDC'.
*      ENDIF.
**  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
*      WA_IDOC_DATA-SDATA+41(2)     = 'RP'."<FS_FLATFILE>-MRP_TYPE."'RP'.
**      WA_IDOC_DATA-SDATA+43(3)     = <FS_FLATFILE>-MRP_CTRLER."'001'.
**      WA_IDOC_DATA-SDATA+46(4)     = <FS_FLATFILE>-PLND_DELRY."'1'.
**      WA_IDOC_DATA-SDATA+50(4)     = <FS_FLATFILE>-GR_PR_TIME."'0'.
**      WA_IDOC_DATA-SDATA+54(1)     = <FS_FLATFILE>-PERIOD_IND."'W'.
**      WA_IDOC_DATA-SDATA+62(2)     = <FS_FLATFILE>-LOT_SIZE."'EX'.
**      WA_IDOC_DATA-SDATA+64(1)     = <FS_FLATFILE>-PROC_TYPE."'F'.
**      WA_IDOC_DATA-SDATA+65(2)     = <FS_FLATFILE>-SPPROCTYPE."'F'.
**      WA_IDOC_DATA-SDATA+67(15)    = <FS_FLATFILE>-REORDER_PT."'5.000'.
**      WA_IDOC_DATA-SDATA+82(15)    = <FS_FLATFILE>-SAFETY_STK."'5.000'.
**      WA_IDOC_DATA-SDATA+157(15)   = <FS_FLATFILE>-MAX_STOCK."'5.000'.
**      WA_IDOC_DATA-SDATA+197(1)   = <FS_FLATFILE>-DEP_REQ_ID.
**      WA_IDOC_DATA-SDATA+229(3)   = <FS_FLATFILE>-SM_KEY.
**      WA_IDOC_DATA-SDATA+232(1)    = <FS_FLATFILE>-BACKFLUSH.
**      WA_IDOC_DATA-SDATA+233(4)    = <FS_FLATFILE>-INHSEPRODT.
*      WA_IDOC_DATA-SDATA+264(4)    = <FS_FLATFILE>-LOADINGGRP."'0001'.
*      WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
*      WA_IDOC_DATA-SDATA+276(2)    = <FS_FLATFILE>-AVAILCHECK."'01'.
**      WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
**      WA_IDOC_DATA-SDATA+366(4)    = <FS_FLATFILE>-ISS_ST_LOC."'0000010120'.
**      WA_IDOC_DATA-SDATA+370(4)    = <FS_FLATFILE>-MRP_GROUP."'0000010120'.
**      WA_IDOC_DATA-SDATA+403(4)    = <FS_FLATFILE>-SERNO_PROF."'Z001'.
**      WA_IDOC_DATA-SDATA+486(4)    = <FS_FLATFILE>-PLAN_STRGP."'Z001'.
**      WA_IDOC_DATA-SDATA+488(4)    = <FS_FLATFILE>-SLOC_EXPRC."'FG01'.
**      WA_IDOC_DATA-SDATA+511(1)    = <FS_FLATFILE>-BATCHENTRY.
*      WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
**      WA_IDOC_DATA-SDATA+606(3)    = <FS_FLATFILE>-PRODUCTION_SCHEDULER."'HSN123'.
**      WA_IDOC_DATA-SDATA+609(6)    = <FS_FLATFILE>-PROD_PROF."'HSN123'.
**      WA_IDOC_DATA-SDATA+641(5)    = <FS_FLATFILE>-UNDER_TOL."'HSN123'.
**      WA_IDOC_DATA-SDATA+646(5)    = <FS_FLATFILE>-OVER_TOL."'HSN123'.
**      WA_IDOC_DATA-SDATA+694(6)    =  <FS_FLATFILE>-VARIANCE_KEY."'HSN123'.
*      WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
**      WA_IDOC_DATA-SDATA+731(15)   = <FS_FLATFILE>-MIN_SAFETY_STK."'1.000'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*    ENDIF.
*  ENDLOOP.
*
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT          = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM         = T2.                     "'000009'.
*      WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
*      WA_IDOC_DATA-SDATA+54(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+55(16)   = 'A'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ENDIF.
*      WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE1>-VARIANT_LONG."
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*    ENDIF.
*  ENDLOOP.
*  WA_IDOC_DATA-MANDT           = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM          = T2.                        "'000010'.
*  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARCRT'.
*  WA_IDOC_DATA-SDATA+0(3)      = '005'.
*  WA_IDOC_DATA-SDATA+21(4)     = 'RFST'.
**  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
*  WA_IDOC_DATA-SDATA+41(2)     = 'ND'."<FS_FLATFILE>-MRP_TYPE."'RP'.
**  WA_IDOC_DATA-SDATA+43(3)     = <FS_FLATFILE>-MRP_CTRLER."'001'.
**  WA_IDOC_DATA-SDATA+46(4)     = <FS_FLATFILE>-PLND_DELRY."'1'.
**  WA_IDOC_DATA-SDATA+50(4)     = <FS_FLATFILE>-GR_PR_TIME."'0'.
**  WA_IDOC_DATA-SDATA+54(1)     = <FS_FLATFILE>-PERIOD_IND."'W'.
**  WA_IDOC_DATA-SDATA+62(2)     = <FS_FLATFILE>-LOT_SIZE."'EX'.
**  WA_IDOC_DATA-SDATA+64(1)     = <FS_FLATFILE>-PROC_TYPE."'F'.
**  WA_IDOC_DATA-SDATA+65(2)     = <FS_FLATFILE>-SPPROCTYPE."'F'.
**  WA_IDOC_DATA-SDATA+67(15)    = <FS_FLATFILE>-REORDER_PT."'5.000'.
**  WA_IDOC_DATA-SDATA+157(15)   = <FS_FLATFILE>-MAX_STOCK."'5.000'.
**  WA_IDOC_DATA-SDATA+197(1)   = <FS_FLATFILE>-DEP_REQ_ID.
**  WA_IDOC_DATA-SDATA+229(3)   = <FS_FLATFILE>-SM_KEY.
**  WA_IDOC_DATA-SDATA+232(1)    = <FS_FLATFILE>-BACKFLUSH.
**  WA_IDOC_DATA-SDATA+233(4)    = <FS_FLATFILE>-INHSEPRODT.
*  WA_IDOC_DATA-SDATA+264(4)    = <FS_FLATFILE>-LOADINGGRP."'0001'.
*  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
*  WA_IDOC_DATA-SDATA+276(2)    = <FS_FLATFILE>-AVAILCHECK."'01'.
**  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
*********  WA_IDOC_DATA-SDATA+366(4)    = <FS_FLATFILE>-ISS_ST_LOC."'0000010120'.
**  WA_IDOC_DATA-SDATA+370(4)    = <FS_FLATFILE>-MRP_GROUP."'0000010120'.
**  WA_IDOC_DATA-SDATA+403(4)    = <FS_FLATFILE>-SERNO_PROF."'Z001'.
**  WA_IDOC_DATA-SDATA+486(4)    = <FS_FLATFILE>-PLAN_STRGP."'Z001'.
****  WA_IDOC_DATA-SDATA+488(4)    = <FS_FLATFILE>-STGE_LOC."'FG01'.
**  WA_IDOC_DATA-SDATA+511(1)    = <FS_FLATFILE>-BATCHENTRY.
*  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
**  WA_IDOC_DATA-SDATA+606(3)    = <FS_FLATFILE>-PRODUCTION_SCHEDULER."'HSN123'.
**  WA_IDOC_DATA-SDATA+609(6)    = <FS_FLATFILE>-PROD_PROF."'HSN123'.
**  WA_IDOC_DATA-SDATA+641(5)    = <FS_FLATFILE>-UNDER_TOL."'HSN123'.
**  WA_IDOC_DATA-SDATA+646(5)    =  <FS_FLATFILE>-OVER_TOL."'HSN123'.
**  WA_IDOC_DATA-SDATA+694(6)    =  <FS_FLATFILE>-VARIANCE_KEY."'HSN123'.
*  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
**  WA_IDOC_DATA-SDATA+731(15)   = <FS_FLATFILE>-MIN_SAFETY_STK."'1.000'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000011'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
*  WA_IDOC_DATA-SDATA+54(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
*  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-MATERIAL."
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000010'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT'.
*  WA_IDOC_DATA-SDATA+0(3)      = '005'.
*  WA_IDOC_DATA-SDATA+21(4)     = 'RFST'.
**  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
*  WA_IDOC_DATA-SDATA+41(2)     = 'ND'."<FS_FLATFILE>-MRP_TYPE."'RP'.
**  WA_IDOC_DATA-SDATA+43(3)     = <FS_FLATFILE>-MRP_CTRLER."'001'.
**  WA_IDOC_DATA-SDATA+46(4)     = <FS_FLATFILE>-PLND_DELRY."'1'.
**  WA_IDOC_DATA-SDATA+50(4)     = <FS_FLATFILE>-GR_PR_TIME."'0'.
**  WA_IDOC_DATA-SDATA+54(1)     = <FS_FLATFILE>-PERIOD_IND."'W'.
  WA_IDOC_DATA-SDATA+62(2)     = 'EX'."<FS_FLATFILE>-LOT_SIZE."'EX'.
**  WA_IDOC_DATA-SDATA+64(1)     = <FS_FLATFILE>-PROC_TYPE."'F'.
**  WA_IDOC_DATA-SDATA+65(2)     = <FS_FLATFILE>-SPPROCTYPE."'F'.
**  WA_IDOC_DATA-SDATA+67(15)    = <FS_FLATFILE>-REORDER_PT."'5.000'.
**  WA_IDOC_DATA-SDATA+157(15)   = <FS_FLATFILE>-MAX_STOCK."'5.000'.
**  WA_IDOC_DATA-SDATA+197(1)    = <FS_FLATFILE>-DEP_REQ_ID.
**  WA_IDOC_DATA-SDATA+229(3)   = <FS_FLATFILE>-SM_KEY.
**  WA_IDOC_DATA-SDATA+232(1)    = <FS_FLATFILE>-BACKFLUSH.
**  WA_IDOC_DATA-SDATA+233(4)    = <FS_FLATFILE>-INHSEPRODT.
*  WA_IDOC_DATA-SDATA+264(4)    = <FS_FLATFILE>-LOADINGGRP."'0001'.
*  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
*  WA_IDOC_DATA-SDATA+276(2)    = <FS_FLATFILE>-AVAILCHECK."'01'.
**  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
******  WA_IDOC_DATA-SDATA+366(4)    = <FS_FLATFILE>-ISS_ST_LOC."'0000010120'.
**  WA_IDOC_DATA-SDATA+370(4)    = <FS_FLATFILE>-MRP_GROUP."'0000010120'.
**  WA_IDOC_DATA-SDATA+403(4)    = <FS_FLATFILE>-SERNO_PROF."'Z001'.
**  WA_IDOC_DATA-SDATA+486(4)    = <FS_FLATFILE>-PLAN_STRGP."'Z001'.
****  WA_IDOC_DATA-SDATA+488(4)    = <FS_FLATFILE>-STGE_LOC."'FG01'.
**  WA_IDOC_DATA-SDATA+511(1)    = <FS_FLATFILE>-BATCHENTRY.
*  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
**  WA_IDOC_DATA-SDATA+606(3)    = <FS_FLATFILE>-PRODUCTION_SCHEDULER."'HSN123'.
**  WA_IDOC_DATA-SDATA+609(6)    = <FS_FLATFILE>-PROD_PROF."'HSN123'.
**  WA_IDOC_DATA-SDATA+641(5)    = <FS_FLATFILE>-UNDER_TOL."'HSN123'.
**  WA_IDOC_DATA-SDATA+646(5)    =  <FS_FLATFILE>-OVER_TOL."'HSN123'.
**  WA_IDOC_DATA-SDATA+694(6)    =  <FS_FLATFILE>-VARIANCE_KEY."'HSN123'.
*  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
**  WA_IDOC_DATA-SDATA+731(15)   = <FS_FLATFILE>-MIN_SAFETY_STK."'1.000'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000011'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
*  WA_IDOC_DATA-SDATA+54(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
*  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-VARIANT_LONG."
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  """"""""""""E1BPE1MARCRTX"""""""""""
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000012'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARCRTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+25(1) = 'X'.
*  WA_IDOC_DATA-SDATA+26(1) = 'X'.
*  WA_IDOC_DATA-SDATA+27(1) = 'X'.
*  WA_IDOC_DATA-SDATA+28(1) = 'X'.
*  WA_IDOC_DATA-SDATA+29(1) = 'X'.
*  WA_IDOC_DATA-SDATA+30(1) = 'X'.
*  WA_IDOC_DATA-SDATA+31(1) = 'X'.
*  WA_IDOC_DATA-SDATA+32(1) = 'X'.
*  WA_IDOC_DATA-SDATA+33(1) = 'X'.
*  WA_IDOC_DATA-SDATA+34(1) = 'X'.
*  WA_IDOC_DATA-SDATA+35(1) = 'X'.
*  WA_IDOC_DATA-SDATA+36(1) = 'X'.
*  WA_IDOC_DATA-SDATA+37(1) = 'X'.
*  WA_IDOC_DATA-SDATA+38(1) = 'X'.
*  WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
*  WA_IDOC_DATA-SDATA+40(1) = 'X'.
*  WA_IDOC_DATA-SDATA+41(1) = 'X'.
*  WA_IDOC_DATA-SDATA+42(1) = 'X'.
*  WA_IDOC_DATA-SDATA+43(1) = 'X'.
*  WA_IDOC_DATA-SDATA+44(1) = 'X'.
*  WA_IDOC_DATA-SDATA+45(1) = 'X'.
*  WA_IDOC_DATA-SDATA+46(1) = 'X'.
*  WA_IDOC_DATA-SDATA+47(1) = 'X'.
*  WA_IDOC_DATA-SDATA+48(1) = 'X'.
*  WA_IDOC_DATA-SDATA+49(1) = 'X'.
*  WA_IDOC_DATA-SDATA+50(1) = 'X'.
*  WA_IDOC_DATA-SDATA+51(1) = 'X'.
*  WA_IDOC_DATA-SDATA+52(1) = 'X'.
*  WA_IDOC_DATA-SDATA+53(1) = 'X'.
*  WA_IDOC_DATA-SDATA+54(1) = 'X'.
*  WA_IDOC_DATA-SDATA+55(1) = 'X'.
*  WA_IDOC_DATA-SDATA+56(1) = 'X'.
*  WA_IDOC_DATA-SDATA+57(1) = 'X'.
*  WA_IDOC_DATA-SDATA+58(1) = 'X'.
*  WA_IDOC_DATA-SDATA+59(1) = 'X'.
*  WA_IDOC_DATA-SDATA+60(1) = 'X'.
*  WA_IDOC_DATA-SDATA+61(1) = 'X'.
*  WA_IDOC_DATA-SDATA+62(1) = 'X'.
*  WA_IDOC_DATA-SDATA+63(1) = 'X'.
*  WA_IDOC_DATA-SDATA+64(1) = 'X'.
*  WA_IDOC_DATA-SDATA+65(1) = 'X'.
*  WA_IDOC_DATA-SDATA+66(1) = 'X'.
*  WA_IDOC_DATA-SDATA+67(1) = 'X'.
*  WA_IDOC_DATA-SDATA+68(1) = 'X'.
*  WA_IDOC_DATA-SDATA+69(1) = 'X'.
*  WA_IDOC_DATA-SDATA+70(1) = 'X'.
*  WA_IDOC_DATA-SDATA+71(1) = 'X'.
*  WA_IDOC_DATA-SDATA+72(1) = 'X'.
*  WA_IDOC_DATA-SDATA+73(1) = 'X'.
*  WA_IDOC_DATA-SDATA+74(1) = 'X'.
*  WA_IDOC_DATA-SDATA+75(1) = 'X'.
*  WA_IDOC_DATA-SDATA+76(1) = 'X'.
*  WA_IDOC_DATA-SDATA+77(1) = 'X'.
*  WA_IDOC_DATA-SDATA+78(1) = 'X'.
*  WA_IDOC_DATA-SDATA+79(1) = 'X'.
*  WA_IDOC_DATA-SDATA+80(1) = 'X'.
*  WA_IDOC_DATA-SDATA+81(1) = 'X'.
*  WA_IDOC_DATA-SDATA+82(1) = 'X'.
*  WA_IDOC_DATA-SDATA+83(1) = 'X'.
*  WA_IDOC_DATA-SDATA+84(1) = 'X'.
*  WA_IDOC_DATA-SDATA+85(1) = 'X'.
*  WA_IDOC_DATA-SDATA+86(1) = 'X'.
*  WA_IDOC_DATA-SDATA+87(1) = 'X'.
*  WA_IDOC_DATA-SDATA+88(1) = 'X'.
*  WA_IDOC_DATA-SDATA+89(1) = 'X'.
*  WA_IDOC_DATA-SDATA+90(1) = 'X'.
*  WA_IDOC_DATA-SDATA+91(1) = 'X'.
*  WA_IDOC_DATA-SDATA+92(1) = 'X'.
*  WA_IDOC_DATA-SDATA+93(1) = 'X'.
*  WA_IDOC_DATA-SDATA+94(1) = 'X'.
*  WA_IDOC_DATA-SDATA+95(1) = 'X'.
*  WA_IDOC_DATA-SDATA+96(1) = 'X'.
*  WA_IDOC_DATA-SDATA+97(1) = 'X'.
*  WA_IDOC_DATA-SDATA+98(1) = 'X'.
*  WA_IDOC_DATA-SDATA+99(1) = 'X'.
*  WA_IDOC_DATA-SDATA+100(1) = 'X'.
*  WA_IDOC_DATA-SDATA+101(1) = 'X'.
*  WA_IDOC_DATA-SDATA+102(1) = 'X'.
*  WA_IDOC_DATA-SDATA+103(1) = 'X'.
*  WA_IDOC_DATA-SDATA+104(1) = 'X'.
*  WA_IDOC_DATA-SDATA+105(1) = 'X'.
*  WA_IDOC_DATA-SDATA+106(1) = 'X'.
*  WA_IDOC_DATA-SDATA+107(1) = 'X'.
*  WA_IDOC_DATA-SDATA+108(1) = 'X'.
*  WA_IDOC_DATA-SDATA+109(1) = 'X'.
*  WA_IDOC_DATA-SDATA+110(1) = 'X'.
*  WA_IDOC_DATA-SDATA+111(1) = 'X'.
*  WA_IDOC_DATA-SDATA+112(1) = 'X'.
*  WA_IDOC_DATA-SDATA+113(1) = 'X'.
*  WA_IDOC_DATA-SDATA+114(1) = 'X'.
*  WA_IDOC_DATA-SDATA+115(1) = 'X'.
*  WA_IDOC_DATA-SDATA+116(1) = 'X'.
*  WA_IDOC_DATA-SDATA+117(1) = 'X'.
*  WA_IDOC_DATA-SDATA+118(1) = 'X'.
*  WA_IDOC_DATA-SDATA+119(1) = 'X'.
*  WA_IDOC_DATA-SDATA+120(1) = 'X'.
*  WA_IDOC_DATA-SDATA+121(1) = 'X'.
*  WA_IDOC_DATA-SDATA+122(1) = 'X'.
*  WA_IDOC_DATA-SDATA+123(1) = 'X'.
*  WA_IDOC_DATA-SDATA+124(1) = 'X'.
*  WA_IDOC_DATA-SDATA+125(1) = 'X'.
*  WA_IDOC_DATA-SDATA+126(1) = 'X'.
*  WA_IDOC_DATA-SDATA+127(1) = 'X'.
*  WA_IDOC_DATA-SDATA+128(1) = 'X'.
*  WA_IDOC_DATA-SDATA+129(1) = 'X'.
*  WA_IDOC_DATA-SDATA+130(1) = 'X'.
*  WA_IDOC_DATA-SDATA+131(1) = 'X'.
*  WA_IDOC_DATA-SDATA+132(1) = 'X'.
*  WA_IDOC_DATA-SDATA+133(1) = 'X'.
*  WA_IDOC_DATA-SDATA+134(1) = 'X'.
*  WA_IDOC_DATA-SDATA+135(1) = 'X'.
*  WA_IDOC_DATA-SDATA+136(1) = 'X'.
*  WA_IDOC_DATA-SDATA+137(1) = 'X'.
*  WA_IDOC_DATA-SDATA+138(1) = 'X'.
*  WA_IDOC_DATA-SDATA+139(1) = 'X'.
*  WA_IDOC_DATA-SDATA+140(1) = 'X'.
*  WA_IDOC_DATA-SDATA+141(1) = 'X'.
*  WA_IDOC_DATA-SDATA+142(1) = 'X'.
*  WA_IDOC_DATA-SDATA+143(1) = 'X'.
*  WA_IDOC_DATA-SDATA+144(1) = 'X'.
*  WA_IDOC_DATA-SDATA+145(1) = 'X'.
*  WA_IDOC_DATA-SDATA+146(1) = 'X'.
*  WA_IDOC_DATA-SDATA+147(1) = 'X'.
*  WA_IDOC_DATA-SDATA+148(1) = 'X'.
*  WA_IDOC_DATA-SDATA+149(1) = 'X'.
*  WA_IDOC_DATA-SDATA+150(1) = 'X'.
*  WA_IDOC_DATA-SDATA+151(1) = 'X'.
*  WA_IDOC_DATA-SDATA+152(1) = 'X'.
*  WA_IDOC_DATA-SDATA+153(1) = 'X'.
*  WA_IDOC_DATA-SDATA+154(1) = 'X'.
*  WA_IDOC_DATA-SDATA+155(1) = 'X'.
*  WA_IDOC_DATA-SDATA+156(1) = 'X'.
*  WA_IDOC_DATA-SDATA+157(1) = 'X'.
*  WA_IDOC_DATA-SDATA+158(1) = 'X'.
*  WA_IDOC_DATA-SDATA+159(1) = 'X'.
*  WA_IDOC_DATA-SDATA+160(1) = 'X'.
*  WA_IDOC_DATA-SDATA+161(1) = 'X'.
*  WA_IDOC_DATA-SDATA+162(1) = 'X'.
*  WA_IDOC_DATA-SDATA+163(1) = 'X'.
*  WA_IDOC_DATA-SDATA+164(1) = 'X'.
*  WA_IDOC_DATA-SDATA+165(1) = 'X'.
*  WA_IDOC_DATA-SDATA+166(1) = 'X'.
*  WA_IDOC_DATA-SDATA+167(1) = 'X'.
*  WA_IDOC_DATA-SDATA+168(1) = 'X'.
*  WA_IDOC_DATA-SDATA+169(1) = 'X'.
*  WA_IDOC_DATA-SDATA+252(1) = 'X'.
*  WA_IDOC_DATA-SDATA+253(1) = 'X'.
*  WA_IDOC_DATA-SDATA+254(1) = 'X'.
*  WA_IDOC_DATA-SDATA+255(1) = 'X'.
*  WA_IDOC_DATA-SDATA+256(1) = 'X'.
*  WA_IDOC_DATA-SDATA+257(1) = 'X'.
**  WA_IDOC_DATA-SDATA+258(1) = 'X'.
*  WA_IDOC_DATA-SDATA+259(1) = 'X'.
*  WA_IDOC_DATA-SDATA+260(1) = 'X'.
*  WA_IDOC_DATA-SDATA+261(1) = 'X'.
*  WA_IDOC_DATA-SDATA+262(1) = 'X'.
*  WA_IDOC_DATA-SDATA+263(1) = 'X'.
*  WA_IDOC_DATA-SDATA+264(1) = 'X'.
*  WA_IDOC_DATA-SDATA+265(1) = 'X'.
*  WA_IDOC_DATA-SDATA+266(1) = 'X'.
*  WA_IDOC_DATA-SDATA+267(1) = 'X'.
*  WA_IDOC_DATA-SDATA+268(1) = 'X'.
*  WA_IDOC_DATA-SDATA+269(1) = 'X'.
*  WA_IDOC_DATA-SDATA+270(1) = 'X'.
*  WA_IDOC_DATA-SDATA+271(1) = 'X'.
*  WA_IDOC_DATA-SDATA+272(1) = 'X'.
*  WA_IDOC_DATA-SDATA+273(1) = 'X'.
*  WA_IDOC_DATA-SDATA+274(1) = 'X'.
*  WA_IDOC_DATA-SDATA+275(1) = 'X'.
*  WA_IDOC_DATA-SDATA+276(1) = 'X'.
*  WA_IDOC_DATA-SDATA+277(1) = 'X'.
*  WA_IDOC_DATA-SDATA+278(1) = 'X'.
*  WA_IDOC_DATA-SDATA+279(1) = 'X'.
*  WA_IDOC_DATA-SDATA+280(1) = 'X'.
*  WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-MATERIAL."
*  WA_IDOC_DATA-SDATA+321(1) = 'X'.
*  WA_IDOC_DATA-SDATA+322(1) = 'X'.
*  WA_IDOC_DATA-SDATA+323(1) = 'X'.
*  WA_IDOC_DATA-SDATA+324(1) = 'X'.
*  WA_IDOC_DATA-SDATA+325(1) = 'X'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
**  """"""""""""E1BPE1MARCRTX"""""""""""
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT       = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM      = T2.                        "'000012'.
*      WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARCRTX'.
*      WA_IDOC_DATA-SDATA+0(3)  = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*      ENDIF.
*      WA_IDOC_DATA-SDATA+25(1) = 'X'.
*      WA_IDOC_DATA-SDATA+26(1) = 'X'.
*      WA_IDOC_DATA-SDATA+27(1) = 'X'.
*      WA_IDOC_DATA-SDATA+28(1) = 'X'.
*      WA_IDOC_DATA-SDATA+29(1) = 'X'.
*      WA_IDOC_DATA-SDATA+30(1) = 'X'.
*      WA_IDOC_DATA-SDATA+31(1) = 'X'.
*      WA_IDOC_DATA-SDATA+32(1) = 'X'.
*      WA_IDOC_DATA-SDATA+33(1) = 'X'.
*      WA_IDOC_DATA-SDATA+34(1) = 'X'.
*      WA_IDOC_DATA-SDATA+35(1) = 'X'.
*      WA_IDOC_DATA-SDATA+36(1) = 'X'.
*      WA_IDOC_DATA-SDATA+37(1) = 'X'.
*      WA_IDOC_DATA-SDATA+38(1) = 'X'.
*  WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
*      WA_IDOC_DATA-SDATA+40(1) = 'X'.
*      WA_IDOC_DATA-SDATA+41(1) = 'X'.
*      WA_IDOC_DATA-SDATA+42(1) = 'X'.
*      WA_IDOC_DATA-SDATA+43(1) = 'X'.
*      WA_IDOC_DATA-SDATA+44(1) = 'X'.
*      WA_IDOC_DATA-SDATA+45(1) = 'X'.
*      WA_IDOC_DATA-SDATA+46(1) = 'X'.
*      WA_IDOC_DATA-SDATA+47(1) = 'X'.
*      WA_IDOC_DATA-SDATA+48(1) = 'X'.
*      WA_IDOC_DATA-SDATA+49(1) = 'X'.
*      WA_IDOC_DATA-SDATA+50(1) = 'X'.
*      WA_IDOC_DATA-SDATA+51(1) = 'X'.
*      WA_IDOC_DATA-SDATA+52(1) = 'X'.
*      WA_IDOC_DATA-SDATA+53(1) = 'X'.
*      WA_IDOC_DATA-SDATA+54(1) = 'X'.
*      WA_IDOC_DATA-SDATA+55(1) = 'X'.
*      WA_IDOC_DATA-SDATA+56(1) = 'X'.
*      WA_IDOC_DATA-SDATA+57(1) = 'X'.
*      WA_IDOC_DATA-SDATA+58(1) = 'X'.
*      WA_IDOC_DATA-SDATA+59(1) = 'X'.
*      WA_IDOC_DATA-SDATA+60(1) = 'X'.
*      WA_IDOC_DATA-SDATA+61(1) = 'X'.
*      WA_IDOC_DATA-SDATA+62(1) = 'X'.
*      WA_IDOC_DATA-SDATA+63(1) = 'X'.
*      WA_IDOC_DATA-SDATA+64(1) = 'X'.
*      WA_IDOC_DATA-SDATA+65(1) = 'X'.
*      WA_IDOC_DATA-SDATA+66(1) = 'X'.
*      WA_IDOC_DATA-SDATA+67(1) = 'X'.
*      WA_IDOC_DATA-SDATA+68(1) = 'X'.
*      WA_IDOC_DATA-SDATA+69(1) = 'X'.
*      WA_IDOC_DATA-SDATA+70(1) = 'X'.
*      WA_IDOC_DATA-SDATA+71(1) = 'X'.
*      WA_IDOC_DATA-SDATA+72(1) = 'X'.
*      WA_IDOC_DATA-SDATA+73(1) = 'X'.
*      WA_IDOC_DATA-SDATA+74(1) = 'X'.
*      WA_IDOC_DATA-SDATA+75(1) = 'X'.
*      WA_IDOC_DATA-SDATA+76(1) = 'X'.
*      WA_IDOC_DATA-SDATA+77(1) = 'X'.
*      WA_IDOC_DATA-SDATA+78(1) = 'X'.
*      WA_IDOC_DATA-SDATA+79(1) = 'X'.
*      WA_IDOC_DATA-SDATA+80(1) = 'X'.
*      WA_IDOC_DATA-SDATA+81(1) = 'X'.
*      WA_IDOC_DATA-SDATA+82(1) = 'X'.
*      WA_IDOC_DATA-SDATA+83(1) = 'X'.
*      WA_IDOC_DATA-SDATA+84(1) = 'X'.
*      WA_IDOC_DATA-SDATA+85(1) = 'X'.
*      WA_IDOC_DATA-SDATA+86(1) = 'X'.
*      WA_IDOC_DATA-SDATA+87(1) = 'X'.
*      WA_IDOC_DATA-SDATA+88(1) = 'X'.
*      WA_IDOC_DATA-SDATA+89(1) = 'X'.
*      WA_IDOC_DATA-SDATA+90(1) = 'X'.
*      WA_IDOC_DATA-SDATA+91(1) = 'X'.
*      WA_IDOC_DATA-SDATA+92(1) = 'X'.
*      WA_IDOC_DATA-SDATA+93(1) = 'X'.
*      WA_IDOC_DATA-SDATA+94(1) = 'X'.
*      WA_IDOC_DATA-SDATA+95(1) = 'X'.
*      WA_IDOC_DATA-SDATA+96(1) = 'X'.
*      WA_IDOC_DATA-SDATA+97(1) = 'X'.
*      WA_IDOC_DATA-SDATA+98(1) = 'X'.
*      WA_IDOC_DATA-SDATA+99(1) = 'X'.
*      WA_IDOC_DATA-SDATA+100(1) = 'X'.
*      WA_IDOC_DATA-SDATA+101(1) = 'X'.
*      WA_IDOC_DATA-SDATA+102(1) = 'X'.
*      WA_IDOC_DATA-SDATA+103(1) = 'X'.
*      WA_IDOC_DATA-SDATA+104(1) = 'X'.
*      WA_IDOC_DATA-SDATA+105(1) = 'X'.
*      WA_IDOC_DATA-SDATA+106(1) = 'X'.
*      WA_IDOC_DATA-SDATA+107(1) = 'X'.
*      WA_IDOC_DATA-SDATA+108(1) = 'X'.
*      WA_IDOC_DATA-SDATA+109(1) = 'X'.
*      WA_IDOC_DATA-SDATA+110(1) = 'X'.
*      WA_IDOC_DATA-SDATA+111(1) = 'X'.
*      WA_IDOC_DATA-SDATA+112(1) = 'X'.
*      WA_IDOC_DATA-SDATA+113(1) = 'X'.
*      WA_IDOC_DATA-SDATA+114(1) = 'X'.
*      WA_IDOC_DATA-SDATA+115(1) = 'X'.
*      WA_IDOC_DATA-SDATA+116(1) = 'X'.
*      WA_IDOC_DATA-SDATA+117(1) = 'X'.
*      WA_IDOC_DATA-SDATA+118(1) = 'X'.
*      WA_IDOC_DATA-SDATA+119(1) = 'X'.
*      WA_IDOC_DATA-SDATA+120(1) = 'X'.
*      WA_IDOC_DATA-SDATA+121(1) = 'X'.
*      WA_IDOC_DATA-SDATA+122(1) = 'X'.
*      WA_IDOC_DATA-SDATA+123(1) = 'X'.
*      WA_IDOC_DATA-SDATA+124(1) = 'X'.
*      WA_IDOC_DATA-SDATA+125(1) = 'X'.
*      WA_IDOC_DATA-SDATA+126(1) = 'X'.
*      WA_IDOC_DATA-SDATA+127(1) = 'X'.
*      WA_IDOC_DATA-SDATA+128(1) = 'X'.
*      WA_IDOC_DATA-SDATA+129(1) = 'X'.
*      WA_IDOC_DATA-SDATA+130(1) = 'X'.
*      WA_IDOC_DATA-SDATA+131(1) = 'X'.
*      WA_IDOC_DATA-SDATA+132(1) = 'X'.
*      WA_IDOC_DATA-SDATA+133(1) = 'X'.
*      WA_IDOC_DATA-SDATA+134(1) = 'X'.
*      WA_IDOC_DATA-SDATA+135(1) = 'X'.
*      WA_IDOC_DATA-SDATA+136(1) = 'X'.
*      WA_IDOC_DATA-SDATA+137(1) = 'X'.
*      WA_IDOC_DATA-SDATA+138(1) = 'X'.
*      WA_IDOC_DATA-SDATA+139(1) = 'X'.
*      WA_IDOC_DATA-SDATA+140(1) = 'X'.
*      WA_IDOC_DATA-SDATA+141(1) = 'X'.
*      WA_IDOC_DATA-SDATA+142(1) = 'X'.
*      WA_IDOC_DATA-SDATA+143(1) = 'X'.
*      WA_IDOC_DATA-SDATA+144(1) = 'X'.
*      WA_IDOC_DATA-SDATA+145(1) = 'X'.
*      WA_IDOC_DATA-SDATA+146(1) = 'X'.
*      WA_IDOC_DATA-SDATA+147(1) = 'X'.
*      WA_IDOC_DATA-SDATA+148(1) = 'X'.
*      WA_IDOC_DATA-SDATA+149(1) = 'X'.
*      WA_IDOC_DATA-SDATA+150(1) = 'X'.
*      WA_IDOC_DATA-SDATA+151(1) = 'X'.
*      WA_IDOC_DATA-SDATA+152(1) = 'X'.
*      WA_IDOC_DATA-SDATA+153(1) = 'X'.
*      WA_IDOC_DATA-SDATA+154(1) = 'X'.
*      WA_IDOC_DATA-SDATA+155(1) = 'X'.
*      WA_IDOC_DATA-SDATA+156(1) = 'X'.
*      WA_IDOC_DATA-SDATA+157(1) = 'X'.
*      WA_IDOC_DATA-SDATA+158(1) = 'X'.
*      WA_IDOC_DATA-SDATA+159(1) = 'X'.
*      WA_IDOC_DATA-SDATA+160(1) = 'X'.
*      WA_IDOC_DATA-SDATA+161(1) = 'X'.
*      WA_IDOC_DATA-SDATA+162(1) = 'X'.
*      WA_IDOC_DATA-SDATA+163(1) = 'X'.
*      WA_IDOC_DATA-SDATA+164(1) = 'X'.
*      WA_IDOC_DATA-SDATA+165(1) = 'X'.
*      WA_IDOC_DATA-SDATA+166(1) = 'X'.
*      WA_IDOC_DATA-SDATA+167(1) = 'X'.
*      WA_IDOC_DATA-SDATA+168(1) = 'X'.
*      WA_IDOC_DATA-SDATA+169(1) = 'X'.
*      WA_IDOC_DATA-SDATA+252(1) = 'X'.
*      WA_IDOC_DATA-SDATA+253(1) = 'X'.
*      WA_IDOC_DATA-SDATA+254(1) = 'X'.
*      WA_IDOC_DATA-SDATA+255(1) = 'X'.
*      WA_IDOC_DATA-SDATA+256(1) = 'X'.
*      WA_IDOC_DATA-SDATA+257(1) = 'X'.
**  WA_IDOC_DATA-SDATA+258(1) = 'X'.
*      WA_IDOC_DATA-SDATA+259(1) = 'X'.
*      WA_IDOC_DATA-SDATA+260(1) = 'X'.
*      WA_IDOC_DATA-SDATA+261(1) = 'X'.
*      WA_IDOC_DATA-SDATA+262(1) = 'X'.
*      WA_IDOC_DATA-SDATA+263(1) = 'X'.
*      WA_IDOC_DATA-SDATA+264(1) = 'X'.
*      WA_IDOC_DATA-SDATA+265(1) = 'X'.
*      WA_IDOC_DATA-SDATA+266(1) = 'X'.
*      WA_IDOC_DATA-SDATA+267(1) = 'X'.
*      WA_IDOC_DATA-SDATA+268(1) = 'X'.
*      WA_IDOC_DATA-SDATA+269(1) = 'X'.
*      WA_IDOC_DATA-SDATA+270(1) = 'X'.
*      WA_IDOC_DATA-SDATA+271(1) = 'X'.
*      WA_IDOC_DATA-SDATA+272(1) = 'X'.
*      WA_IDOC_DATA-SDATA+273(1) = 'X'.
*      WA_IDOC_DATA-SDATA+274(1) = 'X'.
*      WA_IDOC_DATA-SDATA+275(1) = 'X'.
*      WA_IDOC_DATA-SDATA+276(1) = 'X'.
*      WA_IDOC_DATA-SDATA+277(1) = 'X'.
*      WA_IDOC_DATA-SDATA+278(1) = 'X'.
*      WA_IDOC_DATA-SDATA+279(1) = 'X'.
*      WA_IDOC_DATA-SDATA+280(1) = 'X'.
*      WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE1>-VARIANT_LONG."
*      WA_IDOC_DATA-SDATA+321(1) = 'X'.
*      WA_IDOC_DATA-SDATA+322(1) = 'X'.
*      WA_IDOC_DATA-SDATA+323(1) = 'X'.
*      WA_IDOC_DATA-SDATA+324(1) = 'X'.
*      WA_IDOC_DATA-SDATA+325(1) = 'X'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*    ENDIF.
*  ENDLOOP.
*  IF <FS_FLATFILE>-PLANT IS INITIAL.
*    """"""""""""E1BPE1MARCRTX"""""""""""
*    T2 = T2 + 1.
*    WA_IDOC_DATA-MANDT          = SY-MANDT.
*    WA_IDOC_DATA-SEGNUM         = T2.                       "'000013'.
*    WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRTX'.
*    WA_IDOC_DATA-SDATA+0(3)    = '005'.
*    WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
*    WA_IDOC_DATA-SDATA+25(1) = 'X'.
*    WA_IDOC_DATA-SDATA+26(1) = 'X'.
*    WA_IDOC_DATA-SDATA+27(1) = 'X'.
*    WA_IDOC_DATA-SDATA+28(1) = 'X'.
*    WA_IDOC_DATA-SDATA+29(1) = 'X'.
*    WA_IDOC_DATA-SDATA+30(1) = 'X'.
*    WA_IDOC_DATA-SDATA+31(1) = 'X'.
*    WA_IDOC_DATA-SDATA+32(1) = 'X'.
**  WA_IDOC_DATA-SDATA+33(1) = 'X'.
*    WA_IDOC_DATA-SDATA+34(1) = 'X'.
*    WA_IDOC_DATA-SDATA+35(1) = 'X'.
*    WA_IDOC_DATA-SDATA+36(1) = 'X'.
*    WA_IDOC_DATA-SDATA+37(1) = 'X'.
*    WA_IDOC_DATA-SDATA+38(1) = 'X'.
*  WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
*    WA_IDOC_DATA-SDATA+40(1) = 'X'.
*    WA_IDOC_DATA-SDATA+41(1) = 'X'.
*    WA_IDOC_DATA-SDATA+42(1) = 'X'.
*    WA_IDOC_DATA-SDATA+43(1) = 'X'.
*    WA_IDOC_DATA-SDATA+44(1) = 'X'.
*    WA_IDOC_DATA-SDATA+45(1) = 'X'.
*    WA_IDOC_DATA-SDATA+46(1) = 'X'.
*    WA_IDOC_DATA-SDATA+47(1) = 'X'.
*    WA_IDOC_DATA-SDATA+48(1) = 'X'.
*    WA_IDOC_DATA-SDATA+49(1) = 'X'.
*    WA_IDOC_DATA-SDATA+50(1) = 'X'.
*    WA_IDOC_DATA-SDATA+51(1) = 'X'.
*    WA_IDOC_DATA-SDATA+52(1) = 'X'.
*    WA_IDOC_DATA-SDATA+53(1) = 'X'.
*    WA_IDOC_DATA-SDATA+54(1) = 'X'.
*    WA_IDOC_DATA-SDATA+55(1) = 'X'.
*    WA_IDOC_DATA-SDATA+56(1) = 'X'.
*    WA_IDOC_DATA-SDATA+57(1) = 'X'.
*    WA_IDOC_DATA-SDATA+58(1) = 'X'.
*    WA_IDOC_DATA-SDATA+59(1) = 'X'.
*    WA_IDOC_DATA-SDATA+60(1) = 'X'.
*    WA_IDOC_DATA-SDATA+61(1) = 'X'.
*    WA_IDOC_DATA-SDATA+62(1) = 'X'.
*    WA_IDOC_DATA-SDATA+63(1) = 'X'.
*    WA_IDOC_DATA-SDATA+64(1) = 'X'.
*    WA_IDOC_DATA-SDATA+65(1) = 'X'.
*    WA_IDOC_DATA-SDATA+66(1) = 'X'.
*    WA_IDOC_DATA-SDATA+67(1) = 'X'.
*    WA_IDOC_DATA-SDATA+68(1) = 'X'.
*    WA_IDOC_DATA-SDATA+69(1) = 'X'.
*    WA_IDOC_DATA-SDATA+70(1) = 'X'.
*    WA_IDOC_DATA-SDATA+71(1) = 'X'.
*    WA_IDOC_DATA-SDATA+72(1) = 'X'.
*    WA_IDOC_DATA-SDATA+73(1) = 'X'.
*    WA_IDOC_DATA-SDATA+74(1) = 'X'.
*    WA_IDOC_DATA-SDATA+75(1) = 'X'.
*    WA_IDOC_DATA-SDATA+76(1) = 'X'.
*    WA_IDOC_DATA-SDATA+77(1) = 'X'.
*    WA_IDOC_DATA-SDATA+78(1) = 'X'.
*    WA_IDOC_DATA-SDATA+79(1) = 'X'.
*    WA_IDOC_DATA-SDATA+80(1) = 'X'.
*    WA_IDOC_DATA-SDATA+81(1) = 'X'.
*    WA_IDOC_DATA-SDATA+82(1) = 'X'.
*    WA_IDOC_DATA-SDATA+83(1) = 'X'.
*    WA_IDOC_DATA-SDATA+84(1) = 'X'.
*    WA_IDOC_DATA-SDATA+85(1) = 'X'.
*    WA_IDOC_DATA-SDATA+86(1) = 'X'.
*    WA_IDOC_DATA-SDATA+87(1) = 'X'.
*    WA_IDOC_DATA-SDATA+88(1) = 'X'.
*    WA_IDOC_DATA-SDATA+89(1) = 'X'.
*    WA_IDOC_DATA-SDATA+90(1) = 'X'.
*    WA_IDOC_DATA-SDATA+91(1) = 'X'.
*    WA_IDOC_DATA-SDATA+92(1) = 'X'.
*    WA_IDOC_DATA-SDATA+93(1) = 'X'.
*    WA_IDOC_DATA-SDATA+94(1) = 'X'.
*    WA_IDOC_DATA-SDATA+95(1) = 'X'.
*    WA_IDOC_DATA-SDATA+96(1) = 'X'.
*    WA_IDOC_DATA-SDATA+97(1) = 'X'.
*    WA_IDOC_DATA-SDATA+98(1) = 'X'.
*    WA_IDOC_DATA-SDATA+99(1) = 'X'.
*    WA_IDOC_DATA-SDATA+100(1) = 'X'.
*    WA_IDOC_DATA-SDATA+101(1) = 'X'.
*    WA_IDOC_DATA-SDATA+102(1) = 'X'.
*    WA_IDOC_DATA-SDATA+103(1) = 'X'.
*    WA_IDOC_DATA-SDATA+104(1) = 'X'.
*    WA_IDOC_DATA-SDATA+105(1) = 'X'.
*    WA_IDOC_DATA-SDATA+106(1) = 'X'.
*    WA_IDOC_DATA-SDATA+107(1) = 'X'.
*    WA_IDOC_DATA-SDATA+108(1) = 'X'.
*    WA_IDOC_DATA-SDATA+109(1) = 'X'.
*    WA_IDOC_DATA-SDATA+110(1) = 'X'.
*    WA_IDOC_DATA-SDATA+111(1) = 'X'.
*    WA_IDOC_DATA-SDATA+112(1) = 'X'.
*    WA_IDOC_DATA-SDATA+113(1) = 'X'.
*    WA_IDOC_DATA-SDATA+114(1) = 'X'.
*    WA_IDOC_DATA-SDATA+115(1) = 'X'.
*    WA_IDOC_DATA-SDATA+116(1) = 'X'.
*    WA_IDOC_DATA-SDATA+117(1) = 'X'.
*    WA_IDOC_DATA-SDATA+118(1) = 'X'.
*    WA_IDOC_DATA-SDATA+119(1) = 'X'.
***  WA_IDOC_DATA-SDATA+120(1) = 'X'.
*    WA_IDOC_DATA-SDATA+121(1) = 'X'.
*    WA_IDOC_DATA-SDATA+122(1) = 'X'.
*    WA_IDOC_DATA-SDATA+123(1) = 'X'.
*    WA_IDOC_DATA-SDATA+124(1) = 'X'.
*    WA_IDOC_DATA-SDATA+125(1) = 'X'.
*    WA_IDOC_DATA-SDATA+126(1) = 'X'.
*    WA_IDOC_DATA-SDATA+127(1) = 'X'.
*    WA_IDOC_DATA-SDATA+128(1) = 'X'.
*    WA_IDOC_DATA-SDATA+129(1) = 'X'.
*    WA_IDOC_DATA-SDATA+130(1) = 'X'.
*    WA_IDOC_DATA-SDATA+131(1) = 'X'.
*    WA_IDOC_DATA-SDATA+132(1) = 'X'.
*    WA_IDOC_DATA-SDATA+133(1) = 'X'.
*    WA_IDOC_DATA-SDATA+134(1) = 'X'.
*    WA_IDOC_DATA-SDATA+135(1) = 'X'.
*    WA_IDOC_DATA-SDATA+136(1) = 'X'.
*    WA_IDOC_DATA-SDATA+137(1) = 'X'.
*    WA_IDOC_DATA-SDATA+138(1) = 'X'.
*    WA_IDOC_DATA-SDATA+139(1) = 'X'.
*    WA_IDOC_DATA-SDATA+140(1) = 'X'.
*    WA_IDOC_DATA-SDATA+141(1) = 'X'.
*    WA_IDOC_DATA-SDATA+142(1) = 'X'.
*    WA_IDOC_DATA-SDATA+143(1) = 'X'.
*    WA_IDOC_DATA-SDATA+144(1) = 'X'.
*    WA_IDOC_DATA-SDATA+145(1) = 'X'.
*    WA_IDOC_DATA-SDATA+146(1) = 'X'.
*    WA_IDOC_DATA-SDATA+147(1) = 'X'.
*    WA_IDOC_DATA-SDATA+148(1) = 'X'.
*    WA_IDOC_DATA-SDATA+149(1) = 'X'.
*    WA_IDOC_DATA-SDATA+150(1) = 'X'.
*    WA_IDOC_DATA-SDATA+151(1) = 'X'.
*    WA_IDOC_DATA-SDATA+152(1) = 'X'.
*    WA_IDOC_DATA-SDATA+153(1) = 'X'.
*    WA_IDOC_DATA-SDATA+154(1) = 'X'.
*    WA_IDOC_DATA-SDATA+155(1) = 'X'.
*    WA_IDOC_DATA-SDATA+156(1) = 'X'.
*    WA_IDOC_DATA-SDATA+157(1) = 'X'.
*    WA_IDOC_DATA-SDATA+158(1) = 'X'.
*    WA_IDOC_DATA-SDATA+159(1) = 'X'.
*    WA_IDOC_DATA-SDATA+160(1) = 'X'.
*    WA_IDOC_DATA-SDATA+161(1) = 'X'.
*    WA_IDOC_DATA-SDATA+162(1) = 'X'.
*    WA_IDOC_DATA-SDATA+163(1) = 'X'.
*    WA_IDOC_DATA-SDATA+164(1) = 'X'.
*    WA_IDOC_DATA-SDATA+165(1) = 'X'.
*    WA_IDOC_DATA-SDATA+166(1) = 'X'.
*    WA_IDOC_DATA-SDATA+167(1) = 'X'.
*    WA_IDOC_DATA-SDATA+168(1) = 'X'.
*    WA_IDOC_DATA-SDATA+169(1) = 'X'.
*    WA_IDOC_DATA-SDATA+252(1) = 'X'.
*    WA_IDOC_DATA-SDATA+253(1) = 'X'.
*    WA_IDOC_DATA-SDATA+254(1) = 'X'.
*    WA_IDOC_DATA-SDATA+255(1) = 'X'.
*    WA_IDOC_DATA-SDATA+256(1) = 'X'.
*    WA_IDOC_DATA-SDATA+257(1) = 'X'.
*    WA_IDOC_DATA-SDATA+258(1) = 'X'.
*    WA_IDOC_DATA-SDATA+259(1) = 'X'.
*    WA_IDOC_DATA-SDATA+260(1) = 'X'.
*    WA_IDOC_DATA-SDATA+261(1) = 'X'.
*    WA_IDOC_DATA-SDATA+262(1) = 'X'.
*    WA_IDOC_DATA-SDATA+263(1) = 'X'.
*    WA_IDOC_DATA-SDATA+264(1) = 'X'.
*    WA_IDOC_DATA-SDATA+265(1) = 'X'.
*    WA_IDOC_DATA-SDATA+266(1) = 'X'.
*    WA_IDOC_DATA-SDATA+267(1) = 'X'.
*    WA_IDOC_DATA-SDATA+268(1) = 'X'.
*    WA_IDOC_DATA-SDATA+269(1) = 'X'.
*    WA_IDOC_DATA-SDATA+270(1) = 'X'.
*    WA_IDOC_DATA-SDATA+271(1) = 'X'.
*    WA_IDOC_DATA-SDATA+272(1) = 'X'.
*    WA_IDOC_DATA-SDATA+273(1) = 'X'.
*    WA_IDOC_DATA-SDATA+274(1) = 'X'.
*    WA_IDOC_DATA-SDATA+275(1) = 'X'.
*    WA_IDOC_DATA-SDATA+276(1) = 'X'.
*    WA_IDOC_DATA-SDATA+277(1) = 'X'.
*    WA_IDOC_DATA-SDATA+278(1) = 'X'.
*    WA_IDOC_DATA-SDATA+279(1) = 'X'.
*    WA_IDOC_DATA-SDATA+280(1) = 'X'.
*    WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-MATERIAL."
*    WA_IDOC_DATA-SDATA+321(1) = 'X'.
*    WA_IDOC_DATA-SDATA+322(1) = 'X'.
*    WA_IDOC_DATA-SDATA+323(1) = 'X'.
*    WA_IDOC_DATA-SDATA+324(1) = 'X'.
*    WA_IDOC_DATA-SDATA+325(1) = 'X'.
*    APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*    CLEAR WA_IDOC_DATA.
*
*    """"""""""""E1BPE1MARCRTX"""""""""""
*    T2 = T2 + 1.
*    WA_IDOC_DATA-MANDT       = SY-MANDT.
*    WA_IDOC_DATA-SEGNUM      = T2.                          "'000013'.
*    WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARCRTX'.
*    WA_IDOC_DATA-SDATA+0(3)  = '005'.
*    WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
*    WA_IDOC_DATA-SDATA+25(1) = 'X'.
*    WA_IDOC_DATA-SDATA+26(1) = 'X'.
*    WA_IDOC_DATA-SDATA+27(1) = 'X'.
*    WA_IDOC_DATA-SDATA+28(1) = 'X'.
*    WA_IDOC_DATA-SDATA+29(1) = 'X'.
*    WA_IDOC_DATA-SDATA+30(1) = 'X'.
*    WA_IDOC_DATA-SDATA+31(1) = 'X'.
*    WA_IDOC_DATA-SDATA+32(1) = 'X'.
**  WA_IDOC_DATA-SDATA+33(1) = 'X'.
*    WA_IDOC_DATA-SDATA+34(1) = 'X'.
*    WA_IDOC_DATA-SDATA+35(1) = 'X'.
*    WA_IDOC_DATA-SDATA+36(1) = 'X'.
*    WA_IDOC_DATA-SDATA+37(1) = 'X'.
*    WA_IDOC_DATA-SDATA+38(1) = 'X'.
*  WA_IDOC_DATA-SDATA+39(1) = 'X'."""PROC_TYPE
*    WA_IDOC_DATA-SDATA+40(1) = 'X'.
*    WA_IDOC_DATA-SDATA+41(1) = 'X'.
*    WA_IDOC_DATA-SDATA+42(1) = 'X'.
*    WA_IDOC_DATA-SDATA+43(1) = 'X'.
*    WA_IDOC_DATA-SDATA+44(1) = 'X'.
*    WA_IDOC_DATA-SDATA+45(1) = 'X'.
*    WA_IDOC_DATA-SDATA+46(1) = 'X'.
*    WA_IDOC_DATA-SDATA+47(1) = 'X'.
*    WA_IDOC_DATA-SDATA+48(1) = 'X'.
*    WA_IDOC_DATA-SDATA+49(1) = 'X'.
*    WA_IDOC_DATA-SDATA+50(1) = 'X'.
*    WA_IDOC_DATA-SDATA+51(1) = 'X'.
*    WA_IDOC_DATA-SDATA+52(1) = 'X'.
*    WA_IDOC_DATA-SDATA+53(1) = 'X'.
*    WA_IDOC_DATA-SDATA+54(1) = 'X'.
*    WA_IDOC_DATA-SDATA+55(1) = 'X'.
*    WA_IDOC_DATA-SDATA+56(1) = 'X'.
*    WA_IDOC_DATA-SDATA+57(1) = 'X'.
*    WA_IDOC_DATA-SDATA+58(1) = 'X'.
*    WA_IDOC_DATA-SDATA+59(1) = 'X'.
*    WA_IDOC_DATA-SDATA+60(1) = 'X'.
*    WA_IDOC_DATA-SDATA+61(1) = 'X'.
*    WA_IDOC_DATA-SDATA+62(1) = 'X'.
*    WA_IDOC_DATA-SDATA+63(1) = 'X'.
*    WA_IDOC_DATA-SDATA+64(1) = 'X'.
*    WA_IDOC_DATA-SDATA+65(1) = 'X'.
*    WA_IDOC_DATA-SDATA+66(1) = 'X'.
*    WA_IDOC_DATA-SDATA+67(1) = 'X'.
*    WA_IDOC_DATA-SDATA+68(1) = 'X'.
*    WA_IDOC_DATA-SDATA+69(1) = 'X'.
*    WA_IDOC_DATA-SDATA+70(1) = 'X'.
*    WA_IDOC_DATA-SDATA+71(1) = 'X'.
*    WA_IDOC_DATA-SDATA+72(1) = 'X'.
*    WA_IDOC_DATA-SDATA+73(1) = 'X'.
*    WA_IDOC_DATA-SDATA+74(1) = 'X'.
*    WA_IDOC_DATA-SDATA+75(1) = 'X'.
*    WA_IDOC_DATA-SDATA+76(1) = 'X'.
*    WA_IDOC_DATA-SDATA+77(1) = 'X'.
*    WA_IDOC_DATA-SDATA+78(1) = 'X'.
*    WA_IDOC_DATA-SDATA+79(1) = 'X'.
*    WA_IDOC_DATA-SDATA+80(1) = 'X'.
*    WA_IDOC_DATA-SDATA+81(1) = 'X'.
*    WA_IDOC_DATA-SDATA+82(1) = 'X'.
*    WA_IDOC_DATA-SDATA+83(1) = 'X'.
*    WA_IDOC_DATA-SDATA+84(1) = 'X'.
*    WA_IDOC_DATA-SDATA+85(1) = 'X'.
*    WA_IDOC_DATA-SDATA+86(1) = 'X'.
*    WA_IDOC_DATA-SDATA+87(1) = 'X'.
*    WA_IDOC_DATA-SDATA+88(1) = 'X'.
*    WA_IDOC_DATA-SDATA+89(1) = 'X'.
*    WA_IDOC_DATA-SDATA+90(1) = 'X'.
*    WA_IDOC_DATA-SDATA+91(1) = 'X'.
*    WA_IDOC_DATA-SDATA+92(1) = 'X'.
*    WA_IDOC_DATA-SDATA+93(1) = 'X'.
*    WA_IDOC_DATA-SDATA+94(1) = 'X'.
*    WA_IDOC_DATA-SDATA+95(1) = 'X'.
*    WA_IDOC_DATA-SDATA+96(1) = 'X'.
*    WA_IDOC_DATA-SDATA+97(1) = 'X'.
*    WA_IDOC_DATA-SDATA+98(1) = 'X'.
*    WA_IDOC_DATA-SDATA+99(1) = 'X'.
*    WA_IDOC_DATA-SDATA+100(1) = 'X'.
*    WA_IDOC_DATA-SDATA+101(1) = 'X'.
*    WA_IDOC_DATA-SDATA+102(1) = 'X'.
*    WA_IDOC_DATA-SDATA+103(1) = 'X'.
*    WA_IDOC_DATA-SDATA+104(1) = 'X'.
*    WA_IDOC_DATA-SDATA+105(1) = 'X'.
*    WA_IDOC_DATA-SDATA+106(1) = 'X'.
*    WA_IDOC_DATA-SDATA+107(1) = 'X'.
*    WA_IDOC_DATA-SDATA+108(1) = 'X'.
*    WA_IDOC_DATA-SDATA+109(1) = 'X'.
*    WA_IDOC_DATA-SDATA+110(1) = 'X'.
*    WA_IDOC_DATA-SDATA+111(1) = 'X'.
*    WA_IDOC_DATA-SDATA+112(1) = 'X'.
*    WA_IDOC_DATA-SDATA+113(1) = 'X'.
*    WA_IDOC_DATA-SDATA+114(1) = 'X'.
*    WA_IDOC_DATA-SDATA+115(1) = 'X'.
*    WA_IDOC_DATA-SDATA+116(1) = 'X'.
*    WA_IDOC_DATA-SDATA+117(1) = 'X'.
*    WA_IDOC_DATA-SDATA+118(1) = 'X'.
*    WA_IDOC_DATA-SDATA+119(1) = 'X'.
****  WA_IDOC_DATA-SDATA+120(1) = 'X'.
*    WA_IDOC_DATA-SDATA+121(1) = 'X'.
*    WA_IDOC_DATA-SDATA+122(1) = 'X'.
*    WA_IDOC_DATA-SDATA+123(1) = 'X'.
*    WA_IDOC_DATA-SDATA+124(1) = 'X'.
*    WA_IDOC_DATA-SDATA+125(1) = 'X'.
*    WA_IDOC_DATA-SDATA+126(1) = 'X'.
*    WA_IDOC_DATA-SDATA+127(1) = 'X'.
*    WA_IDOC_DATA-SDATA+128(1) = 'X'.
*    WA_IDOC_DATA-SDATA+129(1) = 'X'.
*    WA_IDOC_DATA-SDATA+130(1) = 'X'.
*    WA_IDOC_DATA-SDATA+131(1) = 'X'.
*    WA_IDOC_DATA-SDATA+132(1) = 'X'.
*    WA_IDOC_DATA-SDATA+133(1) = 'X'.
*    WA_IDOC_DATA-SDATA+134(1) = 'X'.
*    WA_IDOC_DATA-SDATA+135(1) = 'X'.
*    WA_IDOC_DATA-SDATA+136(1) = 'X'.
*    WA_IDOC_DATA-SDATA+137(1) = 'X'.
*    WA_IDOC_DATA-SDATA+138(1) = 'X'.
*    WA_IDOC_DATA-SDATA+139(1) = 'X'.
*    WA_IDOC_DATA-SDATA+140(1) = 'X'.
*    WA_IDOC_DATA-SDATA+141(1) = 'X'.
*    WA_IDOC_DATA-SDATA+142(1) = 'X'.
*    WA_IDOC_DATA-SDATA+143(1) = 'X'.
*    WA_IDOC_DATA-SDATA+144(1) = 'X'.
*    WA_IDOC_DATA-SDATA+145(1) = 'X'.
*    WA_IDOC_DATA-SDATA+146(1) = 'X'.
*    WA_IDOC_DATA-SDATA+147(1) = 'X'.
*    WA_IDOC_DATA-SDATA+148(1) = 'X'.
*    WA_IDOC_DATA-SDATA+149(1) = 'X'.
*    WA_IDOC_DATA-SDATA+150(1) = 'X'.
*    WA_IDOC_DATA-SDATA+151(1) = 'X'.
*    WA_IDOC_DATA-SDATA+152(1) = 'X'.
*    WA_IDOC_DATA-SDATA+153(1) = 'X'.
*    WA_IDOC_DATA-SDATA+154(1) = 'X'.
*    WA_IDOC_DATA-SDATA+155(1) = 'X'.
*    WA_IDOC_DATA-SDATA+156(1) = 'X'.
*    WA_IDOC_DATA-SDATA+157(1) = 'X'.
*    WA_IDOC_DATA-SDATA+158(1) = 'X'.
*    WA_IDOC_DATA-SDATA+159(1) = 'X'.
*    WA_IDOC_DATA-SDATA+160(1) = 'X'.
*    WA_IDOC_DATA-SDATA+161(1) = 'X'.
*    WA_IDOC_DATA-SDATA+162(1) = 'X'.
*    WA_IDOC_DATA-SDATA+163(1) = 'X'.
*    WA_IDOC_DATA-SDATA+164(1) = 'X'.
*    WA_IDOC_DATA-SDATA+165(1) = 'X'.
*    WA_IDOC_DATA-SDATA+166(1) = 'X'.
*    WA_IDOC_DATA-SDATA+167(1) = 'X'.
*    WA_IDOC_DATA-SDATA+168(1) = 'X'.
*    WA_IDOC_DATA-SDATA+169(1) = 'X'.
*    WA_IDOC_DATA-SDATA+252(1) = 'X'.
*    WA_IDOC_DATA-SDATA+253(1) = 'X'.
*    WA_IDOC_DATA-SDATA+254(1) = 'X'.
*    WA_IDOC_DATA-SDATA+255(1) = 'X'.
*    WA_IDOC_DATA-SDATA+256(1) = 'X'.
*    WA_IDOC_DATA-SDATA+257(1) = 'X'.
*    WA_IDOC_DATA-SDATA+258(1) = 'X'.
*    WA_IDOC_DATA-SDATA+259(1) = 'X'.
*    WA_IDOC_DATA-SDATA+260(1) = 'X'.
*    WA_IDOC_DATA-SDATA+261(1) = 'X'.
*    WA_IDOC_DATA-SDATA+262(1) = 'X'.
*    WA_IDOC_DATA-SDATA+263(1) = 'X'.
*    WA_IDOC_DATA-SDATA+264(1) = 'X'.
*    WA_IDOC_DATA-SDATA+265(1) = 'X'.
*    WA_IDOC_DATA-SDATA+266(1) = 'X'.
*    WA_IDOC_DATA-SDATA+267(1) = 'X'.
*    WA_IDOC_DATA-SDATA+268(1) = 'X'.
*    WA_IDOC_DATA-SDATA+269(1) = 'X'.
*    WA_IDOC_DATA-SDATA+270(1) = 'X'.
*    WA_IDOC_DATA-SDATA+271(1) = 'X'.
*    WA_IDOC_DATA-SDATA+272(1) = 'X'.
*    WA_IDOC_DATA-SDATA+273(1) = 'X'.
*    WA_IDOC_DATA-SDATA+274(1) = 'X'.
*    WA_IDOC_DATA-SDATA+275(1) = 'X'.
*    WA_IDOC_DATA-SDATA+276(1) = 'X'.
*    WA_IDOC_DATA-SDATA+277(1) = 'X'.
*    WA_IDOC_DATA-SDATA+278(1) = 'X'.
*    WA_IDOC_DATA-SDATA+279(1) = 'X'.
*    WA_IDOC_DATA-SDATA+280(1) = 'X'.
*    WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-VARIANT_LONG."
*    WA_IDOC_DATA-SDATA+321(1) = 'X'.
*    WA_IDOC_DATA-SDATA+322(1) = 'X'.
*    WA_IDOC_DATA-SDATA+323(1) = 'X'.
*    WA_IDOC_DATA-SDATA+324(1) = 'X'.
*    WA_IDOC_DATA-SDATA+325(1) = 'X'.
*    APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*    CLEAR WA_IDOC_DATA.
*  ENDIF.
*
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000014'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
**  WA_IDOC_DATA-SDATA+30(1)    = <FS_FLATFILE>-MODEL_SP."'2'.
**  WA_IDOC_DATA-SDATA+33(1)    = <FS_FLATFILE>-INITIALIZE."'X'.
**  WA_IDOC_DATA-SDATA+55(7)    = <FS_FLATFILE>-TRACKLIMIT."'4.000'.
**  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-HIST_VALS."'60'.
**  WA_IDOC_DATA-SDATA+86(4)    = <FS_FLATFILE>-FORE_PDS."'12'.
*  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT          = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM         = T2.                     "'000014'.
*      WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
*      WA_IDOC_DATA-SDATA+0(3)     = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*      ENDIF.
**  WA_IDOC_DATA-SDATA+30(1)    = <FS_FLATFILE>-MODEL_SP."'2'.
**  WA_IDOC_DATA-SDATA+33(1)    = <FS_FLATFILE>-INITIALIZE."'X'.
**  WA_IDOC_DATA-SDATA+55(7)    = <FS_FLATFILE>-TRACKLIMIT."'4.000'.
**  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-HIST_VALS."'60'.
**  WA_IDOC_DATA-SDATA+86(4)    = <FS_FLATFILE>-FORE_PDS."'12'.
*      WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-VARIANT_LONG."'SST123T10'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*    ENDIF.
*  ENDLOOP.
*
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000015'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
**  WA_IDOC_DATA-SDATA+30(1)    = <FS_FLATFILE>-MODEL_SP."'2'.
**  WA_IDOC_DATA-SDATA+33(1)    = <FS_FLATFILE>-INITIALIZE."'X'.
**  WA_IDOC_DATA-SDATA+55(7)    = <FS_FLATFILE>-TRACKLIMIT."'4.000'.
**  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-HIST_VALS."'60'.
**  WA_IDOC_DATA-SDATA+86(4)    = <FS_FLATFILE>-FORE_PDS."'12'.
*  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000015'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
**  WA_IDOC_DATA-SDATA+30(1)    = <FS_FLATFILE>-MODEL_SP."'2'.
**  WA_IDOC_DATA-SDATA+33(1)    = <FS_FLATFILE>-INITIALIZE."'X'.
**  WA_IDOC_DATA-SDATA+55(7)    = <FS_FLATFILE>-TRACKLIMIT."'4.000'.
**  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-HIST_VALS."'60'.
**  WA_IDOC_DATA-SDATA+86(4)    = <FS_FLATFILE>-FORE_PDS."'12'.
*  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-VARIANT_LONG."'SST123T10'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000016'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
**  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT          = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM         = T2.                     "'000016'.
*      WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
*      WA_IDOC_DATA-SDATA+0(3)     = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*      ENDIF.
*      WA_IDOC_DATA-SDATA+25(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+26(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+30(1)    = 'X'.
**  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+44(1)    = 'X'.
*      WA_IDOC_DATA-SDATA+127(40)  = <FS_FLATFILE1>-VARIANT_LONG.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*    ENDIF.
*  ENDLOOP.
*
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000017'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
*  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
**  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000017'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
*  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
**  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE1>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000018'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT          = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM         = T2.                     "'000018'.
*      WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
*      WA_IDOC_DATA-SDATA+0(3)     = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*      ENDIF.
*      WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE1>-VARIANT_LONG.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*    ENDIF.
*  ENDLOOP.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000019'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
*  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000019'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
*  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE1>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  """"""""""""""""""" E1BPE1MPGDRTX """""""""
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000020'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MPGDRTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+25(1) = 'X'.
*  WA_IDOC_DATA-SDATA+26(1) = 'X'.
*  WA_IDOC_DATA-SDATA+27(1) = 'X'.
*  WA_IDOC_DATA-SDATA+110(1) = 'X'.
*  WA_IDOC_DATA-SDATA+111(1) = 'X'.
*  WA_IDOC_DATA-SDATA+112(1) = 'X'.
*  WA_IDOC_DATA-SDATA+113(40) = <FS_FLATFILE>-MATERIAL.
*  WA_IDOC_DATA-SDATA+153(1) = 'X'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT       = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM      = T2.                        "'000020'.
*      WA_IDOC_DATA-SEGNAM      = 'E1BPE1MPGDRTX'.
*      WA_IDOC_DATA-SDATA+0(3)  = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*      ENDIF.
*      WA_IDOC_DATA-SDATA+25(1) = 'X'.
*      WA_IDOC_DATA-SDATA+26(1) = 'X'.
*      WA_IDOC_DATA-SDATA+27(1) = 'X'.
*      WA_IDOC_DATA-SDATA+110(1) = 'X'.
*      WA_IDOC_DATA-SDATA+111(1) = 'X'.
*      WA_IDOC_DATA-SDATA+112(1) = 'X'.
*      WA_IDOC_DATA-SDATA+113(40) = <FS_FLATFILE1>-VARIANT_LONG.
*      WA_IDOC_DATA-SDATA+153(1) = 'X'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*    ENDIF.
*  ENDLOOP.
*
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000021'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MPGDRTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
*  WA_IDOC_DATA-SDATA+25(1) = 'X'.
*  WA_IDOC_DATA-SDATA+26(1) = 'X'.
*  WA_IDOC_DATA-SDATA+27(1) = 'X'.
*  WA_IDOC_DATA-SDATA+110(1) = 'X'.
*  WA_IDOC_DATA-SDATA+111(1) = 'X'.
*  WA_IDOC_DATA-SDATA+112(1) = 'X'.
*  WA_IDOC_DATA-SDATA+113(40) = <FS_FLATFILE1>-VARIANT_LONG.
*  WA_IDOC_DATA-SDATA+153(1) = 'X'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000022'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARDRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+25(4)    = 'FG01'."<FS_FLATFILE>-STGE_LOC."'FG01'.
*  WA_IDOC_DATA-SDATA+158(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*
*  """""""""""""""""""" E1BPE1MARDRTX  """""""""""""""""
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000024'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARDRTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
**  WA_IDOC_DATA-SDATA+25(4) = <FS_FLATFILE>-STGE_LOC."'FG01'.
*  WA_IDOC_DATA-SDATA+29(1) = 'X'.
*  WA_IDOC_DATA-SDATA+30(1) = 'X'.
*  WA_IDOC_DATA-SDATA+31(1) = 'X'.
*  WA_IDOC_DATA-SDATA+32(1) = 'X'.
*  WA_IDOC_DATA-SDATA+33(1) = 'X'.
*  WA_IDOC_DATA-SDATA+34(1) = 'X'.
*  WA_IDOC_DATA-SDATA+35(1) = 'X'.
*  WA_IDOC_DATA-SDATA+118(40) = <FS_FLATFILE>-MATERIAL."'SST123T10'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000026'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
*    EXPORTING
*      INPUT  = <FS_FLATFILE>-AUOM
**     LANGUAGE = SY-LANGU
*    IMPORTING
*      OUTPUT = <FS_FLATFILE>-AUOM.
*
*  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."EA
*  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."EA
*  WA_IDOC_DATA-SDATA+27(6)     = <FS_FLATFILE>-DENOMINATR.
*  WA_IDOC_DATA-SDATA+33(6)     = <FS_FLATFILE>-NUMERATOR.
*  WA_IDOC_DATA-SDATA+39(18)    = <FS_FLATFILE>-EAN_UPC.
*  WA_IDOC_DATA-SDATA+57(2)     = <FS_FLATFILE>-CATEGORY.
**  WA_IDOC_DATA-SDATA+59(15)     = <FS_FLATFILE>-LENGTH.
**  WA_IDOC_DATA-SDATA+74(15)     = <FS_FLATFILE>-WIDTH.
**  WA_IDOC_DATA-SDATA+89(15)     = <FS_FLATFILE>-HEIGHT.
**  WA_IDOC_DATA-SDATA+104(3)     = <FS_FLATFILE>-UNITDIM.
**  WA_IDOC_DATA-SDATA+110(15)     = <FS_FLATFILE>-VOLUME.
**  IF <FS_FLATFILE>-VOLUMEUNIT IS NOT INITIAL.
**    CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
**      EXPORTING
**        INPUT  = <FS_FLATFILE>-VOLUMEUNIT
***       LANGUAGE = SY-LANGU
**      IMPORTING
**        OUTPUT = <FS_FLATFILE>-VOLUMEUNIT.
***    WA_IDOC_DATA-SDATA+125(3)     = <FS_FLATFILE>-VOLUMEUNIT.
**  ENDIF.
*  WA_IDOC_DATA-SDATA+131(15)     = <FS_FLATFILE>-GROSSWT.
*  WA_IDOC_DATA-SDATA+146(3)    = <FS_FLATFILE>-WT.
**  WA_IDOC_DATA-SDATA+149(3)    = 'KGM'.
*  WA_IDOC_DATA-SDATA+152(3)    = <FS_FLATFILE>-AUOM."'EA'.
*  WA_IDOC_DATA-SDATA+155(3)    = <FS_FLATFILE>-AUOM."WT."'EA'.
**  WA_IDOC_DATA-SDATA+158(3)    = <FS_FLATFILE>-LUN."EA
**  WA_IDOC_DATA-SDATA+161(3)    = <FS_FLATFILE>-LUN."EA
*  WA_IDOC_DATA-SDATA+271(40)   = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000026'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
*    EXPORTING
*      INPUT  = <FS_FLATFILE>-AUOM
**     LANGUAGE = SY-LANGU
*    IMPORTING
*      OUTPUT = <FS_FLATFILE>-AUOM.
*
*  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."EA
*  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."EA
*  WA_IDOC_DATA-SDATA+27(6)     = <FS_FLATFILE>-DENOMINATR.
*  WA_IDOC_DATA-SDATA+33(6)     = <FS_FLATFILE>-NUMERATOR.
*  WA_IDOC_DATA-SDATA+39(18)    = <FS_FLATFILE>-EAN_UPC.
*  WA_IDOC_DATA-SDATA+57(2)     = <FS_FLATFILE>-CATEGORY.
**  WA_IDOC_DATA-SDATA+59(15)     = <FS_FLATFILE>-LENGTH.
**  WA_IDOC_DATA-SDATA+74(15)     = <FS_FLATFILE>-WIDTH.
**  WA_IDOC_DATA-SDATA+89(15)     = <FS_FLATFILE>-HEIGHT.
**  WA_IDOC_DATA-SDATA+104(3)     = <FS_FLATFILE>-UNITDIM.
**  WA_IDOC_DATA-SDATA+110(15)     = <FS_FLATFILE>-VOLUME.
**  IF <FS_FLATFILE>-VOLUMEUNIT IS NOT INITIAL.
**    CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
**      EXPORTING
**        INPUT  = <FS_FLATFILE>-VOLUMEUNIT
***       LANGUAGE = SY-LANGU
**      IMPORTING
**        OUTPUT = <FS_FLATFILE>-VOLUMEUNIT.
**    WA_IDOC_DATA-SDATA+125(3)     = <FS_FLATFILE>-VOLUMEUNIT.
**  ENDIF.
*  WA_IDOC_DATA-SDATA+131(15)     = <FS_FLATFILE>-GROSSWT.
*  WA_IDOC_DATA-SDATA+146(3)    = <FS_FLATFILE>-WT.
**  WA_IDOC_DATA-SDATA+149(3)    = 'KGM'.
*  WA_IDOC_DATA-SDATA+152(3)    = <FS_FLATFILE>-AUOM."'EA'.
*  WA_IDOC_DATA-SDATA+155(3)    = <FS_FLATFILE>-AUOM."WT."'EA'.
**  WA_IDOC_DATA-SDATA+158(3)    = <FS_FLATFILE>-LUN."EA
**  WA_IDOC_DATA-SDATA+161(3)    = <FS_FLATFILE>-LUN."EA
*  WA_IDOC_DATA-SDATA+271(40)   = <FS_FLATFILE>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000027'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM. "'EA'.
*  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM. "'EA'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+126(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+127(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+128(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+129(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+130(40)   = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000027'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRTX'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."'EA'.
*  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."'EA'.
*  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+126(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+127(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+128(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+129(1)   = 'X'.
*  WA_IDOC_DATA-SDATA+130(40)  = <FS_FLATFILE>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000028'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MLANRT'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(3) = 'IN'.
*  WA_IDOC_DATA-SDATA+24(2) = 'IN'.
*  WA_IDOC_DATA-SDATA+26(4) = 'JOCG'.
*  WA_IDOC_DATA-SDATA+30(1) = '0'.
*  WA_IDOC_DATA-SDATA+31(4) = 'JOSG'.
*  WA_IDOC_DATA-SDATA+35(1) = '0'.
*  WA_IDOC_DATA-SDATA+36(4) = 'JOIG'.
*  WA_IDOC_DATA-SDATA+40(1) = '0'.
*  WA_IDOC_DATA-SDATA+154(40) = <FS_FLATFILE>-MATERIAL..
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000028'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MLANRT'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(3) = 'IN'.
*  WA_IDOC_DATA-SDATA+24(2) = 'IN'.
*  WA_IDOC_DATA-SDATA+26(4) = 'JOCG'.
*  WA_IDOC_DATA-SDATA+30(1) = '0'.
*  WA_IDOC_DATA-SDATA+31(4) = 'JOSG'.
*  WA_IDOC_DATA-SDATA+35(1) = '0'.
*  WA_IDOC_DATA-SDATA+36(4) = 'JOIG'.
*  WA_IDOC_DATA-SDATA+40(1) = '0'.
*  WA_IDOC_DATA-SDATA+154(40) = <FS_FLATFILE>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
**
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000029'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
**  WA_IDOC_DATA-SDATA+36(1)     = <FS_FLATFILE>-PRICE_CTRL."'V'.
*  WA_IDOC_DATA-SDATA+37(25)    = <FS_FLATFILE>-MOVING_PR."'100.0000'.
**  WA_IDOC_DATA-SDATA+62(25)    = <FS_FLATFILE>-STD_PRICE."'100.0000'.
**  WA_IDOC_DATA-SDATA+87(6)     = <FS_FLATFILE>-PRICE_UNIT."'1'.
*  WA_IDOC_DATA-SDATA+93(4)     = <FS_FLATFILE>-VAL_CLASS."'3100'.
******  WA_IDOC_DATA-SDATA+97(1)     = 'V'."<FS_FLATFILE>-PR_CTRL_PP."'V'.
******  WA_IDOC_DATA-SDATA+98(25)    = <FS_FLATFILE>-MOV_PR_PP."'100.0000'.
******  WA_IDOC_DATA-SDATA+123(25)   = <FS_FLATFILE>-STD_PR_PP."'100.0000'.
******  WA_IDOC_DATA-SDATA+148(6)    = <FS_FLATFILE>-PR_UNIT_PP."'1'.
******  WA_IDOC_DATA-SDATA+154(4)    = <FS_FLATFILE>-VAL_CLASS."'7920'." <FS_FLATFILE>-VCLASS_PP."'3100'.
******  WA_IDOC_DATA-SDATA+158(1)    = 'V'." <FS_FLATFILE>-PR_CTRL_PY."'V'.
******  WA_IDOC_DATA-SDATA+159(25)   = <FS_FLATFILE>-MOV_PR_PY."'100.0000'.
******  WA_IDOC_DATA-SDATA+184(25)   = <FS_FLATFILE>-STD_PR_PY."'100.0000'.
******  WA_IDOC_DATA-SDATA+209(6)    = <FS_FLATFILE>-PR_UNIT_PY."'1'.
******  WA_IDOC_DATA-SDATA+215(6)    = <FS_FLATFILE>-VAL_CLASS1."'7920'."<FS_FLATFILE>-VCLASS_PY."'3100'.
**  WA_IDOC_DATA-SDATA+410(1)    = <FS_FLATFILE>-ML_ACTIVE."'X'.
**  WA_IDOC_DATA-SDATA+411(1)    = <FS_FLATFILE>-ML_SETTLE."'2'.
**  WA_IDOC_DATA-SDATA+442(1)    = <FS_FLATFILE>-ORIG_MAT.
**  WA_IDOC_DATA-SDATA+443(10)   = <FS_FLATFILE>-OVERHEAD_GRP."'2'.
**  WA_IDOC_DATA-SDATA+453(1)    = <FS_FLATFILE>-WITH_QTY_STRUCT."'2'.
*  WA_IDOC_DATA-SDATA+660(40)   = <FS_FLATFILE>-MATERIAL."'SST123T10'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT          = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM         = T2.                     "'000029'.
*      WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
*      WA_IDOC_DATA-SDATA+0(3)     = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*      ENDIF.
**      WA_IDOC_DATA-SDATA+36(1)     = <FS_FLATFILE>-PRICE_CTRL."'V'.
*      WA_IDOC_DATA-SDATA+37(25)    = <FS_FLATFILE>-MOVING_PR."'100.0000'.
**      WA_IDOC_DATA-SDATA+62(25)    = <FS_FLATFILE>-STD_PRICE."'100.0000'.
**      WA_IDOC_DATA-SDATA+87(6)     = <FS_FLATFILE>-PRICE_UNIT."'1'.
*      WA_IDOC_DATA-SDATA+93(4)     = <FS_FLATFILE>-VAL_CLASS."'3100'.
*******  WA_IDOC_DATA-SDATA+97(1)     = 'V'."<FS_FLATFILE>-PR_CTRL_PP."'V'.
*******  WA_IDOC_DATA-SDATA+98(25)    = <FS_FLATFILE>-MOV_PR_PP."'100.0000'.
*******  WA_IDOC_DATA-SDATA+123(25)   = <FS_FLATFILE>-STD_PR_PP."'100.0000'.
*******  WA_IDOC_DATA-SDATA+148(6)    = <FS_FLATFILE>-PR_UNIT_PP."'1'.
*******  WA_IDOC_DATA-SDATA+154(4)    = <FS_FLATFILE>-VAL_CLASS."'7920'." <FS_FLATFILE>-VCLASS_PP."'3100'.
*******  WA_IDOC_DATA-SDATA+158(1)    = 'V'." <FS_FLATFILE>-PR_CTRL_PY."'V'.
*******  WA_IDOC_DATA-SDATA+159(25)   = <FS_FLATFILE>-MOV_PR_PY."'100.0000'.
*******  WA_IDOC_DATA-SDATA+184(25)   = <FS_FLATFILE>-STD_PR_PY."'100.0000'.
*******  WA_IDOC_DATA-SDATA+209(6)    = <FS_FLATFILE>-PR_UNIT_PY."'1'.
*******  WA_IDOC_DATA-SDATA+215(6)    = <FS_FLATFILE>-VAL_CLASS1."'7920'."<FS_FLATFILE>-VCLASS_PY."'3100'.
**  WA_IDOC_DATA-SDATA+410(1)    = <FS_FLATFILE>-ML_ACTIVE."'X'.
**      WA_IDOC_DATA-SDATA+411(1)    = <FS_FLATFILE>-ML_SETTLE."'2'.
**      WA_IDOC_DATA-SDATA+442(1)    = <FS_FLATFILE>-ORIG_MAT.
**      WA_IDOC_DATA-SDATA+443(10)    = <FS_FLATFILE>-OVERHEAD_GRP."'2'.
**      WA_IDOC_DATA-SDATA+453(1)    = <FS_FLATFILE>-WITH_QTY_STRUCT."'2'.
*      WA_IDOC_DATA-SDATA+660(40)   = <FS_FLATFILE1>-VARIANT_LONG."'SST123T10'.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*      T2 = T2 + 1.
*    ENDIF.
*  ENDLOOP.
***  """"""""""""""""""""" E1BPE1MBEWRTX  """""""""""""""""
*
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000031'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+35(1) = 'X'.
*  WA_IDOC_DATA-SDATA+36(1) = 'X'.
*  WA_IDOC_DATA-SDATA+37(1) = 'X'.
*  WA_IDOC_DATA-SDATA+38(1) = 'X'.
*  WA_IDOC_DATA-SDATA+39(1) = 'X'.
*  WA_IDOC_DATA-SDATA+40(1) = 'X'.
**  WA_IDOC_DATA-SDATA+41(1) = 'X'."pr_ctnl_pp
*  WA_IDOC_DATA-SDATA+42(1) = 'X'.
*  WA_IDOC_DATA-SDATA+43(1) = 'X'.
*  WA_IDOC_DATA-SDATA+44(1) = 'X'.
***  WA_IDOC_DATA-SDATA+45(1) = 'X'."vclass-py
*****  WA_IDOC_DATA-SDATA+46(1) = 'X'."pr_ctnl_py
*  WA_IDOC_DATA-SDATA+47(1) = 'X'.
*  WA_IDOC_DATA-SDATA+48(1) = 'X'.
*  WA_IDOC_DATA-SDATA+49(1) = 'X'.
******  WA_IDOC_DATA-SDATA+50(1) = 'X'."""Val class py
*  WA_IDOC_DATA-SDATA+51(1) = 'X'.
*  WA_IDOC_DATA-SDATA+52(1) = 'X'.
*  WA_IDOC_DATA-SDATA+53(1) = 'X'.
*  WA_IDOC_DATA-SDATA+54(1) = 'X'.
*  WA_IDOC_DATA-SDATA+55(1) = 'X'.
*  WA_IDOC_DATA-SDATA+56(1) = 'X'.
*  WA_IDOC_DATA-SDATA+57(1) = 'X'.
*  WA_IDOC_DATA-SDATA+58(1) = 'X'.
*  WA_IDOC_DATA-SDATA+59(1) = 'X'.
*  WA_IDOC_DATA-SDATA+60(1) = 'X'.
*  WA_IDOC_DATA-SDATA+61(1) = 'X'.
*  WA_IDOC_DATA-SDATA+62(1) = 'X'.
*  WA_IDOC_DATA-SDATA+63(1) = 'X'.
*  WA_IDOC_DATA-SDATA+64(1) = 'X'.
*  WA_IDOC_DATA-SDATA+65(1) = 'X'.
*  WA_IDOC_DATA-SDATA+66(1) = 'X'.
*  WA_IDOC_DATA-SDATA+67(1) = 'X'.
*  WA_IDOC_DATA-SDATA+68(1) = 'X'.
*  WA_IDOC_DATA-SDATA+69(1) = 'X'.
*  WA_IDOC_DATA-SDATA+70(1) = 'X'.
*  WA_IDOC_DATA-SDATA+71(1) = 'X'.
*  WA_IDOC_DATA-SDATA+72(1) = 'X'.
*  WA_IDOC_DATA-SDATA+73(1) = 'X'.
*  WA_IDOC_DATA-SDATA+74(1) = 'X'.
*  WA_IDOC_DATA-SDATA+75(1) = 'X'.
*  WA_IDOC_DATA-SDATA+76(1) = 'X'.
*  WA_IDOC_DATA-SDATA+77(1) = 'X'.
*  WA_IDOC_DATA-SDATA+78(1) = 'X'.
*  WA_IDOC_DATA-SDATA+79(1) = 'X'.
*  WA_IDOC_DATA-SDATA+80(1) = 'X'.
*  WA_IDOC_DATA-SDATA+81(1) = 'X'.
*  WA_IDOC_DATA-SDATA+82(1) = 'X'.
*  WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
*    IF <FS_FLATFILE1> IS ASSIGNED.
*      WA_IDOC_DATA-MANDT       = SY-MANDT.
*      WA_IDOC_DATA-SEGNUM      = T2.                        "'000031'.
*      WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
*      WA_IDOC_DATA-SDATA+0(3)  = '005'.
*      IF <FS_FLATFILE>-PLANT IS NOT INITIAL.
*        WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-PLANT.
*      ELSE.
*        WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*      ENDIF.
*      WA_IDOC_DATA-SDATA+35(1) = 'X'.
*      WA_IDOC_DATA-SDATA+36(1) = 'X'.
*      WA_IDOC_DATA-SDATA+37(1) = 'X'.
*      WA_IDOC_DATA-SDATA+38(1) = 'X'.
*      WA_IDOC_DATA-SDATA+39(1) = 'X'.
*      WA_IDOC_DATA-SDATA+40(1) = 'X'.
**  WA_IDOC_DATA-SDATA+41(1) = 'X'."pr_ctnl_pp
*      WA_IDOC_DATA-SDATA+42(1) = 'X'.
*      WA_IDOC_DATA-SDATA+43(1) = 'X'.
*      WA_IDOC_DATA-SDATA+44(1) = 'X'.
***  WA_IDOC_DATA-SDATA+45(1) = 'X'."vclass-py
*****  WA_IDOC_DATA-SDATA+46(1) = 'X'."pr_ctnl_py
*      WA_IDOC_DATA-SDATA+47(1) = 'X'.
*      WA_IDOC_DATA-SDATA+48(1) = 'X'.
*      WA_IDOC_DATA-SDATA+49(1) = 'X'.
******  WA_IDOC_DATA-SDATA+50(1) = 'X'."""Val class py
*      WA_IDOC_DATA-SDATA+51(1) = 'X'.
*      WA_IDOC_DATA-SDATA+52(1) = 'X'.
*      WA_IDOC_DATA-SDATA+53(1) = 'X'.
*      WA_IDOC_DATA-SDATA+54(1) = 'X'.
*      WA_IDOC_DATA-SDATA+55(1) = 'X'.
*      WA_IDOC_DATA-SDATA+56(1) = 'X'.
*      WA_IDOC_DATA-SDATA+57(1) = 'X'.
*      WA_IDOC_DATA-SDATA+58(1) = 'X'.
*      WA_IDOC_DATA-SDATA+59(1) = 'X'.
*      WA_IDOC_DATA-SDATA+60(1) = 'X'.
*      WA_IDOC_DATA-SDATA+61(1) = 'X'.
*      WA_IDOC_DATA-SDATA+62(1) = 'X'.
*      WA_IDOC_DATA-SDATA+63(1) = 'X'.
*      WA_IDOC_DATA-SDATA+64(1) = 'X'.
*      WA_IDOC_DATA-SDATA+65(1) = 'X'.
*      WA_IDOC_DATA-SDATA+66(1) = 'X'.
*      WA_IDOC_DATA-SDATA+67(1) = 'X'.
*      WA_IDOC_DATA-SDATA+68(1) = 'X'.
*      WA_IDOC_DATA-SDATA+69(1) = 'X'.
*      WA_IDOC_DATA-SDATA+70(1) = 'X'.
*      WA_IDOC_DATA-SDATA+71(1) = 'X'.
*      WA_IDOC_DATA-SDATA+72(1) = 'X'.
*      WA_IDOC_DATA-SDATA+73(1) = 'X'.
*      WA_IDOC_DATA-SDATA+74(1) = 'X'.
*      WA_IDOC_DATA-SDATA+75(1) = 'X'.
*      WA_IDOC_DATA-SDATA+76(1) = 'X'.
*      WA_IDOC_DATA-SDATA+77(1) = 'X'.
*      WA_IDOC_DATA-SDATA+78(1) = 'X'.
*      WA_IDOC_DATA-SDATA+79(1) = 'X'.
*      WA_IDOC_DATA-SDATA+80(1) = 'X'.
*      WA_IDOC_DATA-SDATA+81(1) = 'X'.
*      WA_IDOC_DATA-SDATA+82(1) = 'X'.
*      WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE1>-VARIANT_LONG.
*      APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*      CLEAR WA_IDOC_DATA.
*    ENDIF.
*  ENDLOOP.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000033'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MVKERT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-SALES_ORG."'1000'.
*  WA_IDOC_DATA-SDATA+25(2)     = <FS_FLATFILE>-DISTR_CHAN."'10'.
*  WA_IDOC_DATA-SDATA+33(1)     = <FS_FLATFILE>-CASH_DISC."'X'.
**  WA_IDOC_DATA-SDATA+110(1)     = <FS_FLATFILE>-SALES_UNIT."'X'.
*  WA_IDOC_DATA-SDATA+116(4)     = <FS_FLATFILE>-ITEM_CAT1."'NORM'.
*  WA_IDOC_DATA-SDATA+162(2)     = <FS_FLATFILE>-ACCT_ASSGT."'01'.
**  WA_IDOC_DATA-SDATA+179(2)     = <FS_FLATFILE>-ASSORT_LEV."'01'.
*  WA_IDOC_DATA-SDATA+182(2)     =  '02'."<FS_FLATFILE>-LI_PROC_ST."'02'.
*  WA_IDOC_DATA-SDATA+184(2)     =  '02'."<FS_FLATFILE>-LI_PROC_ST."'02'.
*  WA_IDOC_DATA-SDATA+186(1)     = 'X'."<FS_FLATFILE>-ASSORT_LEV."ASSORTLIST."'X'.
*  IF V_MAW1 IS INITIAL.
*    WA_IDOC_DATA-SDATA+197(8)     = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
*    WA_IDOC_DATA-SDATA+205(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+213(8)     = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
*    WA_IDOC_DATA-SDATA+221(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+229(8)     = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
*    WA_IDOC_DATA-SDATA+237(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+245(8)     = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
*    WA_IDOC_DATA-SDATA+253(8)     = '99991231'.
*  ELSE.
*    WA_IDOC_DATA-SDATA+59(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+75(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+91(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+107(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
*  ENDIF.
*  WA_IDOC_DATA-SDATA+453(40)    = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT          = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM         = T2.                         "'000033'.
*  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MVKERT'.
*  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+21(4)     = <FS_FLATFILE>-SALES_ORG."'1000'.
*  WA_IDOC_DATA-SDATA+25(2)     = <FS_FLATFILE>-DISTR_CHAN."'10'.
*  WA_IDOC_DATA-SDATA+33(1)     = <FS_FLATFILE>-CASH_DISC."'X'.
**  WA_IDOC_DATA-SDATA+110(1)     = <FS_FLATFILE>-SALES_UNIT."'X'.
*  WA_IDOC_DATA-SDATA+116(4)     = <FS_FLATFILE>-ITEM_CAT1."'NORM'.
*  WA_IDOC_DATA-SDATA+162(2)     = <FS_FLATFILE>-ACCT_ASSGT."'01'.
**  WA_IDOC_DATA-SDATA+179(2)     = <FS_FLATFILE>-ASSORT_LEV."'01'.
*  WA_IDOC_DATA-SDATA+182(2)     =  '02'."<FS_FLATFILE>-LI_PROC_ST."'02'.
*  WA_IDOC_DATA-SDATA+184(2)     =  '02'."<FS_FLATFILE>-LI_PROC_ST."'02'.
*  WA_IDOC_DATA-SDATA+186(1)     = 'X'."<FS_FLATFILE>-ASSORT_LEV."ASSORTLIST."'X'.
*  IF V_MAW1 IS INITIAL.
*    WA_IDOC_DATA-SDATA+197(8)     = SY-DATUM."<FS_FLATFILE>-LIST_ST_FR.
*    WA_IDOC_DATA-SDATA+205(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+213(8)     = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
*    WA_IDOC_DATA-SDATA+221(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+229(8)     = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
*    WA_IDOC_DATA-SDATA+237(8)     = '99991231'.
*    WA_IDOC_DATA-SDATA+245(8)     = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
*    WA_IDOC_DATA-SDATA+253(8)     = '99991231'.
*  ELSE.
*    WA_IDOC_DATA-SDATA+59(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+75(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+91(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
*    WA_IDOC_DATA-SDATA+107(8)    = V_MAW1.
*    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
*  ENDIF.
*  WA_IDOC_DATA-SDATA+453(40)    = <FS_FLATFILE>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
**  """"""""""""""""""""" E1BPE1MVKERTX  """""""""""""""""
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000034'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MVKERTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4) = <FS_FLATFILE>-SALES_ORG.
*  WA_IDOC_DATA-SDATA+25(2) = <FS_FLATFILE>-DISTR_CHAN.
*  WA_IDOC_DATA-SDATA+27(1) = 'X'.
*  WA_IDOC_DATA-SDATA+28(1) = 'X'.
*  WA_IDOC_DATA-SDATA+29(1) = 'X'.
*  WA_IDOC_DATA-SDATA+30(1) = 'X'.
*  WA_IDOC_DATA-SDATA+31(1) = 'X'.
*  WA_IDOC_DATA-SDATA+32(1) = 'X'.
*  WA_IDOC_DATA-SDATA+33(1) = 'X'.
*  WA_IDOC_DATA-SDATA+34(1) = 'X'.
*  WA_IDOC_DATA-SDATA+35(1) = 'X'.
*  WA_IDOC_DATA-SDATA+36(1) = 'X'.
*  WA_IDOC_DATA-SDATA+37(1) = 'X'.
*  WA_IDOC_DATA-SDATA+38(1) = 'X'.
*  WA_IDOC_DATA-SDATA+39(1) = 'X'.
*  WA_IDOC_DATA-SDATA+40(1) = 'X'.
*  WA_IDOC_DATA-SDATA+41(1) = 'X'.
*  WA_IDOC_DATA-SDATA+42(1) = 'X'.
*  WA_IDOC_DATA-SDATA+43(1) = 'X'.
*  WA_IDOC_DATA-SDATA+44(1) = 'X'.
*  WA_IDOC_DATA-SDATA+45(1) = 'X'.
*  WA_IDOC_DATA-SDATA+46(1) = 'X'.
*  WA_IDOC_DATA-SDATA+47(1) = 'X'.
*  WA_IDOC_DATA-SDATA+48(1) = 'X'.
*  WA_IDOC_DATA-SDATA+49(1) = 'X'.
*  WA_IDOC_DATA-SDATA+50(1) = 'X'.
*  WA_IDOC_DATA-SDATA+51(1) = 'X'.
*  WA_IDOC_DATA-SDATA+52(1) = 'X'.
*  WA_IDOC_DATA-SDATA+53(1) = 'X'.
*  WA_IDOC_DATA-SDATA+54(1) = 'X'.
*  WA_IDOC_DATA-SDATA+55(1) = 'X'.
*  WA_IDOC_DATA-SDATA+56(1) = 'X'.
*  WA_IDOC_DATA-SDATA+57(1) = 'X'.
*  WA_IDOC_DATA-SDATA+58(1) = 'X'.
*  WA_IDOC_DATA-SDATA+59(1) = 'X'.
*  WA_IDOC_DATA-SDATA+60(1) = 'X'.
*  WA_IDOC_DATA-SDATA+61(1) = 'X'.
*  WA_IDOC_DATA-SDATA+62(1) = 'X'.
*  WA_IDOC_DATA-SDATA+63(1) = 'X'.
*  WA_IDOC_DATA-SDATA+64(1) = 'X'.
*  WA_IDOC_DATA-SDATA+65(1) = 'X'.
*  WA_IDOC_DATA-SDATA+66(1) = 'X'.
*  WA_IDOC_DATA-SDATA+67(1) = 'X'.
*  WA_IDOC_DATA-SDATA+68(1) = 'X'.
*  WA_IDOC_DATA-SDATA+69(1) = 'X'.
*  WA_IDOC_DATA-SDATA+76(1) = 'X'.
*  WA_IDOC_DATA-SDATA+77(1) = 'X'.
*  WA_IDOC_DATA-SDATA+78(1) = 'X'.
*  WA_IDOC_DATA-SDATA+79(1) = 'X'.
*  WA_IDOC_DATA-SDATA+80(1) = 'X'.
*  WA_IDOC_DATA-SDATA+81(1) = 'X'.
*  WA_IDOC_DATA-SDATA+164(1) = 'X'.
*  WA_IDOC_DATA-SDATA+165(1) = 'X'.
*  WA_IDOC_DATA-SDATA+166(1) = 'X'.
*  WA_IDOC_DATA-SDATA+167(1) = 'X'.
*  WA_IDOC_DATA-SDATA+168(40) = <FS_FLATFILE>-MATERIAL.
*  WA_IDOC_DATA-SDATA+208(1) = 'X'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000034'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MVKERTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4) = <FS_FLATFILE>-SALES_ORG.
*  WA_IDOC_DATA-SDATA+25(2) = <FS_FLATFILE>-DISTR_CHAN.
*  WA_IDOC_DATA-SDATA+27(1) = 'X'.
*  WA_IDOC_DATA-SDATA+28(1) = 'X'.
*  WA_IDOC_DATA-SDATA+29(1) = 'X'.
*  WA_IDOC_DATA-SDATA+30(1) = 'X'.
*  WA_IDOC_DATA-SDATA+31(1) = 'X'.
*  WA_IDOC_DATA-SDATA+32(1) = 'X'.
*  WA_IDOC_DATA-SDATA+33(1) = 'X'.
*  WA_IDOC_DATA-SDATA+34(1) = 'X'.
*  WA_IDOC_DATA-SDATA+35(1) = 'X'.
*  WA_IDOC_DATA-SDATA+36(1) = 'X'.
*  WA_IDOC_DATA-SDATA+37(1) = 'X'.
*  WA_IDOC_DATA-SDATA+38(1) = 'X'.
*  WA_IDOC_DATA-SDATA+39(1) = 'X'.
*  WA_IDOC_DATA-SDATA+40(1) = 'X'.
*  WA_IDOC_DATA-SDATA+41(1) = 'X'.
*  WA_IDOC_DATA-SDATA+42(1) = 'X'.
*  WA_IDOC_DATA-SDATA+43(1) = 'X'.
*  WA_IDOC_DATA-SDATA+44(1) = 'X'.
*  WA_IDOC_DATA-SDATA+45(1) = 'X'.
*  WA_IDOC_DATA-SDATA+46(1) = 'X'.
*  WA_IDOC_DATA-SDATA+47(1) = 'X'.
*  WA_IDOC_DATA-SDATA+48(1) = 'X'.
*  WA_IDOC_DATA-SDATA+49(1) = 'X'.
*  WA_IDOC_DATA-SDATA+50(1) = 'X'.
*  WA_IDOC_DATA-SDATA+51(1) = 'X'.
*  WA_IDOC_DATA-SDATA+52(1) = 'X'.
*  WA_IDOC_DATA-SDATA+53(1) = 'X'.
*  WA_IDOC_DATA-SDATA+54(1) = 'X'.
*  WA_IDOC_DATA-SDATA+55(1) = 'X'.
*  WA_IDOC_DATA-SDATA+56(1) = 'X'.
*  WA_IDOC_DATA-SDATA+57(1) = 'X'.
*  WA_IDOC_DATA-SDATA+58(1) = 'X'.
*  WA_IDOC_DATA-SDATA+59(1) = 'X'.
*  WA_IDOC_DATA-SDATA+60(1) = 'X'.
*  WA_IDOC_DATA-SDATA+61(1) = 'X'.
*  WA_IDOC_DATA-SDATA+62(1) = 'X'.
*  WA_IDOC_DATA-SDATA+63(1) = 'X'.
*  WA_IDOC_DATA-SDATA+64(1) = 'X'.
*  WA_IDOC_DATA-SDATA+65(1) = 'X'.
*  WA_IDOC_DATA-SDATA+66(1) = 'X'.
*  WA_IDOC_DATA-SDATA+67(1) = 'X'.
*  WA_IDOC_DATA-SDATA+68(1) = 'X'.
*  WA_IDOC_DATA-SDATA+69(1) = 'X'.
*  WA_IDOC_DATA-SDATA+76(1) = 'X'.
*  WA_IDOC_DATA-SDATA+77(1) = 'X'.
*  WA_IDOC_DATA-SDATA+78(1) = 'X'.
*  WA_IDOC_DATA-SDATA+79(1) = 'X'.
*  WA_IDOC_DATA-SDATA+80(1) = 'X'.
*  WA_IDOC_DATA-SDATA+81(1) = 'X'.
*  WA_IDOC_DATA-SDATA+164(1) = 'X'.
*  WA_IDOC_DATA-SDATA+165(1) = 'X'.
*  WA_IDOC_DATA-SDATA+166(1) = 'X'.
*  WA_IDOC_DATA-SDATA+167(1) = 'X'.
*  WA_IDOC_DATA-SDATA+168(40) = <FS_FLATFILE>-VARIANT_LONG.
*  WA_IDOC_DATA-SDATA+208(1) = 'X'.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
**
**  """"""""""""""""""""" E1BPE1WLK2RT """""""""""""""""
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000035'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RT'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)  = <FS_FLATFILE>-SALES_ORG."1000
*  WA_IDOC_DATA-SDATA+25(2)  = <FS_FLATFILE>-DISTR_CHAN.""10
*  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000035'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RT'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)  = <FS_FLATFILE>-SALES_ORG."1000
*  WA_IDOC_DATA-SDATA+25(2)  = <FS_FLATFILE>-DISTR_CHAN.""10
*  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
**  """"""""""""""""""""" E1BPE1WLK2RTX """""""""""""""""
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000036'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)  = <FS_FLATFILE>-SALES_ORG."1000
*  WA_IDOC_DATA-SDATA+25(2)  = <FS_FLATFILE>-DISTR_CHAN."10
*  WA_IDOC_DATA-SDATA+31(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+121(40)  = <FS_FLATFILE>-MATERIAL.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*
*  T2 = T2 + 1.
*  WA_IDOC_DATA-MANDT       = SY-MANDT.
*  WA_IDOC_DATA-SEGNUM      = T2.                            "'000036'.
*  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RTX'.
*  WA_IDOC_DATA-SDATA+0(3)  = '005'.
*  WA_IDOC_DATA-SDATA+21(4)  = <FS_FLATFILE>-SALES_ORG."1000
*  WA_IDOC_DATA-SDATA+25(2)  = <FS_FLATFILE>-DISTR_CHAN."10
*  WA_IDOC_DATA-SDATA+31(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+32(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+35(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+36(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+37(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+38(1)  = 'X'.
*  WA_IDOC_DATA-SDATA+121(40)  = <FS_FLATFILE>-VARIANT_LONG.
*  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
*  CLEAR WA_IDOC_DATA.
*  CLEAR T2.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form SINGLE_MATERIAL
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SINGLE_MATERIAL .
  BREAK BREDDY .
************Data Records*************************
************Hedare data**************************
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = '000001'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MATHEAD'.
  WA_IDOC_DATA-SDATA+21(4)    = MATL_TYPE."'HAWA'.""MATL_TYPE"
  WA_IDOC_DATA-SDATA+25(9)    = <FS_FLATFILE>-MATL_GROUP."'MC10009'."
  WA_IDOC_DATA-SDATA+34(2)    = <FS_FLATFILE>-MATL_CAT."'00'."
  WA_IDOC_DATA-SDATA+36(18)   = <FS_FLATFILE>-CHAR_PROF."'
  WA_IDOC_DATA-SDATA+72(1)    = 'X'.
  WA_IDOC_DATA-SDATA+73(1)    = 'X'.
  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
  WA_IDOC_DATA-SDATA+75(1)    = 'X'.
  WA_IDOC_DATA-SDATA+76(1)    = 'X'.
  WA_IDOC_DATA-SDATA+77(1)    = 'X'.
  WA_IDOC_DATA-SDATA+246(40)  =  <FS_FLATFILE>-MATERIAL."'SST123T10'."""Material
**  WA_IDOC_DATA-SDATA+326(18)  =  <FS_FLATFILE>-CHAR_PROF."CONFIG_CLASS_NAME
**  WA_IDOC_DATA-SDATA+344(3)   =  <FS_FLATFILE>-CONFIG_CLASS_TYPE."'300'."CONFIG_CLASS_TYPE
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  BREAK BREDDY.
  DATA:T  TYPE SY-TABIX.
  DATA:T2 TYPE SY-TABIX.
  CLEAR T.
  T = '000002'.
  READ TABLE TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WITH KEY MATERIAL = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-MANDT           = SY-MANDT.
  WA_IDOC_DATA-SEGNUM          = T2.                        "'000002'.
  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARART'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+80(3)     = <FS_FLATFILE>-BASE_UOM."'EA'.'EA'."
  WA_IDOC_DATA-SDATA+83(3)     = <FS_FLATFILE>-BASE_UOM.".
  WA_IDOC_DATA-SDATA+249(4)    = TRANS_GRP.                 ".'0001'.
  WA_IDOC_DATA-SDATA+271(2)    = DIVISION.".'10'.
  WA_IDOC_DATA-SDATA+380(1)    = <FS_FLATFILE>-BATCH_MGMT. "BATCH_MGMT
  WA_IDOC_DATA-SDATA+429(8)    = SY-DATUM.
  WA_IDOC_DATA-SDATA+437(8)    = '99991231'.
*  WA_IDOC_DATA-SDATA+452(18)   = <FS_FLATFILE>-EXTMATLGRP.
****  WA_IDOC_DATA-SDATA+510(8)    = <FS_FLATFILE>-PVALIDFROM.
****  WA_IDOC_DATA-SDATA+518(8)    = <FS_FLATFILE>-SVALIDFROM.
  WA_IDOC_DATA-SDATA+526(1)    = TAX_CLASS.".'0'.   ""TAX_CLASS
  WA_IDOC_DATA-SDATA+569(1)    = PRPROFVAR.".'0'.   ""TAX_CLASS
  WA_IDOC_DATA-SDATA+602(4)    = ITEM_CAT.". 'NORM'.
  WA_IDOC_DATA-SDATA+308(18)    = <FS_FLATFILE>-PROD_HIER.".

  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000003'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARART1'.
  WA_IDOC_DATA-SDATA+36(4)    = <FS_FLATFILE>-BRAND_ID."'AKIL'."brand
  WA_IDOC_DATA-SDATA+473(1)   = 'X'.
  WA_IDOC_DATA-SDATA+478(40)  = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-FASHION_GRADE.
  WA_IDOC_DATA-SDATA+446(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE1.
  WA_IDOC_DATA-SDATA+456(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE2.
  WA_IDOC_DATA-SDATA+466(10)   = <FS_FLATFILE>-FSH_MG_ATTRIBUTE3.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.


  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARARTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+49(1)    = 'X'.""trans_grp
  WA_IDOC_DATA-SDATA+51(1)    = 'X'.
  WA_IDOC_DATA-SDATA+59(1)    = 'X'.
  WA_IDOC_DATA-SDATA+70(1)    = 'X'.
  WA_IDOC_DATA-SDATA+74(1)    = 'X'.
  WA_IDOC_DATA-SDATA+81(1)    = 'X'.
  WA_IDOC_DATA-SDATA+82(1)    = 'X'.
  WA_IDOC_DATA-SDATA+86(1)    = 'X'.
  WA_IDOC_DATA-SDATA+93(1)    = 'X'.
  WA_IDOC_DATA-SDATA+99(1)    = 'X'.
  WA_IDOC_DATA-SDATA+112(1)    = 'X'.
  WA_IDOC_DATA-SDATA+207(1)   = 'X'.
  WA_IDOC_DATA-SDATA+209(1)   = 'X'.
  WA_IDOC_DATA-SDATA+210(1)   = 'X'.
  WA_IDOC_DATA-SDATA+211(1)   = 'X'.
  WA_IDOC_DATA-SDATA+212(1)   = 'X'.
  WA_IDOC_DATA-SDATA+213(1)   = 'X'.
  WA_IDOC_DATA-SDATA+214(1)   = 'X'.
  WA_IDOC_DATA-SDATA+215(1)   = 'X'.
  WA_IDOC_DATA-SDATA+216(1)   = 'X'.
  WA_IDOC_DATA-SDATA+217(1)   = 'X'.
  WA_IDOC_DATA-SDATA+218(1)   = 'X'.
  WA_IDOC_DATA-SDATA+219(1)   = 'X'.
  WA_IDOC_DATA-SDATA+220(1)   = 'X'.
  WA_IDOC_DATA-SDATA+221(1)   = 'X'.
  WA_IDOC_DATA-SDATA+255(1)   = 'X'.
  WA_IDOC_DATA-SDATA+257(1)   = 'X'.
  WA_IDOC_DATA-SDATA+258(1)   = 'X'.
  WA_IDOC_DATA-SDATA+259(1)   = 'X'.
  WA_IDOC_DATA-SDATA+260(1)   = 'X'.
  WA_IDOC_DATA-SDATA+261(1)   = 'X'.
  WA_IDOC_DATA-SDATA+262(1)   = 'X'.
  WA_IDOC_DATA-SDATA+264(1)   = 'X'.
  WA_IDOC_DATA-SDATA+267(1)   = 'X'.
  WA_IDOC_DATA-SDATA+268(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.


  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000005'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
*  WA_IDOC_DATA-SDATA+40(3)    = <FS_FLATFILE>-COUNTRYORI."'0001'. "
  WA_IDOC_DATA-SDATA+48(4)    = LOADINGGRP."'0001'. "
**  WA_IDOC_DATA-SDATA+52(2)    = <FS_FLATFILE>-ASSORT_LEV."'0001'. "
  WA_IDOC_DATA-SDATA+55(2)    = '02'."<FS_FLATFILE>-LI_PROC_ST."'0001'. "
  WA_IDOC_DATA-SDATA+57(2)    = '02'."<FS_FLATFILE>-LI_PROC_DC."'0001'. "
***  SELECT SINGLE LDVFL FROM MAW1 INTO @DATA(V_MAW1) WHERE MATNR = @<FS_FLATFILE>-MATERIAL.
***  IF SY-SUBRC IS NOT INITIAL.
  WA_IDOC_DATA-SDATA+59(8)    = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
  WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
  WA_IDOC_DATA-SDATA+75(8)    = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
  WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
  WA_IDOC_DATA-SDATA+91(8)    = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
  WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
  WA_IDOC_DATA-SDATA+107(8)    = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
  WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
****  ELSE.
****    WA_IDOC_DATA-SDATA+59(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
****    WA_IDOC_DATA-SDATA+75(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
****    WA_IDOC_DATA-SDATA+91(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
****    WA_IDOC_DATA-SDATA+107(8)    = V_MAW1.
****    WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
****  ENDIF.
  WA_IDOC_DATA-SDATA+123(4)   = VAL_CLASS."'3100'. "
  WA_IDOC_DATA-SDATA+240(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.


  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000006'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAW1RTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(1)    = 'X'.
  WA_IDOC_DATA-SDATA+22(1)    = 'X'.
  WA_IDOC_DATA-SDATA+23(1)    = 'X'.
  WA_IDOC_DATA-SDATA+24(1)    = 'X'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.

  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+45(1)    = 'X'.
  WA_IDOC_DATA-SDATA+46(1)    = 'X'.
  WA_IDOC_DATA-SDATA+47(1)    = 'X'.
  WA_IDOC_DATA-SDATA+48(1)    = 'X'.
  WA_IDOC_DATA-SDATA+49(1)    = 'X'.
  WA_IDOC_DATA-SDATA+50(1)    = 'X'.
  WA_IDOC_DATA-SDATA+132(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000007'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MAKTRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(1)    = 'E'.
  WA_IDOC_DATA-SDATA+22(2)    = 'EN'.
  WA_IDOC_DATA-SDATA+24(40)   = <FS_FLATFILE1>-MATL_DESC."
  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE1>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.

  """""""""""""""""""""""""""""""Plant data""""""""""""""""""""""""""""""""""""""""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT           = SY-MANDT.
  WA_IDOC_DATA-SEGNUM          = T2.                        "'000008'.
  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARCRT'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = 'RFDC'.
*  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
  WA_IDOC_DATA-SDATA+41(2)     = 'RP'."<FS_FLATFILE>-MRP_TYPE."'RP'.
  WA_IDOC_DATA-SDATA+62(2)     = 'EX'.
  WA_IDOC_DATA-SDATA+264(4)    = LOADINGGRP."'0001'.
  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
  WA_IDOC_DATA-SDATA+276(2)    = AVAILCHECK."'01'.
*  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000009'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
  WA_IDOC_DATA-SDATA+54(1)    = 'X'.
  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
*  WA_IDOC_DATA-SDATA+11(4)   = <FS_FLATFILE>-GI_PR_TIME."
  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-MATERIAL."
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  T2 = T2 + 1.


  WA_IDOC_DATA-MANDT           = SY-MANDT.
  WA_IDOC_DATA-SEGNUM          = T2.                        "'000010'.
  WA_IDOC_DATA-SEGNAM          = 'E1BPE1MARCRT'.
  WA_IDOC_DATA-SDATA+0(3)      = '005'.
  WA_IDOC_DATA-SDATA+21(4)     = 'RFST'.
*  WA_IDOC_DATA-SDATA+28(3)     = <FS_FLATFILE>-PUR_GROUP."'001'.
  WA_IDOC_DATA-SDATA+41(2)     = 'ND'."<FS_FLATFILE>-MRP_TYPE."'RP'.
**  WA_IDOC_DATA-SDATA+43(3)     = <FS_FLATFILE>-MRP_CTRLER."'001'.
**  WA_IDOC_DATA-SDATA+46(4)     = <FS_FLATFILE>-PLND_DELRY."'1'.
**  WA_IDOC_DATA-SDATA+50(4)     = <FS_FLATFILE>-GR_PR_TIME."'0'.
**  WA_IDOC_DATA-SDATA+54(1)     = <FS_FLATFILE>-PERIOD_IND."'W'.
  WA_IDOC_DATA-SDATA+62(2)     = 'EX'."<FS_FLATFILE>-LOT_SIZE."'EX'.
**  WA_IDOC_DATA-SDATA+64(1)     = <FS_FLATFILE>-PROC_TYPE."'F'.
***  WA_IDOC_DATA-SDATA+65(2)     = <FS_FLATFILE>-SPPROCTYPE."'F'.
***  WA_IDOC_DATA-SDATA+67(15)    = <FS_FLATFILE>-REORDER_PT."'5.000'.
***  WA_IDOC_DATA-SDATA+157(15)   = <FS_FLATFILE>-MAX_STOCK."'5.000'.
***  WA_IDOC_DATA-SDATA+197(1)   = <FS_FLATFILE>-DEP_REQ_ID.
***  WA_IDOC_DATA-SDATA+229(3)   = <FS_FLATFILE>-SM_KEY.
*  WA_IDOC_DATA-SDATA+232(1)    = <FS_FLATFILE>-BACKFLUSH.
*  WA_IDOC_DATA-SDATA+233(4)    = <FS_FLATFILE>-INHSEPRODT.
  WA_IDOC_DATA-SDATA+264(4)    = LOADINGGRP."'0001'.
  WA_IDOC_DATA-SDATA+268(1)    = <FS_FLATFILE>-BATCH_MGMT."'X'.
  WA_IDOC_DATA-SDATA+276(2)    = AVAILCHECK."'01'.
*  WA_IDOC_DATA-SDATA+342(10)   = <FS_FLATFILE>-PROFIT_CTR."'0000010120'.
****  WA_IDOC_DATA-SDATA+366(4)    = <FS_FLATFILE>-ISS_ST_LOC."'0000010120'.
*  WA_IDOC_DATA-SDATA+370(4)    = <FS_FLATFILE>-MRP_GROUP."'0000010120'.
*  WA_IDOC_DATA-SDATA+403(4)    = <FS_FLATFILE>-SERNO_PROF."'Z001'.
**  WA_IDOC_DATA-SDATA+486(4)    = <FS_FLATFILE>-PLAN_STRGP."'Z001'.
***  WA_IDOC_DATA-SDATA+488(4)    = <FS_FLATFILE>-STGE_LOC."'FG01'.
*  WA_IDOC_DATA-SDATA+511(1)    = <FS_FLATFILE>-BATCHENTRY.
  WA_IDOC_DATA-SDATA+573(16)   = <FS_FLATFILE>-CTRL_CODE."'HSN123'.""tested
**  WA_IDOC_DATA-SDATA+606(3)    = <FS_FLATFILE>-PRODUCTION_SCHEDULER."'HSN123'.
****  WA_IDOC_DATA-SDATA+609(6)    = <FS_FLATFILE>-PROD_PROF."'HSN123'.
****  WA_IDOC_DATA-SDATA+641(5)    = <FS_FLATFILE>-UNDER_TOL."'HSN123'.
****  WA_IDOC_DATA-SDATA+646(5)    =  <FS_FLATFILE>-OVER_TOL."'HSN123'.
***  WA_IDOC_DATA-SDATA+694(6)    =  <FS_FLATFILE>-VARIANCE_KEY."'HSN123'.
  WA_IDOC_DATA-SDATA+716(15)   = '1.000'."<FS_FLATFILE>-LOT_SIZE."'1.000'.
*  WA_IDOC_DATA-SDATA+731(15)   = <FS_FLATFILE>-MIN_SAFETY_STK."'1.000'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000011'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRT1'.
  WA_IDOC_DATA-SDATA+54(1)    = 'X'.
  WA_IDOC_DATA-SDATA+55(16)   = 'A'.
  WA_IDOC_DATA-SDATA+85(40)   = <FS_FLATFILE>-MATERIAL."
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  """"""""""""E1BPE1MARCRTX"""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000012'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARCRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+83(1) = 'X'.
  WA_IDOC_DATA-SDATA+84(1) = 'X'.
  WA_IDOC_DATA-SDATA+85(1) = 'X'.
  WA_IDOC_DATA-SDATA+86(1) = 'X'.
  WA_IDOC_DATA-SDATA+87(1) = 'X'.
  WA_IDOC_DATA-SDATA+88(1) = 'X'.
  WA_IDOC_DATA-SDATA+89(1) = 'X'.
  WA_IDOC_DATA-SDATA+90(1) = 'X'.
  WA_IDOC_DATA-SDATA+91(1) = 'X'.
  WA_IDOC_DATA-SDATA+92(1) = 'X'.
  WA_IDOC_DATA-SDATA+93(1) = 'X'.
  WA_IDOC_DATA-SDATA+94(1) = 'X'.
  WA_IDOC_DATA-SDATA+95(1) = 'X'.
  WA_IDOC_DATA-SDATA+96(1) = 'X'.
  WA_IDOC_DATA-SDATA+97(1) = 'X'.
  WA_IDOC_DATA-SDATA+98(1) = 'X'.
  WA_IDOC_DATA-SDATA+99(1) = 'X'.
  WA_IDOC_DATA-SDATA+100(1) = 'X'.
  WA_IDOC_DATA-SDATA+101(1) = 'X'.
  WA_IDOC_DATA-SDATA+102(1) = 'X'.
  WA_IDOC_DATA-SDATA+103(1) = 'X'.
  WA_IDOC_DATA-SDATA+104(1) = 'X'.
  WA_IDOC_DATA-SDATA+105(1) = 'X'.
  WA_IDOC_DATA-SDATA+106(1) = 'X'.
  WA_IDOC_DATA-SDATA+107(1) = 'X'.
  WA_IDOC_DATA-SDATA+108(1) = 'X'.
  WA_IDOC_DATA-SDATA+109(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(1) = 'X'.
  WA_IDOC_DATA-SDATA+114(1) = 'X'.
  WA_IDOC_DATA-SDATA+115(1) = 'X'.
  WA_IDOC_DATA-SDATA+116(1) = 'X'.
  WA_IDOC_DATA-SDATA+117(1) = 'X'.
  WA_IDOC_DATA-SDATA+118(1) = 'X'.
  WA_IDOC_DATA-SDATA+119(1) = 'X'.
  WA_IDOC_DATA-SDATA+120(1) = 'X'.
  WA_IDOC_DATA-SDATA+121(1) = 'X'.
  WA_IDOC_DATA-SDATA+122(1) = 'X'.
  WA_IDOC_DATA-SDATA+123(1) = 'X'.
  WA_IDOC_DATA-SDATA+124(1) = 'X'.
  WA_IDOC_DATA-SDATA+125(1) = 'X'.
  WA_IDOC_DATA-SDATA+126(1) = 'X'.
  WA_IDOC_DATA-SDATA+127(1) = 'X'.
  WA_IDOC_DATA-SDATA+128(1) = 'X'.
  WA_IDOC_DATA-SDATA+129(1) = 'X'.
  WA_IDOC_DATA-SDATA+130(1) = 'X'.
  WA_IDOC_DATA-SDATA+131(1) = 'X'.
  WA_IDOC_DATA-SDATA+132(1) = 'X'.
  WA_IDOC_DATA-SDATA+133(1) = 'X'.
  WA_IDOC_DATA-SDATA+134(1) = 'X'.
  WA_IDOC_DATA-SDATA+135(1) = 'X'.
  WA_IDOC_DATA-SDATA+136(1) = 'X'.
  WA_IDOC_DATA-SDATA+137(1) = 'X'.
  WA_IDOC_DATA-SDATA+138(1) = 'X'.
  WA_IDOC_DATA-SDATA+139(1) = 'X'.
  WA_IDOC_DATA-SDATA+140(1) = 'X'.
  WA_IDOC_DATA-SDATA+141(1) = 'X'.
  WA_IDOC_DATA-SDATA+142(1) = 'X'.
  WA_IDOC_DATA-SDATA+143(1) = 'X'.
  WA_IDOC_DATA-SDATA+144(1) = 'X'.
  WA_IDOC_DATA-SDATA+145(1) = 'X'.
  WA_IDOC_DATA-SDATA+146(1) = 'X'.
  WA_IDOC_DATA-SDATA+147(1) = 'X'.
  WA_IDOC_DATA-SDATA+148(1) = 'X'.
  WA_IDOC_DATA-SDATA+149(1) = 'X'.
  WA_IDOC_DATA-SDATA+150(1) = 'X'.
  WA_IDOC_DATA-SDATA+151(1) = 'X'.
  WA_IDOC_DATA-SDATA+152(1) = 'X'.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  WA_IDOC_DATA-SDATA+154(1) = 'X'.
  WA_IDOC_DATA-SDATA+155(1) = 'X'.
  WA_IDOC_DATA-SDATA+156(1) = 'X'.
  WA_IDOC_DATA-SDATA+157(1) = 'X'.
  WA_IDOC_DATA-SDATA+158(1) = 'X'.
  WA_IDOC_DATA-SDATA+159(1) = 'X'.
  WA_IDOC_DATA-SDATA+160(1) = 'X'.
  WA_IDOC_DATA-SDATA+161(1) = 'X'.
  WA_IDOC_DATA-SDATA+162(1) = 'X'.
  WA_IDOC_DATA-SDATA+163(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(1) = 'X'.
  WA_IDOC_DATA-SDATA+169(1) = 'X'.
  WA_IDOC_DATA-SDATA+252(1) = 'X'.
  WA_IDOC_DATA-SDATA+253(1) = 'X'.
  WA_IDOC_DATA-SDATA+254(1) = 'X'.
  WA_IDOC_DATA-SDATA+255(1) = 'X'.
  WA_IDOC_DATA-SDATA+256(1) = 'X'.
  WA_IDOC_DATA-SDATA+257(1) = 'X'.
*  WA_IDOC_DATA-SDATA+258(1) = 'X'.
  WA_IDOC_DATA-SDATA+259(1) = 'X'.
  WA_IDOC_DATA-SDATA+260(1) = 'X'.
  WA_IDOC_DATA-SDATA+261(1) = 'X'.
  WA_IDOC_DATA-SDATA+262(1) = 'X'.
  WA_IDOC_DATA-SDATA+263(1) = 'X'.
  WA_IDOC_DATA-SDATA+264(1) = 'X'.
  WA_IDOC_DATA-SDATA+265(1) = 'X'.
  WA_IDOC_DATA-SDATA+266(1) = 'X'.
  WA_IDOC_DATA-SDATA+267(1) = 'X'.
  WA_IDOC_DATA-SDATA+268(1) = 'X'.
  WA_IDOC_DATA-SDATA+269(1) = 'X'.
  WA_IDOC_DATA-SDATA+270(1) = 'X'.
  WA_IDOC_DATA-SDATA+271(1) = 'X'.
  WA_IDOC_DATA-SDATA+272(1) = 'X'.
  WA_IDOC_DATA-SDATA+273(1) = 'X'.
  WA_IDOC_DATA-SDATA+274(1) = 'X'.
  WA_IDOC_DATA-SDATA+275(1) = 'X'.
  WA_IDOC_DATA-SDATA+276(1) = 'X'.
  WA_IDOC_DATA-SDATA+277(1) = 'X'.
  WA_IDOC_DATA-SDATA+278(1) = 'X'.
  WA_IDOC_DATA-SDATA+279(1) = 'X'.
  WA_IDOC_DATA-SDATA+280(1) = 'X'.
  WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-MATERIAL."
  WA_IDOC_DATA-SDATA+321(1) = 'X'.
  WA_IDOC_DATA-SDATA+322(1) = 'X'.
  WA_IDOC_DATA-SDATA+323(1) = 'X'.
  WA_IDOC_DATA-SDATA+324(1) = 'X'.
  WA_IDOC_DATA-SDATA+325(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*  """"""""""""E1BPE1MARCRTX"""""""""""

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000013'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARCRTX'.
  WA_IDOC_DATA-SDATA+0(3)    = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
*  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'."PROC_TYPE
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+83(1) = 'X'.
  WA_IDOC_DATA-SDATA+84(1) = 'X'.
  WA_IDOC_DATA-SDATA+85(1) = 'X'.
  WA_IDOC_DATA-SDATA+86(1) = 'X'.
  WA_IDOC_DATA-SDATA+87(1) = 'X'.
  WA_IDOC_DATA-SDATA+88(1) = 'X'.
  WA_IDOC_DATA-SDATA+89(1) = 'X'.
  WA_IDOC_DATA-SDATA+90(1) = 'X'.
  WA_IDOC_DATA-SDATA+91(1) = 'X'.
  WA_IDOC_DATA-SDATA+92(1) = 'X'.
  WA_IDOC_DATA-SDATA+93(1) = 'X'.
  WA_IDOC_DATA-SDATA+94(1) = 'X'.
  WA_IDOC_DATA-SDATA+95(1) = 'X'.
  WA_IDOC_DATA-SDATA+96(1) = 'X'.
  WA_IDOC_DATA-SDATA+97(1) = 'X'.
  WA_IDOC_DATA-SDATA+98(1) = 'X'.
  WA_IDOC_DATA-SDATA+99(1) = 'X'.
  WA_IDOC_DATA-SDATA+100(1) = 'X'.
  WA_IDOC_DATA-SDATA+101(1) = 'X'.
  WA_IDOC_DATA-SDATA+102(1) = 'X'.
  WA_IDOC_DATA-SDATA+103(1) = 'X'.
  WA_IDOC_DATA-SDATA+104(1) = 'X'.
  WA_IDOC_DATA-SDATA+105(1) = 'X'.
  WA_IDOC_DATA-SDATA+106(1) = 'X'.
  WA_IDOC_DATA-SDATA+107(1) = 'X'.
  WA_IDOC_DATA-SDATA+108(1) = 'X'.
  WA_IDOC_DATA-SDATA+109(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(1) = 'X'.
  WA_IDOC_DATA-SDATA+114(1) = 'X'.
  WA_IDOC_DATA-SDATA+115(1) = 'X'.
  WA_IDOC_DATA-SDATA+116(1) = 'X'.
  WA_IDOC_DATA-SDATA+117(1) = 'X'.
  WA_IDOC_DATA-SDATA+118(1) = 'X'.
  WA_IDOC_DATA-SDATA+119(1) = 'X'.
**  WA_IDOC_DATA-SDATA+120(1) = 'X'.
  WA_IDOC_DATA-SDATA+121(1) = 'X'.
  WA_IDOC_DATA-SDATA+122(1) = 'X'.
  WA_IDOC_DATA-SDATA+123(1) = 'X'.
  WA_IDOC_DATA-SDATA+124(1) = 'X'.
  WA_IDOC_DATA-SDATA+125(1) = 'X'.
  WA_IDOC_DATA-SDATA+126(1) = 'X'.
  WA_IDOC_DATA-SDATA+127(1) = 'X'.
  WA_IDOC_DATA-SDATA+128(1) = 'X'.
  WA_IDOC_DATA-SDATA+129(1) = 'X'.
  WA_IDOC_DATA-SDATA+130(1) = 'X'.
  WA_IDOC_DATA-SDATA+131(1) = 'X'.
  WA_IDOC_DATA-SDATA+132(1) = 'X'.
  WA_IDOC_DATA-SDATA+133(1) = 'X'.
  WA_IDOC_DATA-SDATA+134(1) = 'X'.
  WA_IDOC_DATA-SDATA+135(1) = 'X'.
  WA_IDOC_DATA-SDATA+136(1) = 'X'.
  WA_IDOC_DATA-SDATA+137(1) = 'X'.
  WA_IDOC_DATA-SDATA+138(1) = 'X'.
  WA_IDOC_DATA-SDATA+139(1) = 'X'.
  WA_IDOC_DATA-SDATA+140(1) = 'X'.
  WA_IDOC_DATA-SDATA+141(1) = 'X'.
  WA_IDOC_DATA-SDATA+142(1) = 'X'.
  WA_IDOC_DATA-SDATA+143(1) = 'X'.
  WA_IDOC_DATA-SDATA+144(1) = 'X'.
  WA_IDOC_DATA-SDATA+145(1) = 'X'.
  WA_IDOC_DATA-SDATA+146(1) = 'X'.
  WA_IDOC_DATA-SDATA+147(1) = 'X'.
  WA_IDOC_DATA-SDATA+148(1) = 'X'.
  WA_IDOC_DATA-SDATA+149(1) = 'X'.
  WA_IDOC_DATA-SDATA+150(1) = 'X'.
  WA_IDOC_DATA-SDATA+151(1) = 'X'.
  WA_IDOC_DATA-SDATA+152(1) = 'X'.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  WA_IDOC_DATA-SDATA+154(1) = 'X'.
  WA_IDOC_DATA-SDATA+155(1) = 'X'.
  WA_IDOC_DATA-SDATA+156(1) = 'X'.
  WA_IDOC_DATA-SDATA+157(1) = 'X'.
  WA_IDOC_DATA-SDATA+158(1) = 'X'.
  WA_IDOC_DATA-SDATA+159(1) = 'X'.
  WA_IDOC_DATA-SDATA+160(1) = 'X'.
  WA_IDOC_DATA-SDATA+161(1) = 'X'.
  WA_IDOC_DATA-SDATA+162(1) = 'X'.
  WA_IDOC_DATA-SDATA+163(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(1) = 'X'.
  WA_IDOC_DATA-SDATA+169(1) = 'X'.
  WA_IDOC_DATA-SDATA+252(1) = 'X'.
  WA_IDOC_DATA-SDATA+253(1) = 'X'.
  WA_IDOC_DATA-SDATA+254(1) = 'X'.
  WA_IDOC_DATA-SDATA+255(1) = 'X'.
  WA_IDOC_DATA-SDATA+256(1) = 'X'.
  WA_IDOC_DATA-SDATA+257(1) = 'X'.
  WA_IDOC_DATA-SDATA+258(1) = 'X'.
  WA_IDOC_DATA-SDATA+259(1) = 'X'.
  WA_IDOC_DATA-SDATA+260(1) = 'X'.
  WA_IDOC_DATA-SDATA+261(1) = 'X'.
  WA_IDOC_DATA-SDATA+262(1) = 'X'.
  WA_IDOC_DATA-SDATA+263(1) = 'X'.
  WA_IDOC_DATA-SDATA+264(1) = 'X'.
  WA_IDOC_DATA-SDATA+265(1) = 'X'.
  WA_IDOC_DATA-SDATA+266(1) = 'X'.
  WA_IDOC_DATA-SDATA+267(1) = 'X'.
  WA_IDOC_DATA-SDATA+268(1) = 'X'.
  WA_IDOC_DATA-SDATA+269(1) = 'X'.
  WA_IDOC_DATA-SDATA+270(1) = 'X'.
  WA_IDOC_DATA-SDATA+271(1) = 'X'.
  WA_IDOC_DATA-SDATA+272(1) = 'X'.
  WA_IDOC_DATA-SDATA+273(1) = 'X'.
  WA_IDOC_DATA-SDATA+274(1) = 'X'.
  WA_IDOC_DATA-SDATA+275(1) = 'X'.
  WA_IDOC_DATA-SDATA+276(1) = 'X'.
  WA_IDOC_DATA-SDATA+277(1) = 'X'.
  WA_IDOC_DATA-SDATA+278(1) = 'X'.
  WA_IDOC_DATA-SDATA+279(1) = 'X'.
  WA_IDOC_DATA-SDATA+280(1) = 'X'.
  WA_IDOC_DATA-SDATA+281(40) = <FS_FLATFILE>-MATERIAL."
  WA_IDOC_DATA-SDATA+321(1) = 'X'.
  WA_IDOC_DATA-SDATA+322(1) = 'X'.
  WA_IDOC_DATA-SDATA+323(1) = 'X'.
  WA_IDOC_DATA-SDATA+324(1) = 'X'.
  WA_IDOC_DATA-SDATA+325(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000014'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
*  WA_IDOC_DATA-SDATA+30(1)    = <FS_FLATFILE>-MODEL_SP."'2'.
*  WA_IDOC_DATA-SDATA+33(1)    = <FS_FLATFILE>-INITIALIZE."'X'.
*  WA_IDOC_DATA-SDATA+55(7)    = <FS_FLATFILE>-TRACKLIMIT."'4.000'.
*  WA_IDOC_DATA-SDATA+70(4)    = <FS_FLATFILE>-HIST_VALS."'60'.
*  WA_IDOC_DATA-SDATA+86(4)    = <FS_FLATFILE>-FORE_PDS."'12'.
  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000015'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+178(40)  = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000016'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000016'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.

  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000017'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPOPRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+25(1)    = 'X'.
  WA_IDOC_DATA-SDATA+26(1)    = 'X'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
*  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+44(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000018'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000019'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MPGDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+221(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  """"""""""""""""""" E1BPE1MPGDRTX """""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000020'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MPGDRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(1) = 'X'.
  WA_IDOC_DATA-SDATA+26(1) = 'X'.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+110(1) = 'X'.
  WA_IDOC_DATA-SDATA+111(1) = 'X'.
  WA_IDOC_DATA-SDATA+112(1) = 'X'.
  WA_IDOC_DATA-SDATA+113(40) = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-SDATA+153(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.



  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000022'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARDRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(4)    = 'FG01'."<FS_FLATFILE>-STGE_LOC."'FG01'.
  WA_IDOC_DATA-SDATA+158(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  """""""""""""""""""" E1BPE1MARDRTX  """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000024'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MARDRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+25(4) = 'FG01'."<FS_FLATFILE>-STGE_LOC."'FG01'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+118(40) = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000026'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
    EXPORTING
      INPUT  = <FS_FLATFILE>-AUOM
*     LANGUAGE = SY-LANGU
    IMPORTING
      OUTPUT = <FS_FLATFILE>-AUOM.

  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."EA
  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."EA
***  WA_IDOC_DATA-SDATA+27(6)     = <FS_FLATFILE>-DENOMINATR.
***  WA_IDOC_DATA-SDATA+33(6)     = <FS_FLATFILE>-NUMERATOR.
  WA_IDOC_DATA-SDATA+39(18)    = <FS_FLATFILE>-EAN_UPC.
  WA_IDOC_DATA-SDATA+57(2)     = <FS_FLATFILE>-CATEGORY.
****  WA_IDOC_DATA-SDATA+59(15)     = <FS_FLATFILE>-LENGTH.
****  WA_IDOC_DATA-SDATA+74(15)     = <FS_FLATFILE>-WIDTH.
****  WA_IDOC_DATA-SDATA+89(15)     = <FS_FLATFILE>-HEIGHT.
****  WA_IDOC_DATA-SDATA+104(3)     = <FS_FLATFILE>-UNITDIM.
****  WA_IDOC_DATA-SDATA+110(15)     = <FS_FLATFILE>-VOLUME.
***  IF <FS_FLATFILE>-VOLUMEUNIT IS NOT INITIAL.
***    CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT' """31/03/2018
***      EXPORTING
***        INPUT  = <FS_FLATFILE>-VOLUMEUNIT
****       LANGUAGE = SY-LANGU
***      IMPORTING
***        OUTPUT = <FS_FLATFILE>-VOLUMEUNIT.
***    WA_IDOC_DATA-SDATA+125(3)     = <FS_FLATFILE>-VOLUMEUNIT.
***  ENDIF.
  WA_IDOC_DATA-SDATA+131(15)     = <FS_FLATFILE>-GROSSWT.
  WA_IDOC_DATA-SDATA+146(3)    = <FS_FLATFILE>-WT.
*  WA_IDOC_DATA-SDATA+149(3)    = 'KGM'.
  WA_IDOC_DATA-SDATA+152(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+155(3)    = <FS_FLATFILE>-AUOM."WT."'EA'.
*  WA_IDOC_DATA-SDATA+158(3)    = <FS_FLATFILE>-LUN."EA
*  WA_IDOC_DATA-SDATA+161(3)    = <FS_FLATFILE>-LUN."EA
  WA_IDOC_DATA-SDATA+271(40)   = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000027'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MARMRTX'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+24(3)    = <FS_FLATFILE>-AUOM."'EA'.
  WA_IDOC_DATA-SDATA+27(1)    = 'X'.
  WA_IDOC_DATA-SDATA+28(1)    = 'X'.
  WA_IDOC_DATA-SDATA+29(1)    = 'X'.
  WA_IDOC_DATA-SDATA+30(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+31(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+32(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+33(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+34(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+35(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+36(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+37(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+38(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+39(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+40(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+41(1)    = 'X'.
***  WA_IDOC_DATA-SDATA+42(1)    = 'X'.
  WA_IDOC_DATA-SDATA+43(1)    = 'X'.
  WA_IDOC_DATA-SDATA+126(1)    = 'X'.
  WA_IDOC_DATA-SDATA+127(1)    = 'X'.
  WA_IDOC_DATA-SDATA+128(1)    = 'X'.
  WA_IDOC_DATA-SDATA+129(1)    = 'X'.
  WA_IDOC_DATA-SDATA+130(40)   = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000028'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MLANRT'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(3) = 'IN'.
  WA_IDOC_DATA-SDATA+24(2) = 'IN'.
  WA_IDOC_DATA-SDATA+26(4) = 'JOCG'.
  WA_IDOC_DATA-SDATA+30(1) = '0'.
  WA_IDOC_DATA-SDATA+31(4) = 'JOSG'.
  WA_IDOC_DATA-SDATA+35(1) = '0'.
  WA_IDOC_DATA-SDATA+36(4) = 'JOIG'.
  WA_IDOC_DATA-SDATA+40(1) = '0'.
  WA_IDOC_DATA-SDATA+154(40) = <FS_FLATFILE>-MATERIAL..
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000029'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+36(1)     = 'V'."<FS_FLATFILE>-PRICE_CTRL."'V'.
  WA_IDOC_DATA-SDATA+37(25)    = <FS_FLATFILE>-MOVING_PR."'100.0000'.
****  WA_IDOC_DATA-SDATA+62(25)    = <FS_FLATFILE>-STD_PRICE."'100.0000'.
****  WA_IDOC_DATA-SDATA+87(6)     = <FS_FLATFILE>-PRICE_UNIT."'1'.
  WA_IDOC_DATA-SDATA+93(4)     = VAL_CLASS."'3100'.
*****  WA_IDOC_DATA-SDATA+97(1)     = 'V'."<FS_FLATFILE>-PR_CTRL_PP."'V'.
*****  WA_IDOC_DATA-SDATA+98(25)    = <FS_FLATFILE>-MOV_PR_PP."'100.0000'.
*****  WA_IDOC_DATA-SDATA+123(25)   = <FS_FLATFILE>-STD_PR_PP."'100.0000'.
*****  WA_IDOC_DATA-SDATA+148(6)    = <FS_FLATFILE>-PR_UNIT_PP."'1'.
*****  WA_IDOC_DATA-SDATA+154(4)    = <FS_FLATFILE>-VAL_CLASS."'7920'." <FS_FLATFILE>-VCLASS_PP."'3100'.
*****  WA_IDOC_DATA-SDATA+158(1)    = 'V'." <FS_FLATFILE>-PR_CTRL_PY."'V'.
*****  WA_IDOC_DATA-SDATA+159(25)   = <FS_FLATFILE>-MOV_PR_PY."'100.0000'.
*****  WA_IDOC_DATA-SDATA+184(25)   = <FS_FLATFILE>-STD_PR_PY."'100.0000'.
*****  WA_IDOC_DATA-SDATA+209(6)    = <FS_FLATFILE>-PR_UNIT_PY."'1'.
*****  WA_IDOC_DATA-SDATA+215(6)    = <FS_FLATFILE>-VAL_CLASS1."'7920'."<FS_FLATFILE>-VCLASS_PY."'3100'.
*  WA_IDOC_DATA-SDATA+410(1)    = <FS_FLATFILE>-ML_ACTIVE."'X'.
***  WA_IDOC_DATA-SDATA+411(1)    = <FS_FLATFILE>-ML_SETTLE."'2'.
*  WA_IDOC_DATA-SDATA+442(1)    = <FS_FLATFILE>-ORIG_MAT.
*  WA_IDOC_DATA-SDATA+443(10)   = <FS_FLATFILE>-OVERHEAD_GRP."'2'.
*  WA_IDOC_DATA-SDATA+453(1)    = <FS_FLATFILE>-WITH_QTY_STRUCT."'2'.
  WA_IDOC_DATA-SDATA+219(1)    = <FS_FLATFILE>-VAL_CAT.
  WA_IDOC_DATA-SDATA+660(40)   = <FS_FLATFILE>-MATERIAL."'SST123T10'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

**  """"""""""""""""""""" E1BPE1MBEWRTX  """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000031'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFDC'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
*  WA_IDOC_DATA-SDATA+41(1) = 'X'."pr_ctnl_pp
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
**  WA_IDOC_DATA-SDATA+45(1) = 'X'."vclass-py
****  WA_IDOC_DATA-SDATA+46(1) = 'X'."pr_ctnl_py
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
*****  WA_IDOC_DATA-SDATA+50(1) = 'X'."""Val class py
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*** Start of Changes by Suri : 28.08.2019 : 00:59:00
**""""""""""""""""""""" E1BPE1MBEWRT """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000032'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MBEWRT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = 'RFST'.
  WA_IDOC_DATA-SDATA+36(1)    = 'V'.
  WA_IDOC_DATA-SDATA+37(25)   = <FS_FLATFILE>-MOVING_PR.
  WA_IDOC_DATA-SDATA+93(4)    = VAL_CLASS.
  WA_IDOC_DATA-SDATA+219(1)   = <FS_FLATFILE>-VAL_CAT.
  WA_IDOC_DATA-SDATA+660(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

**""""""""""""""""""""" E1BPE1MBEWRTX  """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000033'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MBEWRTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = 'RFST'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
  WA_IDOC_DATA-SDATA+68(1) = 'X'.
  WA_IDOC_DATA-SDATA+69(1) = 'X'.
  WA_IDOC_DATA-SDATA+70(1) = 'X'.
  WA_IDOC_DATA-SDATA+71(1) = 'X'.
  WA_IDOC_DATA-SDATA+72(1) = 'X'.
  WA_IDOC_DATA-SDATA+73(1) = 'X'.
  WA_IDOC_DATA-SDATA+74(1) = 'X'.
  WA_IDOC_DATA-SDATA+75(1) = 'X'.
  WA_IDOC_DATA-SDATA+76(1) = 'X'.
  WA_IDOC_DATA-SDATA+77(1) = 'X'.
  WA_IDOC_DATA-SDATA+78(1) = 'X'.
  WA_IDOC_DATA-SDATA+79(1) = 'X'.
  WA_IDOC_DATA-SDATA+80(1) = 'X'.
  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+82(1) = 'X'.
  WA_IDOC_DATA-SDATA+219(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(40) = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
*** End of Changes by Suri : 28.08.2019 : 00:59:00


  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT          = SY-MANDT.
  WA_IDOC_DATA-SEGNUM         = T2.                         "'000033'.
  WA_IDOC_DATA-SEGNAM         = 'E1BPE1MVKERT'.
  WA_IDOC_DATA-SDATA+0(3)     = '005'.
  WA_IDOC_DATA-SDATA+21(4)    = SALES_ORG."'1000'.
  WA_IDOC_DATA-SDATA+25(2)     = DISTR_CHAN."'10'.
  WA_IDOC_DATA-SDATA+33(1)     = <FS_FLATFILE>-CASH_DISC."'X'.
*  WA_IDOC_DATA-SDATA+110(1)     = <FS_FLATFILE>-SALES_UNIT."'X'.
  WA_IDOC_DATA-SDATA+116(4)     = ITEM_CAT1."'NORM'.
  WA_IDOC_DATA-SDATA+162(2)     = <FS_FLATFILE>-ACCT_ASSGT."'01'.
*  WA_IDOC_DATA-SDATA+179(2)     = <FS_FLATFILE>-ASSORT_LEV."'01'.
  WA_IDOC_DATA-SDATA+182(2)     =  LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'02'.
  WA_IDOC_DATA-SDATA+184(2)     =  LI_PROC_ST."<FS_FLATFILE>-LI_PROC_ST."'02'.
  WA_IDOC_DATA-SDATA+186(1)     = 'X'."<FS_FLATFILE>-ASSORT_LEV."ASSORTLIST."'X'.
*  if v_maw1 IS INITIAL.
  WA_IDOC_DATA-SDATA+197(8)     = SY-DATUM."<,FS_FLATFILE>-LIST_ST_FR.
  WA_IDOC_DATA-SDATA+205(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+213(8)     = SY-DATUM."<FS_FLATFILE>-LIST_DC_FR.
  WA_IDOC_DATA-SDATA+221(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+229(8)     = SY-DATUM."<FS_FLATFILE>-SELL_ST_FR.
  WA_IDOC_DATA-SDATA+237(8)     = '99991231'.
  WA_IDOC_DATA-SDATA+245(8)     = SY-DATUM."<FS_FLATFILE>-SELL_DC_FR.
  WA_IDOC_DATA-SDATA+253(8)     = '99991231'.
**    ELSE.
**  WA_IDOC_DATA-SDATA+59(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+67(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+75(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+83(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+91(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+99(8)    = '99991231'.
**  WA_IDOC_DATA-SDATA+107(8)    = v_maw1.
**  WA_IDOC_DATA-SDATA+115(8)    = '99991231'.
**  ENDIF.
  WA_IDOC_DATA-SDATA+453(40)    = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.


*  """"""""""""""""""""" E1BPE1MVKERTX  """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000034'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1MVKERTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4) = SALES_ORG.
  WA_IDOC_DATA-SDATA+25(2) = DISTR_CHAN.
  WA_IDOC_DATA-SDATA+27(1) = 'X'.
  WA_IDOC_DATA-SDATA+28(1) = 'X'.
  WA_IDOC_DATA-SDATA+29(1) = 'X'.
  WA_IDOC_DATA-SDATA+30(1) = 'X'.
  WA_IDOC_DATA-SDATA+31(1) = 'X'.
  WA_IDOC_DATA-SDATA+32(1) = 'X'.
  WA_IDOC_DATA-SDATA+33(1) = 'X'.
  WA_IDOC_DATA-SDATA+34(1) = 'X'.
  WA_IDOC_DATA-SDATA+35(1) = 'X'.
  WA_IDOC_DATA-SDATA+36(1) = 'X'.
  WA_IDOC_DATA-SDATA+37(1) = 'X'.
  WA_IDOC_DATA-SDATA+38(1) = 'X'.
  WA_IDOC_DATA-SDATA+39(1) = 'X'.
  WA_IDOC_DATA-SDATA+40(1) = 'X'.
  WA_IDOC_DATA-SDATA+41(1) = 'X'.
  WA_IDOC_DATA-SDATA+42(1) = 'X'.
  WA_IDOC_DATA-SDATA+43(1) = 'X'.
  WA_IDOC_DATA-SDATA+44(1) = 'X'.
  WA_IDOC_DATA-SDATA+45(1) = 'X'.
  WA_IDOC_DATA-SDATA+46(1) = 'X'.
  WA_IDOC_DATA-SDATA+47(1) = 'X'.
  WA_IDOC_DATA-SDATA+48(1) = 'X'.
  WA_IDOC_DATA-SDATA+49(1) = 'X'.
  WA_IDOC_DATA-SDATA+50(1) = 'X'.
  WA_IDOC_DATA-SDATA+51(1) = 'X'.
  WA_IDOC_DATA-SDATA+52(1) = 'X'.
  WA_IDOC_DATA-SDATA+53(1) = 'X'.
  WA_IDOC_DATA-SDATA+54(1) = 'X'.
  WA_IDOC_DATA-SDATA+55(1) = 'X'.
  WA_IDOC_DATA-SDATA+56(1) = 'X'.
  WA_IDOC_DATA-SDATA+57(1) = 'X'.
  WA_IDOC_DATA-SDATA+58(1) = 'X'.
  WA_IDOC_DATA-SDATA+59(1) = 'X'.
  WA_IDOC_DATA-SDATA+60(1) = 'X'.
  WA_IDOC_DATA-SDATA+61(1) = 'X'.
  WA_IDOC_DATA-SDATA+62(1) = 'X'.
  WA_IDOC_DATA-SDATA+63(1) = 'X'.
  WA_IDOC_DATA-SDATA+64(1) = 'X'.
  WA_IDOC_DATA-SDATA+65(1) = 'X'.
  WA_IDOC_DATA-SDATA+66(1) = 'X'.
  WA_IDOC_DATA-SDATA+67(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+68(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+69(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+76(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+77(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+78(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+79(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+80(1) = 'X'.
*******  WA_IDOC_DATA-SDATA+81(1) = 'X'.
  WA_IDOC_DATA-SDATA+164(1) = 'X'.
  WA_IDOC_DATA-SDATA+165(1) = 'X'.
  WA_IDOC_DATA-SDATA+166(1) = 'X'.
  WA_IDOC_DATA-SDATA+167(1) = 'X'.
  WA_IDOC_DATA-SDATA+168(40) = <FS_FLATFILE>-MATERIAL.
  WA_IDOC_DATA-SDATA+208(1) = 'X'.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*  """"""""""""""""""""" E1BPE1WLK2RT """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000035'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RT'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)  = SALES_ORG."1000
  WA_IDOC_DATA-SDATA+25(2)  = DISTR_CHAN.""10
  WA_IDOC_DATA-SDATA+146(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.

*  """"""""""""""""""""" E1BPE1WLK2RTX """""""""""""""""
  T2 = T2 + 1.
  WA_IDOC_DATA-MANDT       = SY-MANDT.
  WA_IDOC_DATA-SEGNUM      = T2.                            "'000036'.
  WA_IDOC_DATA-SEGNAM      = 'E1BPE1WLK2RTX'.
  WA_IDOC_DATA-SDATA+0(3)  = '005'.
  WA_IDOC_DATA-SDATA+21(4)  = SALES_ORG."1000
  WA_IDOC_DATA-SDATA+25(2)  = DISTR_CHAN."10
  WA_IDOC_DATA-SDATA+31(1)  = 'X'.
  WA_IDOC_DATA-SDATA+32(1)  = 'X'.
  WA_IDOC_DATA-SDATA+35(1)  = 'X'.
  WA_IDOC_DATA-SDATA+36(1)  = 'X'.
  WA_IDOC_DATA-SDATA+37(1)  = 'X'.
  WA_IDOC_DATA-SDATA+38(1)  = 'X'.
  WA_IDOC_DATA-SDATA+121(40)  = <FS_FLATFILE>-MATERIAL.
  APPEND  WA_IDOC_DATA TO IT_IDOC_DATA.
  CLEAR WA_IDOC_DATA.
  CLEAR T2.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form UPDATE
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM UPDATE .
*  WAIT UP TO 2 SECONDS.
*  BREAK-POINT.
  CALL FUNCTION 'BAPI_IDOC_INPUT1'
    EXPORTING
      INPUT_METHOD          = SPACE
      MASS_PROCESSING       = SPACE
    TABLES
      IDOC_CONTRL           = IT_IDOC_CONTRL
      IDOC_DATA             = IT_IDOC_DATA
      IDOC_STATUS           = IT_IDOC_STATUS
      RETURN_VARIABLES      = IT_RETURN_VARIABLES
      SERIALIZATION_INFO    = IT_SERIALIZATION_INFO
    EXCEPTIONS
      WRONG_FUNCTION_CALLED = 1
      OTHERS                = 2.

  READ TABLE IT_IDOC_STATUS INTO WA_IDOC_STATUS WITH KEY STATUS = '53' MSGTY = 'S'.
  IF SY-SUBRC IS INITIAL.
    CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'.
    WAIT UP TO 1 SECONDS.
    PERFORM UPDATE_MARA.
    WA_DISPLAY-SLNO       = <FS_FLATFILE>-SLNO.
    WA_DISPLAY-MATERIAL   = <FS_FLATFILE>-MATERIAL.
    WA_DISPLAY-TYPE       = WA_IDOC_STATUS-MSGTY.
    WA_DISPLAY-NUMBER     = WA_IDOC_STATUS-MSGNO.
    WA_DISPLAY-MESSAGE    = WA_IDOC_STATUS-APPL_LOG.
    WA_DISPLAY-MESSAGE_V1 = 'Material has been Created'.
    APPEND WA_DISPLAY TO IT_DISPLAY.
    CLEAR WA_DISPLAY.
  ELSE.
    CLEAR:WA_IDOC_STATUS.
    READ TABLE IT_IDOC_STATUS INTO WA_IDOC_STATUS INDEX 1.
    WA_DISPLAY-SLNO       = <FS_FLATFILE>-SLNO..
    WA_DISPLAY-MATERIAL   = <FS_FLATFILE>-MATERIAL..
    WA_DISPLAY-TYPE       = WA_IDOC_STATUS-MSGTY.
    WA_DISPLAY-NUMBER     = WA_IDOC_STATUS-MSGNO.
    WA_DISPLAY-MESSAGE    = WA_IDOC_STATUS-APPL_LOG.
    WA_DISPLAY-MESSAGE_V1 = 'Material not created'.
    APPEND WA_DISPLAY TO IT_DISPLAY.
    CLEAR WA_DISPLAY.
  ENDIF.
  CLEAR:WA_DISPLAY,WA_IDOC_STATUS,<FS_FLATFILE>,<FS_FLATFILE1>.
  REFRESH:IT_IDOC_DATA,IT_IDOC_STATUS,IT_SERIALIZATION_INFO.

  CALL FUNCTION 'DEQUEUE_ALL'.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form UPDATE_MARA
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM UPDATE_MARA .
*  BREAK-POINT.
  IF <FS_FLATFILE1>-VARIANT_LONG IS INITIAL.
    UPDATE MARA SET   ZZARTICLE         = <FS_FLATFILE>-ZZARTICLE
                      ZZLABEL_DESC      = <FS_FLATFILE>-ZZLABEL_DESC
                      ZZIVEND_DESC      = <FS_FLATFILE>-ZZIVEND_DESC
                      ZZEMP_CODE        = <FS_FLATFILE>-ZZEMP_CODE
                      ZZEMP_PER         = <FS_FLATFILE>-ZZEMP_PER
                      ZZPO_ORDER_TXT    = <FS_FLATFILE>-ZZPO_ORDER_TXT
                      ZZDISC_ALLOW      = <FS_FLATFILE>-ZZDISC_ALLOW
                      ZZISEXCHANGE      = <FS_FLATFILE>-ZZISEXCHANGE
                      ZZISNONSTOCK      = <FS_FLATFILE>-ZZISNONSTOCK
                      ZZISREFUND        = <FS_FLATFILE>-ZZISREFUND
                      ZZISSALEABLE      = <FS_FLATFILE>-ZZISSALEABLE
                      ZZISWEIGHED       = <FS_FLATFILE>-ZZISWEIGHED
                      ZZISVALID         = <FS_FLATFILE>-ZZISVALID
                      ZZISTAXEXEMPT     = <FS_FLATFILE>-ZZISTAXEXEMPT
                      ZZISOPENPRICE     = <FS_FLATFILE>-ZZISOPENPRICE
                      ZZISOPENDESC      = <FS_FLATFILE>-ZZISOPENDESC
                      ZZISINCTAX        = <FS_FLATFILE>-ZZISINCTAX
                      ZZRET_DAYS        = <FS_FLATFILE>-ZZRET_DAYS
                      ZZPRICE_FRM        = <FS_FLATFILE>-ZZPRICE_FRM
                      ZZPRICE_TO        = <FS_FLATFILE>-ZZPRICE_TO
                      ZZSTYLE           = <FS_FLATFILE>-ZZSTYLE
                      WHERE MATNR       = <FS_FLATFILE>-MATERIAL.

  ELSEIF <FS_FLATFILE1>-VARIANT_LONG IS NOT INITIAL.
    LOOP AT TA_FLATFILE1 ASSIGNING <FS_FLATFILE1> WHERE MATERIAL = <FS_FLATFILE>-MATERIAL.
      IF <FS_FLATFILE1> IS ASSIGNED.
        UPDATE MARA SET   ZZARTICLE    = <FS_FLATFILE>-ZZARTICLE
                     ZZLABEL_DESC      = <FS_FLATFILE1>-ZZLABEL_DESC
                     ZZIVEND_DESC      = <FS_FLATFILE1>-ZZIVEND_DESC
                     ZZEMP_CODE        = <FS_FLATFILE1>-ZZEMP_CODE
                     ZZEMP_PER         = <FS_FLATFILE1>-ZZEMP_PER
                     ZZPO_ORDER_TXT    = <FS_FLATFILE1>-ZZPO_ORDER_TXT
                     ZZDISC_ALLOW      = <FS_FLATFILE1>-ZZDISC_ALLOW
                     ZZISEXCHANGE      = <FS_FLATFILE1>-ZZISEXCHANGE
                     ZZISNONSTOCK      = <FS_FLATFILE1>-ZZISNONSTOCK
                     ZZISREFUND        = <FS_FLATFILE1>-ZZISREFUND
                     ZZISSALEABLE      = <FS_FLATFILE1>-ZZISSALEABLE
                     ZZISWEIGHED       = <FS_FLATFILE1>-ZZISWEIGHED
                     ZZISVALID         = <FS_FLATFILE1>-ZZISVALID
                     ZZISTAXEXEMPT     = <FS_FLATFILE1>-ZZISTAXEXEMPT
                     ZZISOPENPRICE     = <FS_FLATFILE1>-ZZISOPENPRICE
                     ZZISOPENDESC      = <FS_FLATFILE1>-ZZISOPENDESC
                     ZZISINCTAX        = <FS_FLATFILE1>-ZZISINCTAX
                     ZZRET_DAYS        = <FS_FLATFILE1>-ZZRET_DAYS
                     ZZPRICE_FRM        = <FS_FLATFILE>-ZZPRICE_FRM
                     ZZPRICE_TO        = <FS_FLATFILE>-ZZPRICE_TO
                     ZZSTYLE           = <FS_FLATFILE>-ZZSTYLE
                     WHERE MATNR       = <FS_FLATFILE1>-VARIANT_LONG.
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDFORM.


*&---------------------------------------------------------------------*
*&      Form  SET_BACKGROUND_JOB
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM SET_BACKGROUND_JOB .

  DATA :
    I_TYPE       TYPE TRUXS_T_TEXT_DATA,
    LS_FILE      TYPE TA_FLATFILE,
    LV_A_FILE    TYPE STRING,
    LV_FILE2     TYPE RLGRAP-FILENAME,
    LV_AUTHCKNAM TYPE TBTCJOB-AUTHCKNAM,
    LV_JOBCOUNT  TYPE TBTCJOB-JOBCOUNT.

  LV_AUTHCKNAM = SY-UNAME.
  CHECK P_BG = 'X'.

***   FM TO UPLOAD DATA INTO INTERNAL TABLE FROM EXCEL
  DATA:LV_FILE  TYPE RLGRAP-FILENAME.

*  PROCEED ONLY IF ITS A VALID FILETYPE
  IF ENAME EQ 'XLSX' OR ENAME EQ 'XLS'.
*  IF ENAME EQ 'CSV'.
    REFRESH TA_FLATFILE[].
    LV_FILE = P_FILE.
    BREAK SAMBURI.
*   FM TO UPLOAD DATA INTO INTERNAL TABLE FROM EXCEL
    CALL FUNCTION 'TEXT_CONVERT_XLS_TO_SAP'
      EXPORTING
        I_TAB_RAW_DATA       = I_TYPE
        I_FILENAME           = LV_FILE
      TABLES
        I_TAB_CONVERTED_DATA = TA_FLATFILE[]
      EXCEPTIONS
        CONVERSION_FAILED    = 1
        OTHERS               = 2.

    DELETE TA_FLATFILE[] FROM 1 TO 3.
    IF SY-SUBRC <> 0.
      MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.
  ELSE.
    MESSAGE E398(00) WITH 'Invalid File Type'  .
  ENDIF.

  IF TA_FLATFILE[] IS INITIAL.
    MESSAGE 'No records to upload' TYPE 'E'.
  ENDIF.

  CASE SY-SYSID.
    WHEN 'SDS'.
      LV_A_FILE = '/usr/sap/SDS/D00/work/materialcreation.txt'.
    WHEN 'SQS'.
      LV_A_FILE = '/usr/sap/SQS/materialcreation/materialcreation.txt'.
    WHEN 'SPS'.
      LV_A_FILE = '/usr/sap/SPS/materialcreation/materialcreation.txt'.
  ENDCASE.

  TRY.
      OPEN DATASET LV_A_FILE FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.
      LOOP AT TA_FLATFILE INTO LS_FILE .
        TRANSFER LS_FILE TO LV_A_FILE.
      ENDLOOP.
    CATCH CX_ROOT.
  ENDTRY.
  CLOSE DATASET LV_A_FILE.

  CALL FUNCTION 'JOB_OPEN'
    EXPORTING
      JOBNAME          = 'MATERIAL_UPLOAD'
    IMPORTING
      JOBCOUNT         = LV_JOBCOUNT
    EXCEPTIONS
      CANT_CREATE_JOB  = 1
      INVALID_JOB_DATA = 2
      JOBNAME_MISSING  = 3
      OTHERS           = 4.

  CALL FUNCTION 'JOB_SUBMIT'
    EXPORTING
      AUTHCKNAM               = LV_AUTHCKNAM
      JOBCOUNT                = LV_JOBCOUNT
      JOBNAME                 = 'MATERIAL_UPLOAD'
      REPORT                  = SY-REPID
    EXCEPTIONS
      BAD_PRIPARAMS           = 1
      BAD_XPGFLAGS            = 2
      INVALID_JOBDATA         = 3
      JOBNAME_MISSING         = 4
      JOB_NOTEX               = 5
      JOB_SUBMIT_FAILED       = 6
      LOCK_FAILED             = 7
      PROGRAM_MISSING         = 8
      PROG_ABAP_AND_EXTPG_SET = 9
      OTHERS                  = 10.

  CALL FUNCTION 'JOB_CLOSE'
    EXPORTING
      JOBCOUNT             = LV_JOBCOUNT
      JOBNAME              = 'MATERIAL_UPLOAD'
      STRTIMMED            = 'X'
    EXCEPTIONS
      CANT_START_IMMEDIATE = 1
      INVALID_STARTDATE    = 2
      JOBNAME_MISSING      = 3
      JOB_CLOSE_FAILED     = 4
      JOB_NOSTEPS          = 5
      JOB_NOTEX            = 6
      LOCK_FAILED          = 7
      INVALID_TARGET       = 8
      OTHERS               = 9.
  MESSAGE 'Background job start' TYPE 'S'.
ENDFORM.
